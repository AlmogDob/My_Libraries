<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Almog Engine: src/include/Almog_Engine.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Almog Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Almog__Engine_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Almog_Engine.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Almog__Engine_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifndef ALMOG_ENGINE_H_</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#define ALMOG_ENGINE_H_</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Almog__Dynamic__Array_8h.html">./Almog_Dynamic_Array.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Matrix2D_8h.html">./Matrix2D.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Almog__Draw__Library_8h.html">./Almog_Draw_Library.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#ifndef ALMOG_STRING_MANIPULATION_IMPLEMENTATION</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a7dcf618ed2a010f88afa86c4687cf444">   38</a></span>&#160;<span class="preprocessor">#define ALMOG_STRING_MANIPULATION_IMPLEMENTATION</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Almog__String__Manipulation_8h.html">./Almog_String_Manipulation.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#ifndef AE_ASSERT</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">   44</a></span>&#160;<span class="preprocessor">#define AE_ASSERT assert</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;float.h&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#ifndef PI</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#define PI M_PI</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#ifndef STL_HEADER_SIZE</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a370cf2e354323ac710025b5c1e2c58ee">   59</a></span>&#160;<span class="preprocessor">#define STL_HEADER_SIZE 80</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#ifndef STL_NUM_SIZE</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">   63</a></span>&#160;<span class="preprocessor">#define STL_NUM_SIZE 4</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#ifndef STL_SIZE_FOREACH_TRI</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad65703d595e8448cd1669cc21a2d8d16">   67</a></span>&#160;<span class="preprocessor">#define STL_SIZE_FOREACH_TRI 50</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#ifndef STL_ATTRIBUTE_BITS_SIZE</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a45967694710f3c5c2924b7afff0e9775">   71</a></span>&#160;<span class="preprocessor">#define STL_ATTRIBUTE_BITS_SIZE 2</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#ifndef HexARGB_RGBA</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#define HexARGB_RGBA(x) ((x)&gt;&gt;(8*2)&amp;0xFF), ((x)&gt;&gt;(8*1)&amp;0xFF), ((x)&gt;&gt;(8*0)&amp;0xFF), ((x)&gt;&gt;(8*3)&amp;0xFF)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#ifndef HexARGB_RGB_VAR</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#define HexARGB_RGB_VAR(x, r, g, b) r = ((x)&gt;&gt;(8*2)&amp;0xFF); g = ((x)&gt;&gt;(8*1)&amp;0xFF); b = ((x)&gt;&gt;(8*0)&amp;0xFF);</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifndef HexARGB_RGBA_VAR</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#define HexARGB_RGBA_VAR(x, r, g, b, a) r = ((x)&gt;&gt;(8*2)&amp;0xFF); g = ((x)&gt;&gt;(8*1)&amp;0xFF); b = ((x)&gt;&gt;(8*0)&amp;0xFF); a = ((x)&gt;&gt;(8*3)&amp;0xFF)</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a6f18a8c8789c03cb3eb675357954917f">   83</a></span>&#160;<span class="preprocessor">#define ARGB_hexARGB(a, r, g, b) 0x01000000l*(uint8_t)(a) + 0x00010000*(uint8_t)(r) + 0x00000100*(uint8_t)(g) + 0x00000001*(uint8_t)(b)</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#ifndef RGB_hexRGB</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#define RGB_hexRGB(r, g, b) (int)(0x010000*(int)(r) + 0x000100*(int)(g) + 0x000001*(int)(b))</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a03c3b1820f0b451f70c3b3848cd80ddb">   88</a></span>&#160;<span class="preprocessor">#define AE_MAX_POINT_VAL 1e5</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">   89</a></span>&#160;<span class="preprocessor">#define ae_assert_point_is_valid(p) AE_ASSERT(isfinite((p).x) &amp;&amp; isfinite((p).y) &amp;&amp; isfinite((p).z) &amp;&amp; isfinite((p).w));    \</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">        AE_ASSERT((p).x &gt; -AE_MAX_POINT_VAL &amp;&amp; (p).x &lt; AE_MAX_POINT_VAL);                                                                  \</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">        AE_ASSERT((p).y &gt; -AE_MAX_POINT_VAL &amp;&amp; (p).y &lt; AE_MAX_POINT_VAL);                                                                  \</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">        AE_ASSERT((p).z &gt; -AE_MAX_POINT_VAL &amp;&amp; (p).z &lt; AE_MAX_POINT_VAL);                                                                  \</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">        AE_ASSERT((p).w &gt; -AE_MAX_POINT_VAL &amp;&amp; (p).w &lt; AE_MAX_POINT_VAL);</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">   94</a></span>&#160;<span class="preprocessor">#define ae_assert_tri_is_valid(tri) ae_assert_point_is_valid((tri).points[0]);  \</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">        ae_assert_point_is_valid((tri).points[1]);                              \</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">        ae_assert_point_is_valid((tri).points[2])</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">   97</a></span>&#160;<span class="preprocessor">#define ae_assert_quad_is_valid(quad) ae_assert_point_is_valid((quad).points[0]);   \</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">        ae_assert_point_is_valid((quad).points[1]);                                 \</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">        ae_assert_point_is_valid((quad).points[2]);                                 \</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">        ae_assert_point_is_valid((quad).points[3])</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a88641a8940288e9e15bd21b7b96c6245">  101</a></span>&#160;<span class="preprocessor">#define ae_point_normalize_xyz_norma(p, norma) (p).x = (p).x / norma;  \</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">        (p).y = (p).y / norma;                        \</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">        (p).z = (p).z / norma </span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a99f5599df51ee61f6b79cb702dd90718">  104</a></span>&#160;<span class="preprocessor">#define ae_point_calc_norma(p) sqrt(((p).x * (p).x) + ((p).y * (p).y) + ((p).z * (p).z))</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a79d5f5baf43bc7a9c1c9d5ae1d3a18c3">  105</a></span>&#160;<span class="preprocessor">#define ae_point_add_point(p, p1, p2) (p).x = (p1).x + (p2).x;  \</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">        (p).y = (p1).y + (p2).y;                                \</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">        (p).z = (p1).z + (p2).z;                                \</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">        (p).w = (p1).w + (p2).w</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">  109</a></span>&#160;<span class="preprocessor">#define ae_point_sub_point(p, p1, p2) (p).x = (p1).x - (p2).x;  \</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">        (p).y = (p1).y - (p2).y;                                \</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">        (p).z = (p1).z - (p2).z;                                \</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">        (p).w = (p1).w - (p2).w</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">  113</a></span>&#160;<span class="preprocessor">#define ae_point_dot_point(p1, p2) (((p1).x * (p2).x) + ((p1).y * (p2).y) + ((p1).z * (p2).z))</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">  114</a></span>&#160;<span class="preprocessor">#define ae_point_mult(p, const) (p).x *= const; \</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">        (p).y *= const;                         \</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">        (p).z *= const</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a640ff0675ee6dc6d040bf5941be08258">  117</a></span>&#160;<span class="preprocessor">#define ae_points_equal(p1, p2) (p1).x == (p2).x &amp;&amp; (p1).y == (p2).y &amp;&amp; (p1).z == (p2).z</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">  120</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ad2872f5089e1989c79eaf9a2d83faceb">  121</a></span>&#160;    <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ad2872f5089e1989c79eaf9a2d83faceb">AE_LIGHTING_FLAT</a>,</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501a960031a84842327b8c9061dc0f9752b6">  122</a></span>&#160;    <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501a960031a84842327b8c9061dc0f9752b6">AE_LIGHTING_SMOOTH</a>,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ac75a3c6fda462283fc3d03e3167f7e73">AE_LIGHTING_MODE_LENGTH</a></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ac75a3c6fda462283fc3d03e3167f7e73">  124</a></span>&#160;} <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#ifndef TRI_MESH_ARRAY</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a2296609e5a9e3c6015c56ccfebaaadc6">  127</a></span>&#160;<span class="preprocessor">#define TRI_MESH_ARRAY</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="structTri__mesh__array.html">  128</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structTri__mesh__array.html#acb45e304ded2b6eddf5eb3dab3e66609">  129</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structTri__mesh__array.html#acb45e304ded2b6eddf5eb3dab3e66609">length</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structTri__mesh__array.html#a4227912a95f34d7640bac63b3e9da289">  130</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structTri__mesh__array.html#a4227912a95f34d7640bac63b3e9da289">capacity</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">  131</a></span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> *<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;} <a class="code" href="structTri__mesh__array.html">Tri_mesh_array</a>; <span class="comment">/* Tri_mesh ada array */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#ifndef QUAD_MESH_ARRAY</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a398bca11413e52815bbc275b2c797347">  136</a></span>&#160;<span class="preprocessor">#define QUAD_MESH_ARRAY</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structQuad__mesh__array.html">  137</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structQuad__mesh__array.html#a74a7a2dc126bb70072ea18412f28b36a">  138</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structQuad__mesh__array.html#a74a7a2dc126bb70072ea18412f28b36a">length</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="structQuad__mesh__array.html#a904a88351be8b3c1ac1ab34b234c9dfc">  139</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structQuad__mesh__array.html#a904a88351be8b3c1ac1ab34b234c9dfc">capacity</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">  140</a></span>&#160;    <a class="code" href="structQuad__mesh.html">Quad_mesh</a> *<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;} <a class="code" href="structQuad__mesh__array.html">Quad_mesh_array</a>; <span class="comment">/* Quad_mesh ada array */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structCamera.html">  144</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">  145</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">init_position</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">  146</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">  147</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">  148</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">direction</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">  149</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">z_near</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structCamera.html#a49a09d8504a193843ae9496397a5a883">  150</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structCamera.html#a49a09d8504a193843ae9496397a5a883">z_far</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="structCamera.html#a3d5ecfc703004c3d4e1098c0e9575e35">  151</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structCamera.html#a3d5ecfc703004c3d4e1098c0e9575e35">fov_deg</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="structCamera.html#a5742c2c47c7afc5a6d49b6e5759db3cd">  152</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structCamera.html#a5742c2c47c7afc5a6d49b6e5759db3cd">aspect_ratio</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="structCamera.html#a5904daa05edae9d8ed86becf7b3e4059">  153</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structCamera.html#a5904daa05edae9d8ed86becf7b3e4059">roll_offset_deg</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="structCamera.html#ac744a4909bde4c4f58cc7b6918c8c7e3">  154</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structCamera.html#ac744a4909bde4c4f58cc7b6918c8c7e3">pitch_offset_deg</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="structCamera.html#aff86483478f1228e641b98a9ddd13774">  155</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structCamera.html#aff86483478f1228e641b98a9ddd13774">yaw_offset_deg</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">  156</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">  157</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">  158</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;} <a class="code" href="structCamera.html">Camera</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="structLight__source.html">  161</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">  162</a></span>&#160;    <a class="code" href="structPoint.html">Point</a> <a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">  163</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">light_intensity</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;} <a class="code" href="structLight__source.html">Light_source</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structMaterial.html">  166</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structMaterial.html#a5e9c413095df430758f6b31c9bfb60e1">  167</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structMaterial.html#a5e9c413095df430758f6b31c9bfb60e1">specular_power_alpha</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structMaterial.html#a198bf89cad562cca2c4c7015f9f81e86">  168</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structMaterial.html#a198bf89cad562cca2c4c7015f9f81e86">c_ambi</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="structMaterial.html#a380c5e541b1fe955a6bb96d35293cff4">  169</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structMaterial.html#a380c5e541b1fe955a6bb96d35293cff4">c_diff</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structMaterial.html#a27cc8a0811ea2dc434d7cc4ab9785917">  170</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structMaterial.html#a27cc8a0811ea2dc434d7cc4ab9785917">c_spec</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;} <a class="code" href="structMaterial.html">Material</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="structScene.html">  173</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structScene.html#a55369afcc314fe6bef1ecb6e0c322441">  174</a></span>&#160;    <a class="code" href="structTri__mesh__array.html">Tri_mesh_array</a> <a class="code" href="structScene.html#a55369afcc314fe6bef1ecb6e0c322441">in_world_tri_meshes</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="structScene.html#a231ca7798cdad79a7622874c02d19d7e">  175</a></span>&#160;    <a class="code" href="structTri__mesh__array.html">Tri_mesh_array</a> <a class="code" href="structScene.html#a231ca7798cdad79a7622874c02d19d7e">projected_tri_meshes</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="structScene.html#a4e2a307f1316341bbc09a13a9c9eba0b">  176</a></span>&#160;    <a class="code" href="structTri__mesh__array.html">Tri_mesh_array</a> <a class="code" href="structScene.html#a4e2a307f1316341bbc09a13a9c9eba0b">original_tri_meshes</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="structScene.html#a85dae3b3888cc1e8e0737913217f65ce">  178</a></span>&#160;    <a class="code" href="structQuad__mesh__array.html">Quad_mesh_array</a> <a class="code" href="structScene.html#a85dae3b3888cc1e8e0737913217f65ce">in_world_quad_meshes</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="structScene.html#afe38ffb9bbb032ccf76214207d33566f">  179</a></span>&#160;    <a class="code" href="structQuad__mesh__array.html">Quad_mesh_array</a> <a class="code" href="structScene.html#afe38ffb9bbb032ccf76214207d33566f">projected_quad_meshes</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structScene.html#a6cdbd482fccb87c941d6967ec8a3e97c">  180</a></span>&#160;    <a class="code" href="structQuad__mesh__array.html">Quad_mesh_array</a> <a class="code" href="structScene.html#a6cdbd482fccb87c941d6967ec8a3e97c">original_quad_meshes</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">  182</a></span>&#160;    <a class="code" href="structCamera.html">Camera</a> <a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">  183</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">up_direction</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="structScene.html#a1c025ef379d04de976fcb20e60edddcd">  184</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structScene.html#a1c025ef379d04de976fcb20e60edddcd">proj_mat</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="structScene.html#a13d59c30261bd4a5d0186f0c2574da91">  185</a></span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> <a class="code" href="structScene.html#a13d59c30261bd4a5d0186f0c2574da91">view_mat</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="structScene.html#a711d71152c5504997e9cf77934ee815e">  187</a></span>&#160;    <a class="code" href="structLight__source.html">Light_source</a> <a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">  188</a></span>&#160;    <a class="code" href="structMaterial.html">Material</a> <a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;} <a class="code" href="structScene.html">Scene</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<a class="code" href="structTri.html">Tri</a>         <a class="code" href="Almog__Engine_8h.html#a79c90a129257a4d5daa335977a47b666">ae_tri_create</a>(<a class="code" href="structPoint.html">Point</a> p1, <a class="code" href="structPoint.html">Point</a> p2, <a class="code" href="structPoint.html">Point</a> p3);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a4b435e38049391004f3116c7cfedce87">ae_tri_mesh_create_copy</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> *des, <a class="code" href="structTri.html">Tri</a> *src_elements, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#acd168aacba26b933321f17d3fcd5d700">ae_camera_init</a>(<a class="code" href="structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> window_h, <span class="keywordtype">int</span> window_w);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#aee42720d506b69cc9c5b329e71140412">ae_camera_free</a>(<a class="code" href="structScene.html">Scene</a> *scene);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<a class="code" href="structScene.html">Scene</a>       <a class="code" href="Almog__Engine_8h.html#a20905d8a847c8c005e4ea73678a6a8ec">ae_scene_init</a>(<span class="keywordtype">int</span> window_h, <span class="keywordtype">int</span> window_w);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ad38d3a6db0cc5704ab3dc39deac988e8">ae_scene_free</a>(<a class="code" href="structScene.html">Scene</a> *scene);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a83b3ed3c99a19cf592c1eebed7e09f9b">ae_camera_reset_pos</a>(<a class="code" href="structScene.html">Scene</a> *scene);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(<a class="code" href="structPoint.html">Point</a> p, <a class="code" href="structMat2D.html">Mat2D</a> m);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a>(<a class="code" href="structMat2D.html">Mat2D</a> m);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a>    <a class="code" href="Almog__Engine_8h.html#aef0dc6e58e24d1fad454eedddcbecda3">ae_tri_mesh_get_from_obj_file</a>(<span class="keywordtype">char</span> *file_path);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a>    <a class="code" href="Almog__Engine_8h.html#aae60309114a77dde9494d50c049998e0">ae_tri_mesh_get_from_stl_file</a>(<span class="keywordtype">char</span> *file_path);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a>    <a class="code" href="Almog__Engine_8h.html#af8271eb7d6d313acddd78b4bcf6a8555">ae_tri_mesh_get_from_file</a>(<span class="keywordtype">char</span> *file_path);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#abf4e49af66c2e3d0c5d8fba65ce4f2bc">ae_tri_mesh_appand_copy</a>(<a class="code" href="structTri__mesh__array.html">Tri_mesh_array</a> *mesh_array, <a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a>    <a class="code" href="Almog__Engine_8h.html#a4d2ce5dce0415cc4b1cf02c1f6c6bc77">ae_tri_mesh_get_from_quad_mesh</a>(<a class="code" href="structQuad__mesh.html">Quad_mesh</a> q_mesh);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ad22d3f1e0cac0fc8d19398b0d43dbfc7">ae_print_points</a>(<a class="code" href="structCurve.html">Curve</a> p);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a1e9358707d11584816ff73dd09aa9882">ae_print_tri</a>(<a class="code" href="structTri.html">Tri</a> tri, <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> padding);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a4243299cc15f3c47c38f445a8e74f48e">ae_print_tri_mesh</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> padding);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(<a class="code" href="structPoint.html">Point</a> p);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a11c1d61181fe9b0d824fb2be51662659">ae_tri_set_normals</a>(<a class="code" href="structTri.html">Tri</a> *tri);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#ae88854393111f68a7fcc4977070d981b">ae_tri_get_average_normal</a>(<a class="code" href="structTri.html">Tri</a> tri);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#a3ee60e72e8969b1cf15d333a091f8ae7">ae_tri_get_average_point</a>(<a class="code" href="structTri.html">Tri</a> tri);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#add210cedd8afbad661cb2afb96c077df">ae_tri_calc_normal</a>(<a class="code" href="structMat2D.html">Mat2D</a> normal, <a class="code" href="structTri.html">Tri</a> tri);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a2b42f501a0c410d33c3c77188b2373d5">ae_tri_mesh_translate</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a7b0d79ba4b2f6afdbe3c40c5a1a175de">ae_tri_mesh_rotate_Euler_xyz</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">float</span> phi_deg, <span class="keywordtype">float</span> theta_deg, <span class="keywordtype">float</span> psi_deg);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a63cfcc7dda05af0fe61b57f012f949d2">ae_tri_mesh_set_bounding_box</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">float</span> *x_min, <span class="keywordtype">float</span> *x_max, <span class="keywordtype">float</span> *y_min, <span class="keywordtype">float</span> *y_max, <span class="keywordtype">float</span> *z_min, <span class="keywordtype">float</span> *z_max);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ae970b00a8720bd46cf0743327170b4c2">ae_tri_mesh_normalize</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ab014e21d442505ee1ca7c910a6307f8a">ae_tri_mesh_flip_normals</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#aa8b3ea525ba405673473938bf9065c63">ae_tri_mesh_set_normals</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ae7bccc35b4caefa9f167e3267813e921">ae_quad_set_normals</a>(<a class="code" href="structQuad.html">Quad</a> *quad);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#a13940b94d775b4887b34e03ffff9661e">ae_quad_get_average_normal</a>(<a class="code" href="structQuad.html">Quad</a> quad);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#ad1f69bc7c34ba800623bdc3e693a2bcb">ae_quad_get_average_point</a>(<a class="code" href="structQuad.html">Quad</a> quad);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#af54cb5c301bedf21f37ed3fdaf7287b5">ae_quad_calc_normal</a>(<a class="code" href="structMat2D.html">Mat2D</a> normal, <a class="code" href="structQuad.html">Quad</a> quad);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#aac75dd9d298e655d12249edc154e7591">ae_curve_copy</a>(<a class="code" href="structCurve.html">Curve</a> *des, <a class="code" href="structCurve.html">Curve</a> src);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#abbea9d10462f28e6e52352a6c36ffabd">ae_tri_calc_light_intensity</a>(<a class="code" href="structTri.html">Tri</a> *tri, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a36c108042b6ed289b4d0f85f8c5700ee">ae_quad_calc_light_intensity</a>(<a class="code" href="structQuad.html">Quad</a> *quad, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(<a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structMat2D.html">Mat2D</a> line_start, <a class="code" href="structMat2D.html">Mat2D</a> line_end, <span class="keywordtype">float</span> *t);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordtype">int</span>         <a class="code" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a>(<a class="code" href="structPoint.html">Point</a> start_in, <a class="code" href="structPoint.html">Point</a> end_in, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structPoint.html">Point</a> *start_out, <a class="code" href="structPoint.html">Point</a> *end_out);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keywordtype">float</span>       <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(<a class="code" href="structPoint.html">Point</a> p, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keywordtype">int</span>         <a class="code" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a>(<a class="code" href="structTri.html">Tri</a> tri_in, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structTri.html">Tri</a> *tri_out1, <a class="code" href="structTri.html">Tri</a> *tri_out2);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordtype">int</span>         <a class="code" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a>(<a class="code" href="structQuad.html">Quad</a> quad_in, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structQuad.html">Quad</a> *quad_out1, <a class="code" href="structQuad.html">Quad</a> *quad_out2);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a1b7def01c3bfc991682cdd645b806672">ae_projection_mat_set</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat,<span class="keywordtype">float</span> aspect_ratio, <span class="keywordtype">float</span> FOV_deg, <span class="keywordtype">float</span> z_near, <span class="keywordtype">float</span> z_far);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a973977dd2f135de3e1091cf8bbd0f7ff">ae_view_mat_set</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structCamera.html">Camera</a> camera, <a class="code" href="structMat2D.html">Mat2D</a> up);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#a45d3a5d37afa1cc50d2920d8684a5efc">ae_point_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structPoint.html">Point</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#ad43833aa381862dba7a1e91e81260103">ae_point_project_world2view</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structPoint.html">Point</a> src);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<a class="code" href="structPoint.html">Point</a>       <a class="code" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structPoint.html">Point</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ae7ed56cd28c920fcd190a3d8ff3e0283">ae_line_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structPoint.html">Point</a> start_src, <a class="code" href="structPoint.html">Point</a> end_src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structPoint.html">Point</a> *start_des, <a class="code" href="structPoint.html">Point</a> *end_des, <a class="code" href="structScene.html">Scene</a> *scene);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<a class="code" href="structTri.html">Tri</a>         <a class="code" href="Almog__Engine_8h.html#a1c1797fd06019133cacb5329fa1fe24e">ae_tri_transform_to_view</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structTri.html">Tri</a> tri);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a>    <a class="code" href="Almog__Engine_8h.html#a58de2ce54cb320d8cade6a8de95d89d3">ae_tri_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structTri.html">Tri</a> tri, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ad67eee66e34c55818406703f2a13ccd5">ae_tri_mesh_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structTri__mesh.html">Tri_mesh</a> *des, <a class="code" href="structTri__mesh.html">Tri_mesh</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<a class="code" href="structQuad.html">Quad</a>        <a class="code" href="Almog__Engine_8h.html#a318de3677b5db4ffd03ae2b73a998e52">ae_quad_transform_to_view</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structQuad.html">Quad</a> quad);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<a class="code" href="structQuad__mesh.html">Quad_mesh</a>   <a class="code" href="Almog__Engine_8h.html#a328b8b2bb3e397b7d36e72669671868e">ae_quad_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structQuad.html">Quad</a> quad, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#ad7415d7fdf579c8f89a5279953c1cc0f">ae_quad_mesh_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structQuad__mesh.html">Quad_mesh</a> *des, <a class="code" href="structQuad__mesh.html">Quad_mesh</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#aaa5131f30f9d6f1844a4422c548b4295">ae_curve_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structCurve.html">Curve</a> *des, <a class="code" href="structCurve.html">Curve</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#af7b851c934b815c8b57bac30b0b1cdae">ae_curve_ada_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structCurve__ada.html">Curve_ada</a> *des, <a class="code" href="structCurve__ada.html">Curve_ada</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a01d0c3758b20d64c1cbbb2a73a1cdd6c">ae_grid_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structGrid.html">Grid</a> des, <a class="code" href="structGrid.html">Grid</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a4140d91e2951f6867592ed4dd685b5b3">ae_tri_swap</a>(<a class="code" href="structTri.html">Tri</a> *v, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keywordtype">bool</span>        <a class="code" href="Almog__Engine_8h.html#ac07fff7a48f2dc40046df5f8794d61d2">ae_tri_compare</a>(<a class="code" href="structTri.html">Tri</a> t1, <a class="code" href="structTri.html">Tri</a> t2);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#a6163eec1246f36c8f1f16f40c436bb14">ae_tri_qsort</a>(<a class="code" href="structTri.html">Tri</a> *v, <span class="keywordtype">int</span> left, <span class="keywordtype">int</span> right);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordtype">double</span>      <a class="code" href="Almog__Engine_8h.html#adfbb375cedddf064ca503a0520c66829">ae_linear_map</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> min_in, <span class="keywordtype">double</span> max_in, <span class="keywordtype">double</span> min_out, <span class="keywordtype">double</span> max_out);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordtype">void</span>        <a class="code" href="Almog__Engine_8h.html#aa9ee39b8a678005ae0d531d9d1356a30">ae_z_buffer_copy_to_screen</a>(<a class="code" href="structMat2D__uint32.html">Mat2D_uint32</a> screen_mat, <a class="code" href="structMat2D.html">Mat2D</a> inv_z_buffer);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ALMOG_ENGINE_H_ */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#ifdef ALMOG_ENGINE_IMPLEMENTATION</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">#undef ALMOG_ENGINE_IMPLEMENTATION</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a899e6cd6738dea0e52e5bbcb017a257e">  266</a></span>&#160;<span class="preprocessor">#define AE_PRINT_TRI(tri) ae_print_tri(tri, #tri, 0)</span></div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a7b30a109359f4a6a1e27161d8a2b8dd6">  267</a></span>&#160;<span class="preprocessor">#define AE_PRINT_MESH(mesh) ae_print_tri_mesh(mesh, #mesh, 0)</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a79c90a129257a4d5daa335977a47b666">  278</a></span>&#160;<a class="code" href="structTri.html">Tri</a> <a class="code" href="Almog__Engine_8h.html#a79c90a129257a4d5daa335977a47b666">ae_tri_create</a>(<a class="code" href="structPoint.html">Point</a> p1, <a class="code" href="structPoint.html">Point</a> p2, <a class="code" href="structPoint.html">Point</a> p3)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="structTri.html">Tri</a> tri;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = p1;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1] = p2;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2] = p3;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span> tri;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a4b435e38049391004f3116c7cfedce87">  299</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a4b435e38049391004f3116c7cfedce87">ae_tri_mesh_create_copy</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> *des, <a class="code" href="structTri.html">Tri</a> *src_elements, <span class="keywordtype">size_t</span> len)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;{</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> temp_des = *des;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    temp_des.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a> = 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; len; i++) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, temp_des, src_elements[i]);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    *des = temp_des;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#acd168aacba26b933321f17d3fcd5d700">  320</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#acd168aacba26b933321f17d3fcd5d700">ae_camera_init</a>(<a class="code" href="structScene.html">Scene</a> *scene, <span class="keywordtype">int</span> window_h, <span class="keywordtype">int</span> window_w)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">z_near</a>       = 0.1;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a49a09d8504a193843ae9496397a5a883">z_far</a>        = 1000;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a3d5ecfc703004c3d4e1098c0e9575e35">fov_deg</a>      = 60;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a5742c2c47c7afc5a6d49b6e5759db3cd">aspect_ratio</a> = (float)window_h / (<span class="keywordtype">float</span>)window_w;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">init_position</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">init_position</a>, 0);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">init_position</a>, 2, 0) = -4;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">init_position</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>, 0);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a5904daa05edae9d8ed86becf7b3e4059">roll_offset_deg</a> = 0;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#ac744a4909bde4c4f58cc7b6918c8c7e3">pitch_offset_deg</a> = 0;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#aff86483478f1228e641b98a9ddd13774">yaw_offset_deg</a> = 0;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">direction</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">direction</a>, 0);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">direction</a>, 2, 0) = 1;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>, 0);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>, 0, 0) = 1;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>, 0);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>, 1, 0) = 1;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>, 0);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>, 2, 0) = 1;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aee42720d506b69cc9c5b329e71140412">  366</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#aee42720d506b69cc9c5b329e71140412">ae_camera_free</a>(<a class="code" href="structScene.html">Scene</a> *scene)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;{</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">init_position</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">direction</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a20905d8a847c8c005e4ea73678a6a8ec">  388</a></span>&#160;<a class="code" href="structScene.html">Scene</a> <a class="code" href="Almog__Engine_8h.html#a20905d8a847c8c005e4ea73678a6a8ec">ae_scene_init</a>(<span class="keywordtype">int</span> window_h, <span class="keywordtype">int</span> window_w)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;{</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="structScene.html">Scene</a> scene = {0};</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="Almog__Engine_8h.html#acd168aacba26b933321f17d3fcd5d700">ae_camera_init</a>(&amp;(scene), window_h, window_w);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    scene.<a class="code" href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">up_direction</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene.<a class="code" href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">up_direction</a>, 0);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene.<a class="code" href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">up_direction</a>, 1, 0) = 1;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    scene.<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = 0.5;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    scene.<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = 1;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    scene.<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = 1;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    scene.<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = 0;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    scene.<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a> = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(scene.<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    scene.<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">light_intensity</a> = 1;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    scene.<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a5e9c413095df430758f6b31c9bfb60e1">specular_power_alpha</a> = 1;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    scene.<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a198bf89cad562cca2c4c7015f9f81e86">c_ambi</a> = 0.2;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    scene.<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a380c5e541b1fe955a6bb96d35293cff4">c_diff</a> = 0.6;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    scene.<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a27cc8a0811ea2dc434d7cc4ab9785917">c_spec</a> = 0.2;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    scene.<a class="code" href="structScene.html#a1c025ef379d04de976fcb20e60edddcd">proj_mat</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(4, 4);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a1b7def01c3bfc991682cdd645b806672">ae_projection_mat_set</a>(scene.<a class="code" href="structScene.html#a1c025ef379d04de976fcb20e60edddcd">proj_mat</a>, scene.<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a5742c2c47c7afc5a6d49b6e5759db3cd">aspect_ratio</a>, scene.<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a3d5ecfc703004c3d4e1098c0e9575e35">fov_deg</a>, scene.<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">z_near</a>, scene.<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a49a09d8504a193843ae9496397a5a883">z_far</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    scene.<a class="code" href="structScene.html#a13d59c30261bd4a5d0186f0c2574da91">view_mat</a> = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(4, 4);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a973977dd2f135de3e1091cf8bbd0f7ff">ae_view_mat_set</a>(scene.<a class="code" href="structScene.html#a13d59c30261bd4a5d0186f0c2574da91">view_mat</a>, scene.<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>, scene.<a class="code" href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">up_direction</a>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">return</span> scene;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad38d3a6db0cc5704ab3dc39deac988e8">  429</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ad38d3a6db0cc5704ab3dc39deac988e8">ae_scene_free</a>(<a class="code" href="structScene.html">Scene</a> *scene)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="Almog__Engine_8h.html#aee42720d506b69cc9c5b329e71140412">ae_camera_free</a>(scene);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">up_direction</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#a1c025ef379d04de976fcb20e60edddcd">proj_mat</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(scene-&gt;<a class="code" href="structScene.html#a13d59c30261bd4a5d0186f0c2574da91">view_mat</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; scene-&gt;<a class="code" href="structScene.html#a55369afcc314fe6bef1ecb6e0c322441">in_world_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#acb45e304ded2b6eddf5eb3dab3e66609">length</a>; i++) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        free(scene-&gt;<a class="code" href="structScene.html#a55369afcc314fe6bef1ecb6e0c322441">in_world_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>[i].<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; scene-&gt;<a class="code" href="structScene.html#a231ca7798cdad79a7622874c02d19d7e">projected_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#acb45e304ded2b6eddf5eb3dab3e66609">length</a>; i++) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        free(scene-&gt;<a class="code" href="structScene.html#a231ca7798cdad79a7622874c02d19d7e">projected_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>[i].<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; scene-&gt;<a class="code" href="structScene.html#a4e2a307f1316341bbc09a13a9c9eba0b">original_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#acb45e304ded2b6eddf5eb3dab3e66609">length</a>; i++) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        free(scene-&gt;<a class="code" href="structScene.html#a4e2a307f1316341bbc09a13a9c9eba0b">original_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>[i].<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a55369afcc314fe6bef1ecb6e0c322441">in_world_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>) free(scene-&gt;<a class="code" href="structScene.html#a55369afcc314fe6bef1ecb6e0c322441">in_world_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a231ca7798cdad79a7622874c02d19d7e">projected_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>) free(scene-&gt;<a class="code" href="structScene.html#a231ca7798cdad79a7622874c02d19d7e">projected_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a4e2a307f1316341bbc09a13a9c9eba0b">original_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>) free(scene-&gt;<a class="code" href="structScene.html#a4e2a307f1316341bbc09a13a9c9eba0b">original_tri_meshes</a>.<a class="code" href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">elements</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; scene-&gt;<a class="code" href="structScene.html#a85dae3b3888cc1e8e0737913217f65ce">in_world_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a74a7a2dc126bb70072ea18412f28b36a">length</a>; i++) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        free(scene-&gt;<a class="code" href="structScene.html#a85dae3b3888cc1e8e0737913217f65ce">in_world_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>[i].<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; scene-&gt;<a class="code" href="structScene.html#afe38ffb9bbb032ccf76214207d33566f">projected_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a74a7a2dc126bb70072ea18412f28b36a">length</a>; i++) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        free(scene-&gt;<a class="code" href="structScene.html#afe38ffb9bbb032ccf76214207d33566f">projected_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>[i].<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; scene-&gt;<a class="code" href="structScene.html#a6cdbd482fccb87c941d6967ec8a3e97c">original_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a74a7a2dc126bb70072ea18412f28b36a">length</a>; i++) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        free(scene-&gt;<a class="code" href="structScene.html#a6cdbd482fccb87c941d6967ec8a3e97c">original_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>[i].<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a85dae3b3888cc1e8e0737913217f65ce">in_world_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>) free(scene-&gt;<a class="code" href="structScene.html#a85dae3b3888cc1e8e0737913217f65ce">in_world_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#afe38ffb9bbb032ccf76214207d33566f">projected_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>) free(scene-&gt;<a class="code" href="structScene.html#afe38ffb9bbb032ccf76214207d33566f">projected_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a6cdbd482fccb87c941d6967ec8a3e97c">original_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>) free(scene-&gt;<a class="code" href="structScene.html#a6cdbd482fccb87c941d6967ec8a3e97c">original_quad_meshes</a>.<a class="code" href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">elements</a>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a83b3ed3c99a19cf592c1eebed7e09f9b">  472</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a83b3ed3c99a19cf592c1eebed7e09f9b">ae_camera_reset_pos</a>(<a class="code" href="structScene.html">Scene</a> *scene)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;{</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a5904daa05edae9d8ed86becf7b3e4059">roll_offset_deg</a> = 0;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#ac744a4909bde4c4f58cc7b6918c8c7e3">pitch_offset_deg</a> = 0;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#aff86483478f1228e641b98a9ddd13774">yaw_offset_deg</a> = 0;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>, 0);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>, 0);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>, 0, 0) = 1;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>, 0);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>, 1, 0) = 1;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>, 0);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>, 2, 0) = 1;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">init_position</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">  498</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(<a class="code" href="structPoint.html">Point</a> p, <a class="code" href="structMat2D.html">Mat2D</a> m)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;{</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="Matrix2D_8h.html#a8d1087dbe390c9bf0f913390c3240639">MATRIX2D_ASSERT</a>((3 == m.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a> &amp;&amp; 1 == m.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>) || (1 == m.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a> &amp;&amp; 3 == m.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>));</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (3 == m.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a>) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 0, 0) = p.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 1, 0) = p.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 2, 0) = p.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">if</span> (3 == m.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 0, 0) = p.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 0, 1) = p.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 0, 2) = p.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">  522</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a>(<a class="code" href="structMat2D.html">Mat2D</a> m)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="structPoint.html">Point</a> res = {.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 0, 0), .y = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 1, 0), .z = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(m, 2, 0), .w = 1};</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aef0dc6e58e24d1fad454eedddcbecda3">  540</a></span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a> <a class="code" href="Almog__Engine_8h.html#aef0dc6e58e24d1fad454eedddcbecda3">ae_tri_mesh_get_from_obj_file</a>(<span class="keywordtype">char</span> *file_path)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;{</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">char</span> current_line[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>], current_word[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>], current_num_str[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>];</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">char</span> file_name[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>], file_extention[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>], mesh_name[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>];</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">int</span> texture_warning_was_printed = 0;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    strncpy(file_name, file_path, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    strncpy(file_extention, file_name, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">/* check if file is an obj file*/</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(file_name, file_extention, <span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(file_name, file_extention, <span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (strncmp(file_extention, <span class="stringliteral">&quot;.obj&quot;</span>, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>)) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [Error] unsupported file format: &#39;%s&#39;\n&quot;</span>, __FILE__, __LINE__, file_name);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        exit(1);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    strncpy(mesh_name, file_name, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="Almog__String__Manipulation_8h.html#a8cd7d02540e05c2a9b7457500b3de50f">asm_length</a>(mesh_name)) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, mesh_name, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    strncpy(mesh_name, current_word, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    strncpy(current_word, <span class="stringliteral">&quot;.&quot;</span>, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    strncat(file_name, <span class="stringliteral">&quot;.obj&quot;</span>, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>/2);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    strncat(current_word, file_name, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>/2);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    FILE *fp_input = fopen(current_word, <span class="stringliteral">&quot;rt&quot;</span>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">if</span> (fp_input == NULL) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [Error] failed to open input file: &#39;%s&#39;, %s\n&quot;</span>, __FILE__, __LINE__, current_word, strerror(errno));</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        exit(1);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// strncpy(output_file_name, &quot;./build/&quot;, MAX_LEN_LINE);</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// strncat(output_file_name, mesh_name, MAX_LEN_LINE/2);</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">// strncat(output_file_name, &quot;.c&quot;, MAX_LEN_LINE/2);</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// FILE *fp_output = fopen(output_file_name, &quot;wt&quot;);</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// if (fp_input == NULL) {</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">//     fprintf(stderr, &quot;%s:%d: [Error] failed to open output file: &#39;%s&#39;. %s\n&quot;, __FILE__, __LINE__, output_file_name, strerror(errno));</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">//     exit(1);</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">/* parsing data from file */</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="structCurve.html">Curve</a> points = {0};</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a>(<a class="code" href="structPoint.html">Point</a>, points);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a>(<a class="code" href="structTri.html">Tri</a>, mesh);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">int</span> line_len;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">while</span> ((line_len = <a class="code" href="Almog__String__Manipulation_8h.html#a8f808979502627a0266c0e374f6e1641">asm_get_line</a>(fp_input, current_line)) != -1) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="Almog__String__Manipulation_8h.html#a63ffe09b30c257a91c9b48a55837dbe0">asm_get_next_word_from_line</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span> (!strncmp(current_word, <span class="stringliteral">&quot;v&quot;</span>, 1)) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <a class="code" href="structPoint.html">Point</a> p;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            p.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = atof(current_word);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            p.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = atof(current_word);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            p.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = atof(current_word);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="comment">// printf(&quot;current word: %s\n&quot;, current_word);</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structPoint.html">Point</a>, points, p);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment">// break;</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span> (!strncmp(current_word, <span class="stringliteral">&quot;f&quot;</span>, 1)) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <a class="code" href="structTri.html">Tri</a> tri1 = {0}, tri2 = {0};</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="comment">// printf(&quot;line: %s\nword: %s, %d\n&quot;, current_line, current_word, atoi(current_word));</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="comment">// printf(&quot;line: %s\nword: %s, %d\n&quot;, current_line, current_word, atoi(current_word));</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keywordtype">int</span> number_of_spaces = <a class="code" href="Almog__String__Manipulation_8h.html#a929b5505a3cdb1796f2865b25b3bc92a">asm_str_in_str</a>(current_line, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="comment">// printf(&quot;%d\n&quot;, number_of_spaces);</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="comment">// exit(1);</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="keywordflow">if</span> (!(number_of_spaces == 3 || number_of_spaces == 4 || number_of_spaces == 5)) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [Error] there is unsupported number of vertices for a face: %d\n&quot;</span>, __FILE__, __LINE__, number_of_spaces);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                exit(1);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">if</span> (number_of_spaces == 3) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <span class="comment">/* there are 3 vertices for the face. */</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="comment">// printf(&quot;line: %s\nword: %s, %d\n&quot;, current_line, current_word, atoi(current_word));</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="keywordtype">int</span> number_of_backslash = <a class="code" href="Almog__String__Manipulation_8h.html#a929b5505a3cdb1796f2865b25b3bc92a">asm_str_in_str</a>(current_word, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordflow">if</span> (number_of_backslash == 0) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_word)-1];</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_word)-1];</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_word)-1];</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <span class="keywordflow">if</span> (number_of_backslash == 2) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    <span class="keywordflow">if</span> (!texture_warning_was_printed) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;%s:%d [Warning] texture and normals data ignored of file at - &#39;%s&#39;\n&quot;</span>, __FILE__, __LINE__, file_path);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                        texture_warning_was_printed = 1;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_num_str, current_word, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    <span class="comment">// printf(&quot;line: %s\nword: %s\nnum str: %s, %d\n&quot;, current_line, current_word, current_num_str, atoi(current_num_str));</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_num_str, current_word, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <span class="comment">// printf(&quot;line: %s\nword: %s\nnum str: %s, %d\n&quot;, current_line, current_word, current_num_str, atoi(current_num_str));</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_num_str, current_word, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <span class="comment">// printf(&quot;line: %s\nword: %s\nnum str: %s, %d\n&quot;, current_line, current_word, current_num_str, atoi(current_num_str));</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                tri1.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                tri1.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[0] = 1;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                tri1.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[1] = 1;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                tri1.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[2] = 1;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                tri1.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                tri1.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                tri1.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, mesh, tri1);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="comment">// AE_PRINT_TRI(tri1);</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (number_of_spaces == 5 || number_of_spaces == 4) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="comment">/* there are 4 vertices for the face. */</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <span class="comment">/* sometimes there is a space in the end */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <span class="comment">// printf(&quot;line: %s\nword: %s, %d\n&quot;, current_line, current_word, atoi(current_word));</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <span class="keywordtype">int</span> number_of_backslash = <a class="code" href="Almog__String__Manipulation_8h.html#a929b5505a3cdb1796f2865b25b3bc92a">asm_str_in_str</a>(current_word, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <span class="keywordflow">if</span> (number_of_backslash == 0) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_word)-1];</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_word)-1];</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_word)-1];</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keywordflow">if</span> (number_of_backslash == 2 || number_of_backslash == 1) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    <span class="keywordflow">if</span> (!texture_warning_was_printed) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;%s:%d [Warning] texture and normals data ignored of file at - &#39;%s&#39;\n&quot;</span>, __FILE__, __LINE__, file_path);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                        texture_warning_was_printed = 1;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_num_str, current_word, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    <span class="comment">// printf(&quot;line: %s\nword: %s\nnum str: %s, %d\n&quot;, current_line, current_word, current_num_str, atoi(current_num_str));</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    tri2.points[2] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_num_str, current_word, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    <span class="comment">// printf(&quot;line: %s\nword: %s\nnum str: %s, %d\n&quot;, current_line, current_word, current_num_str, atoi(current_num_str));</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_num_str, current_word, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    <span class="comment">// printf(&quot;line: %s\nword: %s\nnum str: %s, %d\n&quot;, current_line, current_word, current_num_str, atoi(current_num_str));</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    tri1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    tri2.points[0] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_word, current_line, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(current_num_str, current_word, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    <span class="comment">// printf(&quot;line: %s\nword: %s\nnum str: %s, %d\n&quot;, current_line, current_word, current_num_str, atoi(current_num_str));</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    tri2.points[1] = points.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[atoi(current_num_str)-1];</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                tri1.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                tri1.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[0] = 1;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                tri1.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[1] = 1;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                tri1.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[2] = 1;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                tri1.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                tri1.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                tri1.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                tri2.to_draw = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                tri2.light_intensity[0] = 1;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                tri2.light_intensity[1] = 1;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                tri2.light_intensity[2] = 1;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                tri2.colors[0] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                tri2.colors[1] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                tri2.colors[2] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, mesh, tri1);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, mesh, tri2);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="comment">// AE_PRINT_TRI(tri1);</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="comment">// AE_PRINT_TRI(tri2);</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="comment">// exit(2);</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">return</span> mesh;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aae60309114a77dde9494d50c049998e0">  743</a></span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a> <a class="code" href="Almog__Engine_8h.html#aae60309114a77dde9494d50c049998e0">ae_tri_mesh_get_from_stl_file</a>(<span class="keywordtype">char</span> *file_path)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;{</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    FILE *file;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    file = fopen(file_path, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (file == NULL) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [Error] failed to open input file: &#39;%s&#39;, %s\n&quot;</span>, __FILE__, __LINE__, file_path, strerror(errno));</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        exit(1);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordtype">char</span> header[<a class="code" href="Almog__Engine_8h.html#a370cf2e354323ac710025b5c1e2c58ee">STL_HEADER_SIZE</a>];</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    fread(header, <a class="code" href="Almog__Engine_8h.html#a370cf2e354323ac710025b5c1e2c58ee">STL_HEADER_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="comment">// dprintSTRING(header);</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    uint32_t num_of_tri;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    fread(&amp;num_of_tri, <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// dprintINT(num_of_tri);</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a>(<a class="code" href="structTri.html">Tri</a>, mesh);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; num_of_tri; i++) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="structTri.html">Tri</a> temp_tri = {0};</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = - temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = - temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = - temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[1] = temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[2] = temp_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0];</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        fread(&amp;(temp_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>), <a class="code" href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a>, 1, file);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        fseek(file, <a class="code" href="Almog__Engine_8h.html#a45967694710f3c5c2924b7afff0e9775">STL_ATTRIBUTE_BITS_SIZE</a>, SEEK_CUR);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        temp_tri.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        temp_tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[0] = 1;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        temp_tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[1] = 1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        temp_tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[2] = 1;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        temp_tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        temp_tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        temp_tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = 0xFFFFFFFF;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="comment">// ae_tri_set_normals(&amp;temp_tri);</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, mesh, temp_tri);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">return</span> mesh;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#af8271eb7d6d313acddd78b4bcf6a8555">  816</a></span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a> <a class="code" href="Almog__Engine_8h.html#af8271eb7d6d313acddd78b4bcf6a8555">ae_tri_mesh_get_from_file</a>(<span class="keywordtype">char</span> *file_path)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;{</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordtype">char</span> file_extention[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>], temp_word[<a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>];</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    strncpy(file_extention, file_path, <a class="code" href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordtype">int</span> num_of_dots;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">while</span> ((num_of_dots = <a class="code" href="Almog__String__Manipulation_8h.html#a929b5505a3cdb1796f2865b25b3bc92a">asm_str_in_str</a>(file_extention, <span class="stringliteral">&quot;.&quot;</span>)) &gt;= 1) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <a class="code" href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a>(temp_word, file_extention, <span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">if</span> (!(!strncmp(file_extention, <span class="stringliteral">&quot;obj&quot;</span>, 3) || !strncmp(file_extention, <span class="stringliteral">&quot;STL&quot;</span>, 3) || !strncmp(file_extention, <span class="stringliteral">&quot;stl&quot;</span>, 3))) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [Error] unsupported file format: &#39;%s&#39;\n&quot;</span>, __FILE__, __LINE__, file_path);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        exit(1);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (!strncmp(file_extention, <span class="stringliteral">&quot;STL&quot;</span>, 3) || !strncmp(file_extention, <span class="stringliteral">&quot;stl&quot;</span>, 3)) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="Almog__Engine_8h.html#aae60309114a77dde9494d50c049998e0">ae_tri_mesh_get_from_stl_file</a>(file_path);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(file_extention, <span class="stringliteral">&quot;obj&quot;</span>, 3)) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="Almog__Engine_8h.html#aef0dc6e58e24d1fad454eedddcbecda3">ae_tri_mesh_get_from_obj_file</a>(file_path);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> null_mesh = {0};</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">return</span> null_mesh;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;}</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#abf4e49af66c2e3d0c5d8fba65ce4f2bc">  851</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#abf4e49af66c2e3d0c5d8fba65ce4f2bc">ae_tri_mesh_appand_copy</a>(<a class="code" href="structTri__mesh__array.html">Tri_mesh_array</a> *mesh_array, <a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;{</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="structTri__mesh__array.html">Tri_mesh_array</a> temp_mesh_array = *mesh_array;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> temp_mesh;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a>(<a class="code" href="structTri.html">Tri</a>, temp_mesh);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; i++) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, temp_mesh, mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i]);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a>, temp_mesh_array, temp_mesh);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    *mesh_array = temp_mesh_array;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a4d2ce5dce0415cc4b1cf02c1f6c6bc77">  875</a></span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a> <a class="code" href="Almog__Engine_8h.html#a4d2ce5dce0415cc4b1cf02c1f6c6bc77">ae_tri_mesh_get_from_quad_mesh</a>(<a class="code" href="structQuad__mesh.html">Quad_mesh</a> q_mesh)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;{</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> t_mesh;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a>(<a class="code" href="structTri.html">Tri</a>, t_mesh);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> q_index = 0; q_index &lt; q_mesh.<a class="code" href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">length</a>; q_index++) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <a class="code" href="structQuad.html">Quad</a> current_q = q_mesh.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[q_index];</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <a class="code" href="structTri.html">Tri</a> temp_t = {.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a> = current_q.<a class="code" href="structQuad.html#a583cf34675c34b1242e48cec56562f35">to_draw</a>};</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        temp_t.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = current_q.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        temp_t.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = current_q.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        temp_t.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0] = current_q.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[0];</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        temp_t.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[0] = current_q.<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[0];</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        temp_t.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1] = current_q.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        temp_t.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = current_q.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        temp_t.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[1] = current_q.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[1];</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        temp_t.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[1] = current_q.<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[1];</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        temp_t.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2] = current_q.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        temp_t.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = current_q.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        temp_t.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[2] = current_q.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[2];</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        temp_t.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[2] = current_q.<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[2];</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, t_mesh, temp_t);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        temp_t.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = current_q.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        temp_t.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = current_q.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        temp_t.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0] = current_q.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[2];</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        temp_t.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[0] = current_q.<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[2];</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        temp_t.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1] = current_q.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        temp_t.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = current_q.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        temp_t.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[1] = current_q.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[3];</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        temp_t.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[1] = current_q.<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[3];</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        temp_t.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2] = current_q.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        temp_t.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = current_q.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        temp_t.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[2] = current_q.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[0];</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        temp_t.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[2] = current_q.<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[0];</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, t_mesh, temp_t);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">return</span> t_mesh;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;}</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad22d3f1e0cac0fc8d19398b0d43dbfc7">  925</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ad22d3f1e0cac0fc8d19398b0d43dbfc7">ae_print_points</a>(<a class="code" href="structCurve.html">Curve</a> p)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;{</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; p.<a class="code" href="structCurve.html#a883f62ca803547dbfe6159200e775b76">length</a>; i++) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        printf(<span class="stringliteral">&quot;point %3zu: (%5f, %5f, %5f)\n&quot;</span>, i, p.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[i].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>, p.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[i].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>, p.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[i].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a1e9358707d11584816ff73dd09aa9882">  942</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a1e9358707d11584816ff73dd09aa9882">ae_print_tri</a>(<a class="code" href="structTri.html">Tri</a> tri, <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> padding)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;{</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    printf(<span class="stringliteral">&quot;%*s%s:\n&quot;</span>, (<span class="keywordtype">int</span>) padding, <span class="stringliteral">&quot;&quot;</span>, name);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    printf(<span class="stringliteral">&quot;%*s    (%f, %f, %f)\n%*s    (%f, %f, %f)\n%*s    (%f, %f, %f)\n&quot;</span>, (<span class="keywordtype">int</span>) padding, <span class="stringliteral">&quot;&quot;</span>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>, (<span class="keywordtype">int</span>) padding, <span class="stringliteral">&quot;&quot;</span>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>, (<span class="keywordtype">int</span>) padding, <span class="stringliteral">&quot;&quot;</span>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>, tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    printf(<span class="stringliteral">&quot;%*s    draw? %d\n&quot;</span>, (<span class="keywordtype">int</span>)padding, <span class="stringliteral">&quot;&quot;</span>, tri.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a>);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a4243299cc15f3c47c38f445a8e74f48e">  958</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a4243299cc15f3c47c38f445a8e74f48e">ae_print_tri_mesh</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> padding)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;{</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordtype">char</span> tri_name[256];</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    printf(<span class="stringliteral">&quot;%*s%s:\n&quot;</span>, (<span class="keywordtype">int</span>) padding, <span class="stringliteral">&quot;&quot;</span>, name);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; i++) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        snprintf(tri_name, 256, <span class="stringliteral">&quot;tri %zu&quot;</span>, i);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a1e9358707d11584816ff73dd09aa9882">ae_print_tri</a>(mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i], tri_name, 4);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;}</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">  976</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(<a class="code" href="structPoint.html">Point</a> p)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;{</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="structPoint.html">Point</a> res = {0};</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordtype">float</span> norma = <a class="code" href="Almog__Engine_8h.html#a99f5599df51ee61f6b79cb702dd90718">ae_point_calc_norma</a>(p);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    res.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = p.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> / norma;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    res.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = p.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> / norma;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    res.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = p.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> / norma;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    res.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = p.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;}</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a11c1d61181fe9b0d824fb2be51662659">  998</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a11c1d61181fe9b0d824fb2be51662659">ae_tri_set_normals</a>(<a class="code" href="structTri.html">Tri</a> *tri)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;{</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> point  = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> to_p   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> from_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> normal = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordtype">int</span> current_index  = i;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordtype">int</span> next_index     = (i + 1) % 3;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordtype">int</span> previous_index = (i - 1 + 3) % 3;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri-&gt;<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[current_index], point);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri-&gt;<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[next_index], from_p);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri-&gt;<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[previous_index], to_p);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(from_p, point);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(point, to_p);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(to_p, point);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="Matrix2D_8h.html#a195a44f3fe41a5c25f431b9a0c43ea48">mat2D_cross</a>(normal, to_p, from_p);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="comment">// mat2D_cross(normal, from_p, to_p);</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <a class="code" href="Matrix2D_8h.html#af74e919ae2726605b4b8edfbcd639a64">mat2D_normalize</a>(normal);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        tri-&gt;<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[current_index] = <a class="code" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a>(normal);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(point);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(to_p);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(from_p);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(normal);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ae88854393111f68a7fcc4977070d981b"> 1041</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#ae88854393111f68a7fcc4977070d981b">ae_tri_get_average_normal</a>(<a class="code" href="structTri.html">Tri</a> tri)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;{</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <a class="code" href="structPoint.html">Point</a> normal0 = tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0];</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <a class="code" href="structPoint.html">Point</a> normal1 = tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[1];</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="structPoint.html">Point</a> normal2 = tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[2];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <a class="code" href="structPoint.html">Point</a> res;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    res.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = (normal0.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + normal1.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + normal2.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) / 3;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    res.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = (normal0.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + normal1.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + normal2.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) / 3;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    res.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = (normal0.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + normal1.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + normal2.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>) / 3;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    res.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = (normal0.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + normal1.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + normal2.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) / 3;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(res);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a3ee60e72e8969b1cf15d333a091f8ae7"> 1062</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#a3ee60e72e8969b1cf15d333a091f8ae7">ae_tri_get_average_point</a>(<a class="code" href="structTri.html">Tri</a> tri)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;{</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="structPoint.html">Point</a> point0 = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0];</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <a class="code" href="structPoint.html">Point</a> point1 = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1];</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <a class="code" href="structPoint.html">Point</a> point2 = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2];</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <a class="code" href="structPoint.html">Point</a> res;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    res.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = (point0.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + point1.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + point2.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) / 3;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    res.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = (point0.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + point1.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + point2.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) / 3;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    res.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = (point0.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + point1.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + point2.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>) / 3;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    res.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = (point0.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + point1.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + point2.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) / 3;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;}</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#add210cedd8afbad661cb2afb96c077df"> 1086</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#add210cedd8afbad661cb2afb96c077df">ae_tri_calc_normal</a>(<a class="code" href="structMat2D.html">Mat2D</a> normal, <a class="code" href="structTri.html">Tri</a> tri)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;{</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(3 == normal.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a> &amp;&amp; 1 == normal.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(tri);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> a = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> b = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> c = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0], a);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1], b);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2], c);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(b, a);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(c, a);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <a class="code" href="Matrix2D_8h.html#a195a44f3fe41a5c25f431b9a0c43ea48">mat2D_cross</a>(normal, b, c);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(normal, 1/<a class="code" href="Matrix2D_8h.html#abda90a369811f8c2693911008994f6ec">mat2D_calc_norma</a>(normal));</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(a);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(b);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(c);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a2b42f501a0c410d33c3c77188b2373d5"> 1121</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a2b42f501a0c410d33c3c77188b2373d5">ae_tri_mesh_translate</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;{</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; i++) {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[j].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> += x;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[j].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> += y;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[j].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> += z;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;}</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a7b0d79ba4b2f6afdbe3c40c5a1a175de"> 1143</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a7b0d79ba4b2f6afdbe3c40c5a1a175de">ae_tri_mesh_rotate_Euler_xyz</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">float</span> phi_deg, <span class="keywordtype">float</span> theta_deg, <span class="keywordtype">float</span> psi_deg)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;{</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> RotZ = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,3);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <a class="code" href="Matrix2D_8h.html#a7cf78b0a4151b30bbc97f86bb8617cb3">mat2D_set_rot_mat_z</a>(RotZ, psi_deg);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> RotY = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,3);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab4db0c7ac08c4e94284e4748f5c63fda">mat2D_set_rot_mat_y</a>(RotY, theta_deg);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> RotX = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,3);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <a class="code" href="Matrix2D_8h.html#aa65d8e2a4d3609149bb9a73f2839e174">mat2D_set_rot_mat_x</a>(RotX, phi_deg);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> DCM = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,3);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">// mat2D_fill(DCM,0);</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> temp = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,3);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">// mat2D_fill(temp,0);</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(temp, RotY, RotZ);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(DCM, RotX, temp); <span class="comment">/* I have a DCM */</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> src_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,1);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> des_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,1);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; i++) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="comment">// mat2D_fill(src_point_mat, 0);</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <span class="comment">// mat2D_fill(des_point_mat, 0);</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <a class="code" href="structPoint.html">Point</a> des;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <a class="code" href="structPoint.html">Point</a> src = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[j];</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 0) = src.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 1, 0) = src.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 2, 0) = src.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(des_point_mat, DCM, src_point_mat);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            des.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 0);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            des.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 1, 0);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            des.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 2, 0);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[j] = des;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <a class="code" href="Almog__Engine_8h.html#aa8b3ea525ba405673473938bf9065c63">ae_tri_mesh_set_normals</a>(mesh);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(RotZ);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(RotY);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(RotX);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(DCM);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(temp);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(src_point_mat);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(des_point_mat);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;}</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a63cfcc7dda05af0fe61b57f012f949d2"> 1206</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a63cfcc7dda05af0fe61b57f012f949d2">ae_tri_mesh_set_bounding_box</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh, <span class="keywordtype">float</span> *x_min, <span class="keywordtype">float</span> *x_max, <span class="keywordtype">float</span> *y_min, <span class="keywordtype">float</span> *y_max, <span class="keywordtype">float</span> *z_min, <span class="keywordtype">float</span> *z_max)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;{</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordtype">float</span> xmin = FLT_MAX, xmax = FLT_MIN;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordtype">float</span> ymin = FLT_MAX, ymax = FLT_MIN;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordtype">float</span> zmin = FLT_MAX, zmax = FLT_MIN;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; t++) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> p = 0; p &lt; 3; p++) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            x = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            y = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            z = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            <span class="keywordflow">if</span> (x &gt; xmax) xmax = x;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            <span class="keywordflow">if</span> (x &lt; xmin) xmin = x;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <span class="keywordflow">if</span> (y &gt; ymax) ymax = y;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="keywordflow">if</span> (y &lt; ymin) ymin = y;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <span class="keywordflow">if</span> (z &gt; zmax) zmax = z;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <span class="keywordflow">if</span> (z &lt; zmin) zmin = z;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    *x_min = xmin;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    *x_max = xmax; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    *y_min = ymin;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    *y_max = ymax;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    *z_min = zmin;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    *z_max = zmax;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;}</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ae970b00a8720bd46cf0743327170b4c2"> 1244</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ae970b00a8720bd46cf0743327170b4c2">ae_tri_mesh_normalize</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh)</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;{</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordtype">float</span> xmax, xmin, ymax, ymin, zmax, zmin;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a63cfcc7dda05af0fe61b57f012f949d2">ae_tri_mesh_set_bounding_box</a>(mesh, &amp;xmin, &amp;xmax, &amp;ymin, &amp;ymax, &amp;zmin, &amp;zmax);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; t++) {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> p = 0; p &lt; 3; p++) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            x = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            y = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            z = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            <span class="keywordtype">float</span> xdiff = xmax-xmin;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="keywordtype">float</span> ydiff = ymax-ymin;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="keywordtype">float</span> zdiff = zmax-zmin;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <span class="keywordtype">float</span> max_diff = fmax(xdiff, fmax(ydiff, zdiff));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="keywordtype">float</span> xfactor = xdiff/max_diff;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keywordtype">float</span> yfactor = ydiff/max_diff;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keywordtype">float</span> zfactor = zdiff/max_diff;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            x = (((x - xmin) / (xdiff)) * 2 - 1) * xfactor;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            y = (((y - ymin) / (ydiff)) * 2 - 1) * yfactor;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            z = (((z - zmin) / (zdiff)) * 2 - 1) * zfactor;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = x;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = y;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[t].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[p].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = z;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01283"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ab014e21d442505ee1ca7c910a6307f8a"> 1283</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ab014e21d442505ee1ca7c910a6307f8a">ae_tri_mesh_flip_normals</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;{</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; i++) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <a class="code" href="structTri.html">Tri</a> res_tri, tri = mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i];</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        res_tri.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a> = tri.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        res_tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0]          = tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2];</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        res_tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[0] = tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[2];</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        res_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0]         = tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[2];</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        res_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0]          = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2];</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        res_tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[0]      = tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[2];</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        res_tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1]          = tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        res_tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[1] = tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[1];</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        res_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[1]         = tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[1];</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        res_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1]          = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1];</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        res_tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[1]      = tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[1];</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        res_tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]          = tri.<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        res_tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[2] = tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[0];</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        res_tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[2]         = tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[0];</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        res_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2]          = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0];</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        res_tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[2]      = tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[0];</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a11c1d61181fe9b0d824fb2be51662659">ae_tri_set_normals</a>(&amp;res_tri);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i] = res_tri;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;}</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aa8b3ea525ba405673473938bf9065c63"> 1321</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#aa8b3ea525ba405673473938bf9065c63">ae_tri_mesh_set_normals</a>(<a class="code" href="structTri__mesh.html">Tri_mesh</a> mesh)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;{</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mesh.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; i++) {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a11c1d61181fe9b0d824fb2be51662659">ae_tri_set_normals</a>(&amp;(mesh.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i]));</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;}</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ae7bccc35b4caefa9f167e3267813e921"> 1336</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ae7bccc35b4caefa9f167e3267813e921">ae_quad_set_normals</a>(<a class="code" href="structQuad.html">Quad</a> *quad)</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;{</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> point  = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> to_p   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> from_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> normal = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordtype">int</span> current_index  = i;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="keywordtype">int</span> next_index     = (i + 1) % 4;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keywordtype">int</span> previous_index = (i - 1 + 4) % 4;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad-&gt;<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[current_index], point);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad-&gt;<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[next_index], from_p);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad-&gt;<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[previous_index], to_p);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(from_p, point);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(point, to_p);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(to_p, point);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <a class="code" href="Matrix2D_8h.html#a195a44f3fe41a5c25f431b9a0c43ea48">mat2D_cross</a>(normal, to_p, from_p);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <a class="code" href="Matrix2D_8h.html#af74e919ae2726605b4b8edfbcd639a64">mat2D_normalize</a>(normal);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        quad-&gt;<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[current_index] = <a class="code" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a>(normal);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(point);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(to_p);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(from_p);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(normal);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;}</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a13940b94d775b4887b34e03ffff9661e"> 1379</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#a13940b94d775b4887b34e03ffff9661e">ae_quad_get_average_normal</a>(<a class="code" href="structQuad.html">Quad</a> quad)</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;{</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="structPoint.html">Point</a> normal0 = quad.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[0];</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="structPoint.html">Point</a> normal1 = quad.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[1];</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="structPoint.html">Point</a> normal2 = quad.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[2];</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="structPoint.html">Point</a> normal3 = quad.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[3];</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <a class="code" href="structPoint.html">Point</a> res;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    res.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = (normal0.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + normal1.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + normal2.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + normal3.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) / 4;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    res.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = (normal0.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + normal1.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + normal2.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + normal3.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) / 4;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    res.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = (normal0.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + normal1.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + normal2.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + normal3.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>) / 4;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    res.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = (normal0.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + normal1.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + normal2.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + normal3.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) / 4;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    res = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(res);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;}</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad1f69bc7c34ba800623bdc3e693a2bcb"> 1403</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#ad1f69bc7c34ba800623bdc3e693a2bcb">ae_quad_get_average_point</a>(<a class="code" href="structQuad.html">Quad</a> quad)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;{</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <a class="code" href="structPoint.html">Point</a> point0 = quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <a class="code" href="structPoint.html">Point</a> point1 = quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <a class="code" href="structPoint.html">Point</a> point2 = quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="structPoint.html">Point</a> point3 = quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="structPoint.html">Point</a> res;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    res.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = (point0.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + point1.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + point2.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + point3.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) / 4;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    res.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = (point0.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + point1.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + point2.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + point3.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) / 4;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    res.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = (point0.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + point1.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + point2.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> + point3.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>) / 4;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    res.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = (point0.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + point1.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + point2.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> + point3.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) / 4;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160; </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;}</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#af54cb5c301bedf21f37ed3fdaf7287b5"> 1428</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#af54cb5c301bedf21f37ed3fdaf7287b5">ae_quad_calc_normal</a>(<a class="code" href="structMat2D.html">Mat2D</a> normal, <a class="code" href="structQuad.html">Quad</a> quad)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;{</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(3 == normal.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a> &amp;&amp; 1 == normal.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(quad);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> a = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> b = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> c = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], a);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], b);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], c);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(b, a);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(c, a);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <a class="code" href="Matrix2D_8h.html#a195a44f3fe41a5c25f431b9a0c43ea48">mat2D_cross</a>(normal, b, c);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(normal, 1/<a class="code" href="Matrix2D_8h.html#abda90a369811f8c2693911008994f6ec">mat2D_calc_norma</a>(normal));</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(a);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(b);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(c);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;}</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aac75dd9d298e655d12249edc154e7591"> 1461</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#aac75dd9d298e655d12249edc154e7591">ae_curve_copy</a>(<a class="code" href="structCurve.html">Curve</a> *des, <a class="code" href="structCurve.html">Curve</a> src)</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;{</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="structCurve.html">Curve</a> temp_des = *des;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    temp_des.<a class="code" href="structCurve.html#a883f62ca803547dbfe6159200e775b76">length</a> = 0;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; src.<a class="code" href="structCurve.html#a883f62ca803547dbfe6159200e775b76">length</a>; i++) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structPoint.html">Point</a>, temp_des, src.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[i]);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    }</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    *des = temp_des;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;}</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#abbea9d10462f28e6e52352a6c36ffabd"> 1487</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#abbea9d10462f28e6e52352a6c36ffabd">ae_tri_calc_light_intensity</a>(<a class="code" href="structTri.html">Tri</a> *tri, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;{</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="comment">/* based on the lighting model described in: &#39;Alexandru C. Telea-Data Visualization_ Principles and Practice-A K Peters_CRC Press (2014)&#39; Pg.29 */</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <a class="code" href="structPoint.html">Point</a> L = {0};</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="structPoint.html">Point</a> r = {0};</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <a class="code" href="structPoint.html">Point</a> v = {0};</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <a class="code" href="structPoint.html">Point</a> mL = {0};</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <a class="code" href="structPoint.html">Point</a> pml = {0};</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <a class="code" href="structPoint.html">Point</a> mLn2n = {0};</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <a class="code" href="structPoint.html">Point</a> ave_norm = <a class="code" href="Almog__Engine_8h.html#ae88854393111f68a7fcc4977070d981b">ae_tri_get_average_normal</a>(*tri);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="structPoint.html">Point</a> camera_pos = <a class="code" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordtype">float</span> c_ambi = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a198bf89cad562cca2c4c7015f9f81e86">c_ambi</a>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordtype">float</span> c_diff = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a380c5e541b1fe955a6bb96d35293cff4">c_diff</a>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordtype">float</span> c_spec = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a27cc8a0811ea2dc434d7cc4ab9785917">c_spec</a>;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordtype">float</span> alpha  = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a5e9c413095df430758f6b31c9bfb60e1">specular_power_alpha</a>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">switch</span> (lighting_mode) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ad2872f5089e1989c79eaf9a2d83faceb">AE_LIGHTING_FLAT</a>:</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> == 0) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                L = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                L = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(L);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                mL = L;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                <a class="code" href="structPoint.html">Point</a> l = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                <a class="code" href="structPoint.html">Point</a> p = tri-&gt;<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i];</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(pml, p, l);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                pml = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(pml);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                L = pml;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                L.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = 0;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                mL = L;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(v, camera_pos, <a class="code" href="Almog__Engine_8h.html#a3ee60e72e8969b1cf15d333a091f8ae7">ae_tri_get_average_point</a>(*tri));</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="keywordtype">float</span> mL_dot_norm = <a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(mL, ave_norm);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            mLn2n = ave_norm;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mLn2n, 2 * mL_dot_norm);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a79d5f5baf43bc7a9c1c9d5ae1d3a18c3">ae_point_add_point</a>(r, L, mLn2n);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            tri-&gt;<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[i] = c_ambi + scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">light_intensity</a> * (c_diff * fmaxf(mL_dot_norm, 0) + c_spec * powf(fmaxf(<a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(r, v), 0), alpha));</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501a960031a84842327b8c9061dc0f9752b6">AE_LIGHTING_SMOOTH</a>:</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> == 0) {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                L = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                L = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(L);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                mL = L;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                <a class="code" href="structPoint.html">Point</a> l = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                <a class="code" href="structPoint.html">Point</a> p = tri-&gt;<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i];</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(pml, p, l);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                pml = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(pml);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                L = pml;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                L.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = 0;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                mL = L;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(v, camera_pos, tri-&gt;<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i]);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <span class="keywordtype">float</span> mL_dot_norm = <a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(mL, tri-&gt;<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[i]);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            mLn2n = tri-&gt;<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[i];</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mLn2n, 2 * mL_dot_norm);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a79d5f5baf43bc7a9c1c9d5ae1d3a18c3">ae_point_add_point</a>(r, L, mLn2n);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            tri-&gt;<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[i] = c_ambi + scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">light_intensity</a> * (c_diff * fmaxf(mL_dot_norm, 0) + c_spec * powf(fmaxf(<a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(r, v), 0), alpha));</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            tri-&gt;<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[i] = 1;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        tri-&gt;<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[i] = fminf(1, fmaxf(0, tri-&gt;<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[i]));</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;}</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a36c108042b6ed289b4d0f85f8c5700ee"> 1580</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a36c108042b6ed289b4d0f85f8c5700ee">ae_quad_calc_light_intensity</a>(<a class="code" href="structQuad.html">Quad</a> *quad, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;{</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">/* based on the lighting model described in: &#39;Alexandru C. Telea-Data Visualization_ Principles and Practice-A K Peters_CRC Press (2014)&#39; Pg.29 */</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <a class="code" href="structPoint.html">Point</a> L = {0};</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <a class="code" href="structPoint.html">Point</a> r = {0};</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <a class="code" href="structPoint.html">Point</a> v = {0};</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <a class="code" href="structPoint.html">Point</a> mL = {0};</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <a class="code" href="structPoint.html">Point</a> pml = {0};</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <a class="code" href="structPoint.html">Point</a> mLn2n = {0};</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <a class="code" href="structPoint.html">Point</a> ave_norm = <a class="code" href="Almog__Engine_8h.html#a13940b94d775b4887b34e03ffff9661e">ae_quad_get_average_normal</a>(*quad);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <a class="code" href="structPoint.html">Point</a> camera_pos = <a class="code" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a>(scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordtype">float</span> c_ambi = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a198bf89cad562cca2c4c7015f9f81e86">c_ambi</a>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordtype">float</span> c_diff = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a380c5e541b1fe955a6bb96d35293cff4">c_diff</a>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordtype">float</span> c_spec = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a27cc8a0811ea2dc434d7cc4ab9785917">c_spec</a>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordtype">float</span> alpha  = scene-&gt;<a class="code" href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">material0</a>.<a class="code" href="structMaterial.html#a5e9c413095df430758f6b31c9bfb60e1">specular_power_alpha</a>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="keywordflow">switch</span> (lighting_mode) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ad2872f5089e1989c79eaf9a2d83faceb">AE_LIGHTING_FLAT</a>:</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> == 0) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                L = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                L = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(L);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                mL = L;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                <a class="code" href="structPoint.html">Point</a> l = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                <a class="code" href="structPoint.html">Point</a> p = quad-&gt;<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i];</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(pml, p, l);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                pml = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(pml);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                L = pml;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                L.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = 0;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                mL = L;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(v, camera_pos, <a class="code" href="Almog__Engine_8h.html#ad1f69bc7c34ba800623bdc3e693a2bcb">ae_quad_get_average_point</a>(*quad));</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keywordtype">float</span> mL_dot_norm = <a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(mL, ave_norm);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            mLn2n = ave_norm;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mLn2n, 2 * mL_dot_norm);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a79d5f5baf43bc7a9c1c9d5ae1d3a18c3">ae_point_add_point</a>(r, L, mLn2n);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            quad-&gt;<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[i] = c_ambi + scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">light_intensity</a> * (c_diff * fmaxf(mL_dot_norm, 0) + c_spec * powf(fmaxf(<a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(r, v), 0), alpha));</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501a960031a84842327b8c9061dc0f9752b6">AE_LIGHTING_SMOOTH</a>:</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="keywordflow">if</span> (scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> == 0) {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                L = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                L = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(L);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                mL = L;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                <a class="code" href="structPoint.html">Point</a> l = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                <a class="code" href="structPoint.html">Point</a> p = quad-&gt;<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i];</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(pml, p, l);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                pml = <a class="code" href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a>(pml);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                L = pml;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                L.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = 0;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                mL = L;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mL, -1);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a>(v, camera_pos, quad-&gt;<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i]);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="keywordtype">float</span> mL_dot_norm = <a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(mL, quad-&gt;<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[i]);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            mLn2n = quad-&gt;<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[i];</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a>(mLn2n, 2 * mL_dot_norm);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a79d5f5baf43bc7a9c1c9d5ae1d3a18c3">ae_point_add_point</a>(r, L, mLn2n);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            quad-&gt;<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[i] = c_ambi + scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">light_intensity</a> * (c_diff * fmaxf(mL_dot_norm, 0) + c_spec * powf(fmaxf(<a class="code" href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a>(r, v), 0), alpha));</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            quad-&gt;<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[i] = 1;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        quad-&gt;<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[i] = fminf(1, fmaxf(0, quad-&gt;<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[i]));</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;}</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7"> 1680</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(<a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structMat2D.html">Mat2D</a> line_start, <a class="code" href="structMat2D.html">Mat2D</a> line_end, <span class="keywordtype">float</span> *t)</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;{</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <a class="code" href="Matrix2D_8h.html#af74e919ae2726605b4b8edfbcd639a64">mat2D_normalize</a>(plane_n);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordtype">float</span> plane_d = - <a class="code" href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a>(plane_n, plane_p);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordtype">float</span> ad = <a class="code" href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a>(line_start, plane_n);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordtype">float</span> bd = <a class="code" href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a>(line_end, plane_n);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    *t  = (- plane_d - ad) / (bd - ad);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(line_end, line_start);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> line_start_to_end = line_end;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(line_start_to_end, *t);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> line_to_intersection = line_start_to_end;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> intersection_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(intersection_p, 0);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <a class="code" href="Matrix2D_8h.html#aed7c0d494d147d19864b273f91c39423">mat2D_add</a>(intersection_p, line_start);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="Matrix2D_8h.html#aed7c0d494d147d19864b273f91c39423">mat2D_add</a>(intersection_p, line_to_intersection);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <a class="code" href="structPoint.html">Point</a> ans_p = <a class="code" href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a>(intersection_p);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(intersection_p);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">return</span> ans_p;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;}</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0"> 1720</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a>(<a class="code" href="structPoint.html">Point</a> start_in, <a class="code" href="structPoint.html">Point</a> end_in, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structPoint.html">Point</a> *start_out, <a class="code" href="structPoint.html">Point</a> *end_out)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;{</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(start_in);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(end_in);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <a class="code" href="Matrix2D_8h.html#af74e919ae2726605b4b8edfbcd639a64">mat2D_normalize</a>(plane_n);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="comment">/* if the signed distance is positive, the point lies on the &quot;inside&quot; of the plane */</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <a class="code" href="structPoint.html">Point</a> inside_points[2];</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <a class="code" href="structPoint.html">Point</a> outside_points[2];</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordtype">int</span> inside_points_count = 0;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordtype">int</span> outside_points_count = 0;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="comment">/* calc signed distance of each point of tri_in */</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordtype">float</span> d0 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(start_in, plane_p, plane_n);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordtype">float</span> d1 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(end_in, plane_p, plane_n);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordtype">float</span> t;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="comment">// float epsilon = 1e-3;</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordtype">float</span> epsilon = 0;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">if</span> (d0 &gt;= epsilon) {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        inside_points[inside_points_count++] = start_in;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        outside_points[outside_points_count++] = start_in;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">if</span> (d1 &gt;= epsilon) {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        inside_points[inside_points_count++] = end_in;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        outside_points[outside_points_count++] = end_in;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160; </div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">/* classifying the triangle points */</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordflow">if</span> (outside_points_count == 2) {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        *start_out = start_in;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        *end_out = end_in;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d0 &gt;= epsilon &amp;&amp; d1 &lt; epsilon) {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        *start_out = inside_points[0];</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        *end_out = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(*start_out);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(*end_out);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d1 &gt;= epsilon &amp;&amp; d0 &lt; epsilon) {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        *end_out = inside_points[0];</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        *start_out = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(*start_out);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(*end_out);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;}</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71"> 1807</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(<a class="code" href="structPoint.html">Point</a> p, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;{</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(p);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="comment">// mat2D_normalize(plane_n);</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="comment">// Mat2D p_mat2D = mat2D_alloc(3, 1);</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">// ae_point_to_mat2D(p, p_mat2D);</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="comment">// float res = mat2D_dot_product(plane_n, p_mat2D) - mat2D_dot_product(plane_n, plane_p); </span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordtype">float</span> res = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_n, 0, 0) * p.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_n, 1, 0) * p.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_n, 2, 0) * p.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> - (<a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_n, 0, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_p, 0, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_n, 1, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_p, 1, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_n, 2, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(plane_p, 2, 0)); </div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">// mat2D_free(p_mat2D);</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;}</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8"> 1838</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a>(<a class="code" href="structTri.html">Tri</a> tri_in, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structTri.html">Tri</a> *tri_out1, <a class="code" href="structTri.html">Tri</a> *tri_out2)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;{</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(tri_in);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <a class="code" href="Matrix2D_8h.html#af74e919ae2726605b4b8edfbcd639a64">mat2D_normalize</a>(plane_n);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160; </div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">/* if the signed distance is positive, the point lies on the &quot;inside&quot; of the plane */</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <a class="code" href="structPoint.html">Point</a> inside_points[3];</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <a class="code" href="structPoint.html">Point</a> outside_points[3];</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordtype">int</span> inside_points_count = 0;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordtype">int</span> outside_points_count = 0;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <a class="code" href="structPoint.html">Point</a> tex_inside_points[3];</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <a class="code" href="structPoint.html">Point</a> tex_outside_points[3];</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordtype">int</span> tex_inside_points_count = 0;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordtype">int</span> tex_outside_points_count = 0;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="comment">/* calc signed distance of each point of tri_in */</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordtype">float</span> d0 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0], plane_p, plane_n);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordtype">float</span> d1 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1], plane_p, plane_n);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordtype">float</span> d2 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2], plane_p, plane_n);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordtype">float</span> t;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="comment">// float epsilon = 1e-3;</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordtype">float</span> epsilon = 0;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">if</span> (d0 &gt;= epsilon) {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        inside_points[inside_points_count++] = tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0];</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        tex_inside_points[tex_inside_points_count++] = tri_in.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[0];</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        outside_points[outside_points_count++] = tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0];</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        tex_outside_points[tex_outside_points_count++] = tri_in.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[0];</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordflow">if</span> (d1 &gt;= epsilon) {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        inside_points[inside_points_count++] = tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1];</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        tex_inside_points[tex_inside_points_count++] = tri_in.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[1];</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        outside_points[outside_points_count++] = tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1];</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        tex_outside_points[tex_outside_points_count++] = tri_in.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[1];</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordflow">if</span> (d2 &gt;= epsilon) {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        inside_points[inside_points_count++] = tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2];</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        tex_inside_points[tex_inside_points_count++] = tri_in.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[2];</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        outside_points[outside_points_count++] = tri_in.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2];</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        tex_outside_points[tex_outside_points_count++] = tri_in.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[2];</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">/* classifying the triangle points */</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">if</span> (inside_points_count == 0) {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 3) {</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        *tri_out1 = tri_in;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 1 &amp;&amp; outside_points_count == 2 &amp;&amp; d2 &gt;= epsilon) {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        *tri_out1 = tri_in;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="comment">// tri_out1-&gt;colors[0] = 0xFF0000;</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        <span class="comment">// tri_out1-&gt;colors[1] = 0xFF0000;</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="comment">// tri_out1-&gt;colors[2] = 0xFF0000;</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        (*tri_out1).<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        (*tri_out1).tex_points[0] = tex_inside_points[0];</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        (*tri_out1).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        (*tri_out1).points[1].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        (*tri_out1).tex_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        (*tri_out1).tex_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[1], line_end);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        (*tri_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        (*tri_out1).points[2].w = t * (outside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        <span class="comment">/* fixing color ordering */</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        uint32_t temp_color = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = temp_color;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out1);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 1 &amp;&amp; outside_points_count == 2 &amp;&amp; d1 &gt;= epsilon) {</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        *tri_out1 = tri_in;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="comment">// tri_out1-&gt;colors[0] = 0xFF0000;</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="comment">// tri_out1-&gt;colors[1] = 0xFF0000;</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="comment">// tri_out1-&gt;colors[2] = 0xFF0000;</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        (*tri_out1).<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        (*tri_out1).tex_points[0] = tex_inside_points[0];</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        (*tri_out1).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        (*tri_out1).points[1].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        (*tri_out1).tex_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        (*tri_out1).tex_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[1], line_end);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        (*tri_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        (*tri_out1).points[2].w = t * (outside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <span class="comment">/* fixing color ordering */</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        uint32_t temp_color = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = temp_color;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        temp_color = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = temp_color;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out1);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 1 &amp;&amp; outside_points_count == 2 &amp;&amp; d0 &gt;= epsilon) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        *tri_out1 = tri_in;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">// tri_out1-&gt;colors[0] = 0xFF0000;</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="comment">// tri_out1-&gt;colors[1] = 0xFF0000;</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="comment">// tri_out1-&gt;colors[2] = 0xFF0000;</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        (*tri_out1).<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        (*tri_out1).tex_points[0] = tex_inside_points[0];</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        (*tri_out1).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        (*tri_out1).points[1].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        (*tri_out1).tex_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        (*tri_out1).tex_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[1], line_end);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        (*tri_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        (*tri_out1).points[2].w = t * (outside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out1);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2 &amp;&amp; outside_points_count == 1 &amp;&amp; d2 &lt; epsilon) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        *tri_out1 = tri_in;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="comment">// tri_out1-&gt;colors[0] = 0x00FF00;</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="comment">// tri_out1-&gt;colors[1] = 0x00FF00;</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        <span class="comment">// tri_out1-&gt;colors[2] = 0x00FF00;</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        *tri_out2 = tri_in;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="comment">// tri_out2-&gt;colors[0] = 0x0000FF;</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="comment">// tri_out2-&gt;colors[1] = 0x0000FF;</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        <span class="comment">// tri_out2-&gt;colors[2] = 0x0000FF;</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        (*tri_out1).<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        (*tri_out1).tex_points[0] = tex_inside_points[0];</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        (*tri_out1).points[1] = inside_points[1];</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        (*tri_out1).tex_points[1] = tex_inside_points[1];</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        (*tri_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        (*tri_out1).points[2].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        (*tri_out2).points[0] = inside_points[1];</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        (*tri_out2).tex_points[0] = tex_inside_points[1];</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[1], line_start);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        (*tri_out2).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        (*tri_out2).points[1].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[1].w;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        (*tri_out2).tex_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[1].x;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        (*tri_out2).tex_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[1].y;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        (*tri_out2).points[2] = (*tri_out1).points[2];</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        (*tri_out2).tex_points[2] = (*tri_out1).tex_points[2];</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="comment">/* fixing color ordering */</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        uint32_t temp_color = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = temp_color;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out1);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out2);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2 &amp;&amp; outside_points_count == 1 &amp;&amp; d1 &lt; epsilon) {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        *tri_out1 = tri_in;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        <span class="comment">// tri_out1-&gt;colors[0] = 0x00FF00;</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        <span class="comment">// tri_out1-&gt;colors[1] = 0x00FF00;</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="comment">// tri_out1-&gt;colors[2] = 0x00FF00;</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        *tri_out2 = tri_in;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <span class="comment">// tri_out2-&gt;colors[0] = 0x0000FF;</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <span class="comment">// tri_out2-&gt;colors[1] = 0x0000FF;</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="comment">// tri_out2-&gt;colors[2] = 0x0000FF;</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        (*tri_out1).<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        (*tri_out1).tex_points[0] = tex_inside_points[0];</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        (*tri_out1).points[1] = inside_points[1];</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        (*tri_out1).tex_points[1] = tex_inside_points[1];</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        (*tri_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        (*tri_out1).points[2].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        (*tri_out2).points[0] = inside_points[1];</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        (*tri_out2).tex_points[0] = tex_inside_points[1];</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[1], line_start);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        (*tri_out2).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        (*tri_out2).points[1].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[1].w;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        (*tri_out2).tex_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[1].x;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        (*tri_out2).tex_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[1].y;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        (*tri_out2).points[2] = (*tri_out1).points[2];</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        (*tri_out2).tex_points[2] = (*tri_out1).tex_points[2];</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; </div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <span class="comment">/* fixing color ordering */</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        uint32_t temp_color = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = temp_color;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        temp_color = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = temp_color;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        temp_color = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1]; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = temp_color;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out1);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out2);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160; </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2 &amp;&amp; outside_points_count == 1 &amp;&amp; d0 &lt; epsilon) {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        *tri_out1 = tri_in;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="comment">// tri_out1-&gt;colors[0] = 0x00FF00;</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="comment">// tri_out1-&gt;colors[1] = 0x00FF00;</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="comment">// tri_out1-&gt;colors[2] = 0x00FF00;</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        *tri_out2 = tri_in;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        <span class="comment">// tri_out2-&gt;colors[0] = 0x0000FF;</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="comment">// tri_out2-&gt;colors[1] = 0x0000FF;</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="comment">// tri_out2-&gt;colors[2] = 0x0000FF;</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160; </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        (*tri_out1).<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        (*tri_out1).tex_points[0] = tex_inside_points[0];</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        (*tri_out1).points[1] = inside_points[1];</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        (*tri_out1).tex_points[1] = tex_inside_points[1];</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        (*tri_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        (*tri_out1).points[2].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[0].x;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        (*tri_out1).tex_points[2].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[0].y;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        (*tri_out2).points[0] = inside_points[1];</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        (*tri_out2).tex_points[0] = tex_inside_points[1];</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[1], line_start);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        (*tri_out2).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        (*tri_out2).points[1].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[1].w;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        (*tri_out2).tex_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> - tex_inside_points[1].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>) + tex_inside_points[1].x;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        (*tri_out2).tex_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = t * (tex_outside_points[0].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> - tex_inside_points[1].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>) + tex_inside_points[1].y;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        (*tri_out2).points[2] = (*tri_out1).points[2];</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        (*tri_out2).tex_points[2] = (*tri_out1).tex_points[2];</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        <span class="comment">/* fixing color ordering */</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        uint32_t temp_color = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        tri_out1-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = temp_color;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        temp_color = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2]; </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[2] = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1];</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[1] = tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0];</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        tri_out2-&gt;<a class="code" href="structTri.html#a37512ed111593b418219640902fa9663">colors</a>[0] = temp_color;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out1);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(*tri_out2);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb"> 2181</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a>(<a class="code" href="structQuad.html">Quad</a> quad_in, <a class="code" href="structMat2D.html">Mat2D</a> plane_p, <a class="code" href="structMat2D.html">Mat2D</a> plane_n, <a class="code" href="structQuad.html">Quad</a> *quad_out1, <a class="code" href="structQuad.html">Quad</a> *quad_out2)</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;{</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(quad_in);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <a class="code" href="Matrix2D_8h.html#af74e919ae2726605b4b8edfbcd639a64">mat2D_normalize</a>(plane_n);</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="comment">/* if the signed distance is positive, the point lies on the &quot;inside&quot; of the plane */</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <a class="code" href="structPoint.html">Point</a> inside_points[4];</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <a class="code" href="structPoint.html">Point</a> outside_points[4];</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordtype">int</span> inside_points_count = 0;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="keywordtype">int</span> outside_points_count = 0;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">/* calc signed distance of each point of tri_in */</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordtype">float</span> d0 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], plane_p, plane_n);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keywordtype">float</span> d1 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], plane_p, plane_n);</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordtype">float</span> d2 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], plane_p, plane_n);</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="keywordtype">float</span> d3 = <a class="code" href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], plane_p, plane_n);</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordtype">float</span> t;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="comment">// float epsilon = 1e-3;</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="keywordtype">float</span> epsilon = 0;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="keywordflow">if</span> (d0 &gt;= epsilon) {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        inside_points[inside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        outside_points[outside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">if</span> (d1 &gt;= epsilon) {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        inside_points[inside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        outside_points[outside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">if</span> (d2 &gt;= epsilon) {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        inside_points[inside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        outside_points[outside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="keywordflow">if</span> (d3 &gt;= epsilon) {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        inside_points[inside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        outside_points[outside_points_count++] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="comment">/* classifying the triangle points */</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="keywordflow">if</span> (inside_points_count == 0) {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 4) {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 1 &amp;&amp; outside_points_count == 3 &amp;&amp; d1 &gt;= epsilon) {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        *quad_out1 = quad_in;        </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        *quad_out2 = quad_in;        </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; </div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_start);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_end);</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        (*quad_out1).points[2].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        (*quad_out1).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; </div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_start);</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_end);</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        (*quad_out1).points[0] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        (*quad_out1).points[0].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        (*quad_out1).points[3].x = ((*quad_out1).points[0].x + (*quad_out1).points[2].x) / 2;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        (*quad_out1).points[3].y = ((*quad_out1).points[0].y + (*quad_out1).points[2].y) / 2;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        (*quad_out1).points[3].z = ((*quad_out1).points[0].z + (*quad_out1).points[2].z) / 2;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        (*quad_out1).points[3].w = ((*quad_out1).points[0].w + (*quad_out1).points[2].w) / 2;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        (*quad_out1).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 1 &amp;&amp; outside_points_count == 3 &amp;&amp; d2 &gt;= epsilon) {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        *quad_out1 = quad_in;        </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        *quad_out2 = quad_in;        </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_start);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_end);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        (*quad_out1).points[3].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        (*quad_out1).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_start);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_end);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        (*quad_out1).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        (*quad_out1).points[1].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        (*quad_out1).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        (*quad_out1).points[0].x = ((*quad_out1).points[3].x + (*quad_out1).points[1].x) / 2;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        (*quad_out1).points[0].y = ((*quad_out1).points[3].y + (*quad_out1).points[1].y) / 2;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        (*quad_out1).points[0].z = ((*quad_out1).points[3].z + (*quad_out1).points[1].z) / 2;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        (*quad_out1).points[0].w = ((*quad_out1).points[3].w + (*quad_out1).points[1].w) / 2;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 1 &amp;&amp; outside_points_count == 3 &amp;&amp; d3 &gt;= epsilon) {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        *quad_out1 = quad_in;        </div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        *quad_out2 = quad_in;        </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_start);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_end);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        (*quad_out1).points[0] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        (*quad_out1).points[0].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_start);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_end);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        (*quad_out1).points[2].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        (*quad_out1).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; </div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        (*quad_out1).points[1].x = ((*quad_out1).points[2].x + (*quad_out1).points[0].x) / 2;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        (*quad_out1).points[1].y = ((*quad_out1).points[2].y + (*quad_out1).points[0].y) / 2;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        (*quad_out1).points[1].z = ((*quad_out1).points[2].z + (*quad_out1).points[0].z) / 2;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        (*quad_out1).points[1].w = ((*quad_out1).points[2].w + (*quad_out1).points[0].w) / 2;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        (*quad_out1).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160; </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 1 &amp;&amp; outside_points_count == 3) {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        *quad_out1 = quad_in;        </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        *quad_out2 = quad_in;        </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        (*quad_out1).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        (*quad_out1).points[1].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[1], line_end);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        (*quad_out1).points[2].w = t * (outside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[2], line_end);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        (*quad_out1).points[3].w = t * (outside_points[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160; </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2 &amp;&amp; outside_points_count == 2 &amp;&amp; d2 &lt; epsilon &amp;&amp; d1 &lt; epsilon) {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; </div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        (*quad_out1).points[1] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        (*quad_out1).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_start);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_end);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        (*quad_out1).points[2].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        (*quad_out1).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; </div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_start);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_end);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        (*quad_out1).points[3].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        (*quad_out1).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160; </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2 &amp;&amp; outside_points_count == 2 &amp;&amp; d0 &lt; epsilon &amp;&amp; d1 &lt; epsilon) {</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        (*quad_out1).points[1] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        (*quad_out1).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; </div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_start);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_end);</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        (*quad_out1).points[3].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        (*quad_out1).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_start);</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_end);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        (*quad_out1).points[2].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        (*quad_out1).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; </div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; </div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2 &amp;&amp; outside_points_count == 2 &amp;&amp; d0 &lt; epsilon &amp;&amp; d3 &lt; epsilon) {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        (*quad_out1).points[1] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        (*quad_out1).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_start);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_end);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        (*quad_out1).points[2].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        (*quad_out1).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_start);</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_end);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        (*quad_out1).points[3].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        (*quad_out1).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; </div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; </div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 2 &amp;&amp; outside_points_count == 2) {</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160; </div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        (*quad_out1).points[1] = inside_points[1];</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[1], line_start);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        (*quad_out1).points[2].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[1].w;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[0], line_start);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[1], line_end);</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        (*quad_out1).points[3].w = t * (outside_points[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[0].w;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160; </div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 3 &amp;&amp; outside_points_count == 1 &amp;&amp; d0 &lt; epsilon) {</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;        *quad_out2 = quad_in;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_start);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_end);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        (*quad_out1).points[0] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        (*quad_out1).points[0].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[3], (quad_in).colors[0], t, &amp;((*quad_out1).colors[0]));</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160; </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        (*quad_out2).points[1] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        <span class="comment">// (*quad_out2).colors[1] = quad_in.colors[1];</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160; </div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_start);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_end);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        (*quad_out2).points[0] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        (*quad_out2).points[0].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[1], (quad_in).colors[0], t, &amp;((*quad_out2).colors[0]));</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160; </div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        (*quad_out2).points[2] = (*quad_out1).points[0];</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="comment">// (*quad_out2).colors[2] = (*quad_out1).colors[0];</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        (*quad_out2).points[3].x = ((*quad_out2).points[2].x + (*quad_out2).points[0].x) / 2;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        (*quad_out2).points[3].y = ((*quad_out2).points[2].y + (*quad_out2).points[0].y) / 2;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        (*quad_out2).points[3].z = ((*quad_out2).points[2].z + (*quad_out2).points[0].z) / 2;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        (*quad_out2).points[3].w = ((*quad_out2).points[2].w + (*quad_out2).points[0].w) / 2;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((*quad_out2).colors[2], (*quad_out2).colors[0], 0.5f, &amp;((*quad_out2).colors[3]));</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160; </div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160; </div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 3 &amp;&amp; outside_points_count == 1 &amp;&amp; d1 &lt; epsilon) {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        *quad_out2 = quad_in;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; </div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        (*quad_out1).points[2] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        (*quad_out1).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        (*quad_out1).points[3] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        (*quad_out1).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_start);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_end);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        (*quad_out1).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        (*quad_out1).points[1].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        (*quad_out1).colors[1] = (*quad_out1).colors[1];</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[2], (quad_in).colors[1], t, &amp;((*quad_out1).colors[1]));</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        (*quad_out2).points[0] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        (*quad_out2).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        (*quad_out2).points[3] = (*quad_out1).points[1];</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        (*quad_out2).colors[3] = (*quad_out1).colors[3];</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; </div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_start);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_end);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        (*quad_out2).points[1] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        (*quad_out2).points[1].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        (*quad_out2).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[0], (quad_in).colors[1], t, &amp;((*quad_out2).colors[1]));</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160; </div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        (*quad_out2).points[2].x = ((*quad_out2).points[1].x + (*quad_out2).points[3].x) / 2;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        (*quad_out2).points[2].y = ((*quad_out2).points[1].y + (*quad_out2).points[3].y) / 2;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        (*quad_out2).points[2].z = ((*quad_out2).points[1].z + (*quad_out2).points[3].z) / 2;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        (*quad_out2).points[2].w = ((*quad_out2).points[1].w + (*quad_out2).points[3].w) / 2;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((*quad_out2).colors[1], (*quad_out2).colors[3], 0.5f, &amp;((*quad_out2).colors[2]));</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 3 &amp;&amp; outside_points_count == 1 &amp;&amp; d2 &lt; epsilon) {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        </div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;        *quad_out2 = quad_in;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        (*quad_out1).points[1] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        (*quad_out1).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        (*quad_out1).points[3] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        (*quad_out1).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160; </div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1], line_start);</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_end);</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        (*quad_out1).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        (*quad_out1).points[2].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        (*quad_out1).colors[2] = (*quad_out1).colors[2];</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[2], (quad_in).colors[1], t, &amp;((*quad_out1).colors[1]));</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        (*quad_out2).points[3] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3];</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        (*quad_out2).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        (*quad_out2).points[0] = (*quad_out1).points[2];</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        (*quad_out2).colors[0] = (*quad_out1).colors[0];</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_start);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_end);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        (*quad_out2).points[2] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        (*quad_out2).points[2].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;        (*quad_out2).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[0], (quad_in).colors[1], t, &amp;((*quad_out2).colors[1]));</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        (*quad_out2).points[1].x = ((*quad_out2).points[2].x + (*quad_out2).points[0].x) / 2;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        (*quad_out2).points[1].y = ((*quad_out2).points[2].y + (*quad_out2).points[0].y) / 2;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        (*quad_out2).points[1].z = ((*quad_out2).points[2].z + (*quad_out2).points[0].z) / 2;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        (*quad_out2).points[1].w = ((*quad_out2).points[2].w + (*quad_out2).points[0].w) / 2;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((*quad_out2).colors[1], (*quad_out2).colors[3], 0.5f, &amp;((*quad_out2).colors[2]));</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; </div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160; </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 3 &amp;&amp; outside_points_count == 1 &amp;&amp; d3 &lt; epsilon) {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        *quad_out2 = quad_in;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0];</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        (*quad_out1).colors[0] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[0];</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        (*quad_out1).points[1] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[1];</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        (*quad_out1).colors[1] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[1];</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        (*quad_out1).points[2] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        (*quad_out1).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160; </div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], line_start);</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_end);</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        (*quad_out1).points[3].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        (*quad_out1).colors[3] = (*quad_out1).colors[3];</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[2], (quad_in).colors[1], t, &amp;((*quad_out1).colors[1]));</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        (*quad_out2).points[2] = quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2];</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        (*quad_out2).colors[2] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[2];</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        (*quad_out2).points[1] = (*quad_out1).points[3];</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        (*quad_out2).colors[1] = (*quad_out1).colors[1];</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2], line_start);</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3], line_end);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        (*quad_out2).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;        (*quad_out2).points[3].w = t * (quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[3].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + quad_in.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        (*quad_out2).colors[3] = quad_in.<a class="code" href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">colors</a>[3];</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((quad_in).colors[0], (quad_in).colors[1], t, &amp;((*quad_out2).colors[1]));</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;        (*quad_out2).points[0].x = ((*quad_out2).points[3].x + (*quad_out2).points[1].x) / 2;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        (*quad_out2).points[0].y = ((*quad_out2).points[3].y + (*quad_out2).points[1].y) / 2;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        (*quad_out2).points[0].z = ((*quad_out2).points[3].z + (*quad_out2).points[1].z) / 2;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        (*quad_out2).points[0].w = ((*quad_out2).points[3].w + (*quad_out2).points[1].w) / 2;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <span class="comment">// adl_interpolate_ARGBcolor_on_RGB((*quad_out2).colors[1], (*quad_out2).colors[3], 0.5f, &amp;((*quad_out2).colors[2]));</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160; </div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inside_points_count == 3 &amp;&amp; outside_points_count == 1) {</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_start = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <a class="code" href="structMat2D.html">Mat2D</a> line_end   = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        *quad_out1 = quad_in;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        (*quad_out1).<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0] = inside_points[0];</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        (*quad_out1).points[1] = inside_points[1];</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        (*quad_out1).points[2] = inside_points[2];</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(inside_points[2], line_start);</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(outside_points[0], line_end);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        (*quad_out1).points[3] = <a class="code" href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a>(plane_p, plane_n, line_start, line_end, &amp;t);</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        (*quad_out1).points[3].w = t * (outside_points[0].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> - inside_points[2].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) + inside_points[2].w;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_start);</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(line_end);</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160; </div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(*quad_out1);</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160; </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;}</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160; </div>
<div class="line"><a name="l02682"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a1b7def01c3bfc991682cdd645b806672"> 2682</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a1b7def01c3bfc991682cdd645b806672">ae_projection_mat_set</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat,<span class="keywordtype">float</span> aspect_ratio, <span class="keywordtype">float</span> FOV_deg, <span class="keywordtype">float</span> z_near, <span class="keywordtype">float</span> z_far)</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;{</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(4 == proj_mat.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>); </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(4 == proj_mat.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a>); </div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(FOV_deg &amp;&amp; <span class="stringliteral">&quot;FOV needs to bee bigger then zero&quot;</span>);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160; </div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(proj_mat, 0);</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160; </div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordtype">float</span> field_of_view = 1.0f / tanf(0.5f * FOV_deg * <a class="code" href="Matrix2D_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / 180);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <span class="keywordtype">float</span> z_normalization = z_far / (z_far - z_near);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(proj_mat, 0, 0) = aspect_ratio * field_of_view;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(proj_mat, 1, 1) = field_of_view;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(proj_mat, 2, 2) = z_normalization;</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(proj_mat, 2, 3) = 1;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(proj_mat, 3, 2) = - z_normalization * z_near;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;}</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; </div>
<div class="line"><a name="l02716"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a973977dd2f135de3e1091cf8bbd0f7ff"> 2716</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a973977dd2f135de3e1091cf8bbd0f7ff">ae_view_mat_set</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structCamera.html">Camera</a> camera, <a class="code" href="structMat2D.html">Mat2D</a> up)</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;{</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> DCM = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,3);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> DCM_trans = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3,3);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4a9489c8a78bf80f98ec7b2b9fd0888e">mat2D_set_DCM_zyx</a>(DCM, camera.<a class="code" href="structCamera.html#aff86483478f1228e641b98a9ddd13774">yaw_offset_deg</a>, camera.<a class="code" href="structCamera.html#ac744a4909bde4c4f58cc7b6918c8c7e3">pitch_offset_deg</a>, camera.<a class="code" href="structCamera.html#a5904daa05edae9d8ed86becf7b3e4059">roll_offset_deg</a>);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    <a class="code" href="Matrix2D_8h.html#a18bd1d4bbab4a1fdef11f735cb3fbf5d">mat2D_transpose</a>(DCM_trans, DCM);</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160; </div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> temp_vec = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> camera_direction = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160; </div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    <span class="comment">/* rotating camera_direction */</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(camera_direction, DCM_trans, camera.<a class="code" href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">direction</a>);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160; </div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="comment">/* calc new forward direction */</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> new_forward = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(new_forward, camera_direction);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(new_forward, 1.0 / <a class="code" href="Matrix2D_8h.html#abda90a369811f8c2693911008994f6ec">mat2D_calc_norma</a>(new_forward));</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160; </div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="comment">/* calc new up direction */</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(temp_vec, new_forward);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(temp_vec, <a class="code" href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a>(up, new_forward));</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> new_up = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(new_up, up);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(new_up, temp_vec);</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(new_up, 1.0 / <a class="code" href="Matrix2D_8h.html#abda90a369811f8c2693911008994f6ec">mat2D_calc_norma</a>(new_up));</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="comment">/* calc new right direction */</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> new_right = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <a class="code" href="Matrix2D_8h.html#a195a44f3fe41a5c25f431b9a0c43ea48">mat2D_cross</a>(new_right, new_up, new_forward);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(new_right, 1.0 / <a class="code" href="Matrix2D_8h.html#abda90a369811f8c2693911008994f6ec">mat2D_calc_norma</a>(new_right));</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160; </div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(camera.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>, new_right);</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(camera.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>, new_up);</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(camera.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>, new_forward);</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160; </div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <span class="comment">/* adding offset to init_position */</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="comment">// mat2D_add(camera_pos, camera.offset_position);</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160; </div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(temp_vec, camera.<a class="code" href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">camera_x</a>);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(temp_vec, <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>, 0, 0));</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <a class="code" href="Matrix2D_8h.html#aed7c0d494d147d19864b273f91c39423">mat2D_add</a>(camera.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, temp_vec);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(temp_vec, camera.<a class="code" href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">camera_y</a>);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(temp_vec, <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>, 1, 0));</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <a class="code" href="Matrix2D_8h.html#aed7c0d494d147d19864b273f91c39423">mat2D_add</a>(camera.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, temp_vec);</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <a class="code" href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a>(temp_vec, camera.<a class="code" href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">camera_z</a>);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    <a class="code" href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a>(temp_vec, <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>, 2, 0));</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <a class="code" href="Matrix2D_8h.html#aed7c0d494d147d19864b273f91c39423">mat2D_add</a>(camera.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, temp_vec);</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160; </div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(camera.<a class="code" href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">offset_position</a>, 0);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160; </div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 0, 0) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_right, 0, 0);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 0, 1) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_up, 0, 0);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 0, 2) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_forward, 0, 0);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 0, 3) = 0;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 1, 0) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_right, 1, 0);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 1, 1) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_up, 1, 0);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 1, 2) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_forward, 1, 0);</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 1, 3) = 0;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 2, 0) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_right, 2, 0);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 2, 1) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_up, 2, 0);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 2, 2) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(new_forward, 2, 0);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 2, 3) = 0;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 3, 0) = - <a class="code" href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a>(camera.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, new_right);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 3, 1) = - <a class="code" href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a>(camera.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, new_up);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 3, 2) = - <a class="code" href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a>(camera.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>, new_forward);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(view_mat, 3, 3) = 1;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160; </div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160; </div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(temp_vec);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(new_forward);</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(new_up);</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(new_right);</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(DCM);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(DCM_trans);</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(camera_direction);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;}</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160; </div>
<div class="line"><a name="l02806"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a45d3a5d37afa1cc50d2920d8684a5efc"> 2806</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#a45d3a5d37afa1cc50d2920d8684a5efc">ae_point_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structPoint.html">Point</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h)</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;{</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <a class="code" href="structPoint.html">Point</a> view_point = <a class="code" href="Almog__Engine_8h.html#ad43833aa381862dba7a1e91e81260103">ae_point_project_world2view</a>(view_mat, src);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    <a class="code" href="structPoint.html">Point</a> screen_point = <a class="code" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a>(proj_mat, view_point, window_w, window_h);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    <span class="keywordflow">return</span> screen_point;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;}</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02824"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad43833aa381862dba7a1e91e81260103"> 2824</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#ad43833aa381862dba7a1e91e81260103">ae_point_project_world2view</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structPoint.html">Point</a> src)</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;{</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(src);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160; </div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> src_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> des_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160; </div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <a class="code" href="structPoint.html">Point</a> des_point = {0};</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160; </div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 0) = src.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 1) = src.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 2) = src.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 3) = 1;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(des_point_mat, src_point_mat, view_mat);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160; </div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    <span class="keywordtype">double</span> w = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 3);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(w == 1);</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    des_point.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 0) / w;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    des_point.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 1) / w;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    des_point.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 2) / w;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    des_point.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = w;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160; </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(src_point_mat);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(des_point_mat);</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160; </div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="keywordflow">return</span> des_point;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;}</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02870"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a"> 2870</a></span>&#160;<a class="code" href="structPoint.html">Point</a> <a class="code" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structPoint.html">Point</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h)</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;{</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a>(src);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160; </div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> src_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> des_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <a class="code" href="structPoint.html">Point</a> des;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160; </div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 0) = src.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 1) = src.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 2) = src.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 3) = 1;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(des_point_mat, src_point_mat, proj_mat);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160; </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="keywordtype">double</span> w = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 3);</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="keywordflow">if</span> (fabs(w) &gt; 1e-3) {</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        des.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 0) / w;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        des.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 1) / w;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        des.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 2) / w;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        des.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = w;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <span class="comment">// des.x = MAT2D_AT(des_point_mat, 0, 0);</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        <span class="comment">// des.y = MAT2D_AT(des_point_mat, 0, 1);</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;        <span class="comment">// des.z = MAT2D_AT(des_point_mat, 0, 2);</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        <span class="comment">// des.w = 1;</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160; </div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        des.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = 0;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        des.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = 0;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        des.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = 0;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        des.<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = 1;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    }</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160; </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(src_point_mat);</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(des_point_mat);</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <span class="comment">/* scale into view */</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    des.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> += 1;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    des.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> += 1;</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160; </div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    des.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> *= 0.5f * window_w;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    des.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> *= 0.5f * window_h;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="keywordflow">return</span> des;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;}</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160; </div>
<div class="line"><a name="l02933"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ae7ed56cd28c920fcd190a3d8ff3e0283"> 2933</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ae7ed56cd28c920fcd190a3d8ff3e0283">ae_line_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structPoint.html">Point</a> start_src, <a class="code" href="structPoint.html">Point</a> end_src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structPoint.html">Point</a> *start_des, <a class="code" href="structPoint.html">Point</a> *end_des, <a class="code" href="structScene.html">Scene</a> *scene)</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;{</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <a class="code" href="structPoint.html">Point</a> start_view_point = <a class="code" href="Almog__Engine_8h.html#ad43833aa381862dba7a1e91e81260103">ae_point_project_world2view</a>(view_mat, start_src);</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <a class="code" href="structPoint.html">Point</a> end_view_point = <a class="code" href="Almog__Engine_8h.html#ad43833aa381862dba7a1e91e81260103">ae_point_project_world2view</a>(view_mat, end_src);</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160; </div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> z_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> z_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(z_p, 0);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(z_n, 0);</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(z_p, 2, 0) = scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">z_near</a>+0.01;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(z_n, 2, 0) = 1;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160; </div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <a class="code" href="structPoint.html">Point</a> clipped_start_view_point = {0}, clipped_end_view_point = {0};</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="keywordtype">int</span> rc = <a class="code" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a>(start_view_point, end_view_point, z_p, z_n, &amp;clipped_start_view_point, &amp;clipped_end_view_point);           </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160; </div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [error] problem with clipping lines\n&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        exit(1);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        clipped_start_view_point = (<a class="code" href="structPoint.html">Point</a>){-1,-1,1,1};</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        clipped_end_view_point = (<a class="code" href="structPoint.html">Point</a>){-1,-1,1,1};</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        start_view_point = clipped_start_view_point;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        end_view_point = clipped_end_view_point;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        </div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        *start_des = start_view_point;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        *end_des = end_view_point;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160; </div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 1) {</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        start_view_point = clipped_start_view_point;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        end_view_point = clipped_end_view_point;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    }</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160; </div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160; </div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <a class="code" href="structPoint.html">Point</a> start_screen_point = <a class="code" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a>(proj_mat, start_view_point, window_w, window_h);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    <a class="code" href="structPoint.html">Point</a> end_screen_point = <a class="code" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a>(proj_mat, end_view_point, window_w, window_h);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160; </div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(z_p);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(z_n);</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160; </div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    *start_des = start_screen_point;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    *end_des = end_screen_point;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160; </div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;}</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; </div>
<div class="line"><a name="l02988"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a1c1797fd06019133cacb5329fa1fe24e"> 2988</a></span>&#160;<a class="code" href="structTri.html">Tri</a> <a class="code" href="Almog__Engine_8h.html#a1c1797fd06019133cacb5329fa1fe24e">ae_tri_transform_to_view</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structTri.html">Tri</a> tri)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;{</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(tri);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160; </div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> src_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> des_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160; </div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <a class="code" href="structTri.html">Tri</a> des_tri = tri;</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160; </div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 0) = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 1) = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 2) = tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 3) = 1;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; </div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(des_point_mat, src_point_mat, view_mat);</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160; </div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordtype">double</span> w = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 3);</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(w == 1);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 0) / w;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 1) / w;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 2) / w;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = w;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    }</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160; </div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(src_point_mat);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(des_point_mat);</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160; </div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(des_tri);</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160; </div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordflow">return</span> des_tri;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;}</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160; </div>
<div class="line"><a name="l03038"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a58de2ce54cb320d8cade6a8de95d89d3"> 3038</a></span>&#160;<a class="code" href="structTri__mesh.html">Tri_mesh</a> <a class="code" href="Almog__Engine_8h.html#a58de2ce54cb320d8cade6a8de95d89d3">ae_tri_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structTri.html">Tri</a> tri, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode)</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;{</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(tri);</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160; </div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> tri_normal = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> temp_camera2tri = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> camera2tri = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1, 3);</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> dot_product = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1, 1);</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <a class="code" href="structTri.html">Tri</a> des_tri = tri;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160; </div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0], temp_camera2tri);</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(temp_camera2tri, scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>);</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <a class="code" href="Matrix2D_8h.html#a18bd1d4bbab4a1fdef11f735cb3fbf5d">mat2D_transpose</a>(camera2tri, temp_camera2tri);</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; </div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <span class="comment">/* calc lighting intensity of tri */</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="preprocessor">    #if 1</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;        <a class="code" href="Almog__Engine_8h.html#abbea9d10462f28e6e52352a6c36ffabd">ae_tri_calc_light_intensity</a>(&amp;des_tri, scene, lighting_mode);</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(tri.<a class="code" href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">normals</a>[i], tri_normal);</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(light_direction, 0, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(tri_normal, 0, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(light_direction, 1, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(tri_normal, 1, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(light_direction, 2, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(tri_normal, 2, 0);</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        des_tri.<a class="code" href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">light_intensity</a>[i] = fmaxf(0.2, fminf(1, <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0)));</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    }</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160; </div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    <span class="comment">/* calc if tri is visible to the camera */</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    <a class="code" href="Almog__Engine_8h.html#add210cedd8afbad661cb2afb96c077df">ae_tri_calc_normal</a>(tri_normal, tri);</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <span class="comment">// ae_point_to_mat2D(tri.normals[0], tri_normal);</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2tri, 0, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(tri_normal, 0, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2tri, 0, 1) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(tri_normal, 1, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2tri, 0, 2) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(tri_normal, 2, 0);</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) &lt; 0) {</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        des_tri.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        des_tri.<a class="code" href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">to_draw</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    }</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; </div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    <span class="comment">/* transform tri to camera view */</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    tri = <a class="code" href="Almog__Engine_8h.html#a1c1797fd06019133cacb5329fa1fe24e">ae_tri_transform_to_view</a>(view_mat, tri);</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; </div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    <span class="comment">// Tri_mesh temp_tri_array; </span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    <span class="comment">// ada_init_array(Tri, temp_tri_array);</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    <span class="comment">// ada_appand(Tri, temp_tri_array, tri);</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    <span class="comment">/* clip tir */</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <a class="code" href="structTri.html">Tri</a> clipped_tri1 = {0};</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <a class="code" href="structTri.html">Tri</a> clipped_tri2 = {0};</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> z_plane_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> z_plane_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(z_plane_p, 0);</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(z_plane_n, 0);</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(z_plane_p, 2, 0) = scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">z_near</a>+0.01;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(z_plane_n, 2, 0) = 1;</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="keywordtype">int</span> num_clipped_tri = <a class="code" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a>(tri, z_plane_p, z_plane_n, &amp;clipped_tri1, &amp;clipped_tri2);</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> temp_tri_array; </div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a>(<a class="code" href="structTri.html">Tri</a>, temp_tri_array);</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    <span class="keywordflow">if</span> (num_clipped_tri == -1) {</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [error] problem with clipping triangles\n&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        exit(1);</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_tri == 0) {</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;        ;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_tri == 1) {</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(clipped_tri1);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, temp_tri_array, clipped_tri1);</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_tri == 2) {</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(clipped_tri1);</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(clipped_tri2);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, temp_tri_array, clipped_tri1);</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, temp_tri_array, clipped_tri2);</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    }</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(z_plane_p);</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(z_plane_n);</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160; </div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> temp_tri_index = 0; temp_tri_index &lt; temp_tri_array.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; temp_tri_index++) {</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;        <span class="comment">/* project tri to screen */</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;            des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i] = <a class="code" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a>(proj_mat, temp_tri_array.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[temp_tri_index].<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i], window_w, window_h);</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160; </div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            <span class="keywordflow">if</span> (des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>) {</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                des_tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[i].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> /= des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;                des_tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[i].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> /= des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                des_tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[i].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> /= des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                des_tri.<a class="code" href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">tex_points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>  = des_tri.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a>;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;            }</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160; </div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        }</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(des_tri);</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;        temp_tri_array.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[temp_tri_index] = des_tri;</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;    }</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160; </div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(tri_normal);</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(temp_camera2tri);</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(camera2tri);</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(dot_product);</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;    <span class="keywordflow">return</span> temp_tri_array;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;}</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160; </div>
<div class="line"><a name="l03151"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad67eee66e34c55818406703f2a13ccd5"> 3151</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ad67eee66e34c55818406703f2a13ccd5">ae_tri_mesh_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structTri__mesh.html">Tri_mesh</a> *des, <a class="code" href="structTri__mesh.html">Tri_mesh</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode)</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;{</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <a class="code" href="structTri__mesh.html">Tri_mesh</a> temp_des = *des;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    temp_des.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a> = 0;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160; </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; src.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; i++) {</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;        <a class="code" href="structTri__mesh.html">Tri_mesh</a> temp_tri_array = <a class="code" href="Almog__Engine_8h.html#a58de2ce54cb320d8cade6a8de95d89d3">ae_tri_project_world2screen</a>(proj_mat, view_mat, src.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[i], window_w, window_h, scene, lighting_mode);</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160; </div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tri_index = 0; tri_index &lt; temp_tri_array.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>; tri_index++) {</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;            <a class="code" href="structTri.html">Tri</a> temp_tri = temp_tri_array.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[tri_index];</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;            <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structTri.html">Tri</a>, temp_des, temp_tri);</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        }</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160; </div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;        free(temp_tri_array.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>);</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    }</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160; </div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    <span class="comment">/* clip tir */</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> top_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> top_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(top_p, 0);</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(top_n, 0);</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(top_p, 1, 0) = 0 + offset;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(top_n, 1, 0) = 1;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160; </div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> bottom_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> bottom_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(bottom_p, 0);</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(bottom_n, 0);</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(bottom_p, 1, 0) = window_h - offset;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(bottom_n, 1, 0) = -1;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160; </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> left_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> left_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(left_p, 0);</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(left_n, 0);</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(left_p, 0, 0) = 0 + offset;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(left_n, 0, 0) = 1;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160; </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> right_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> right_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(right_p, 0);</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(right_n, 0);</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(right_p, 0, 0) = window_w - offset;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(right_n, 0, 0) = -1;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160; </div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> plane_number = 0; plane_number &lt; 4; plane_number++) {</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tri_index = 0; tri_index &lt; (int)(temp_des.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a>); tri_index++) {</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;            <span class="keywordflow">if</span> (temp_des.<a class="code" href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">length</a> == 0) {</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;            }</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;            <span class="comment">// if (temp_des.elements[tri_index].to_draw == false) {</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;            <span class="comment">//     ada_remove_unordered(Tri, temp_des, tri_index);</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;            <span class="comment">//     tri_index--;</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;            <span class="comment">//     tri_index = (int)fmaxf((float)tri_index, 0.0f);</span></div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;            <span class="comment">//     continue;</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;            <span class="comment">// }</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;            <a class="code" href="structTri.html">Tri</a> clipped_tri1 = {0};</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;            <a class="code" href="structTri.html">Tri</a> clipped_tri2 = {0};</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;            <span class="keywordtype">int</span> num_clipped_tri;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;            <span class="keywordflow">switch</span> (plane_number) {</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;                    num_clipped_tri = <a class="code" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a>(temp_des.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[tri_index], top_p, top_n, &amp;clipped_tri1, &amp;clipped_tri2);</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                    num_clipped_tri = <a class="code" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a>(temp_des.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[tri_index], right_p, right_n, &amp;clipped_tri1, &amp;clipped_tri2);</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                    num_clipped_tri = <a class="code" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a>(temp_des.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[tri_index], bottom_p, bottom_n, &amp;clipped_tri1, &amp;clipped_tri2);</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                    num_clipped_tri = <a class="code" href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a>(temp_des.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[tri_index], left_p, left_n, &amp;clipped_tri1, &amp;clipped_tri2);</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;            }</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            <span class="keywordflow">if</span> (num_clipped_tri == -1) {</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [error] problem with clipping triangles\n&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                exit(1);</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_tri == 0) {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                <a class="code" href="Almog__Dynamic__Array_8h.html#a0df1461ea637ae0948bd6dd43b5f08ed">ada_remove_unordered</a>(<a class="code" href="structTri.html">Tri</a>, temp_des, tri_index);</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                tri_index--;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                tri_index = (int)fmaxf((<span class="keywordtype">float</span>)tri_index, 0.0f);</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_tri == 1) {</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(clipped_tri1);</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                temp_des.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[tri_index] = clipped_tri1;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_tri == 2) {</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;                <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(clipped_tri1);</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                <a class="code" href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a>(clipped_tri2);</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;                temp_des.<a class="code" href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">elements</a>[tri_index] = clipped_tri1;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                <a class="code" href="Almog__Dynamic__Array_8h.html#a0c20741fa11196eb7394b8e05b8e0b48">ada_insert_unordered</a>(<a class="code" href="structTri.html">Tri</a>, temp_des, clipped_tri2, tri_index+1);</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;            }</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        }</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;    }</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160; </div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;    <span class="comment">// if (temp_des.length &gt; 2) {</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    <span class="comment">//     ae_qsort_tri(temp_des.elements, 0, temp_des.length-1);</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160; </div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(top_p);</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(top_n);</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(bottom_p);</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(bottom_n);</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(left_p);</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(left_n);</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(right_p);</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(right_n);</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160; </div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;    *des = temp_des;</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;}</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160; </div>
<div class="line"><a name="l03271"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a318de3677b5db4ffd03ae2b73a998e52"> 3271</a></span>&#160;<a class="code" href="structQuad.html">Quad</a> <a class="code" href="Almog__Engine_8h.html#a318de3677b5db4ffd03ae2b73a998e52">ae_quad_transform_to_view</a>(<a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structQuad.html">Quad</a> quad)</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;{</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(quad);</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160; </div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> src_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> des_point_mat = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1,4);</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160; </div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <a class="code" href="structQuad.html">Quad</a> des_quad = quad;</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160; </div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 0) = quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a>;</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 1) = quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a>;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 2) = quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>;</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(src_point_mat, 0, 3) = 1;</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160; </div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;        <a class="code" href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a>(des_point_mat, src_point_mat, view_mat);</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160; </div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        <span class="keywordtype">double</span> w = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 3);</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a>(w == 1);</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;        des_quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i].<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 0) / w;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;        des_quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i].<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 1) / w;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        des_quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(des_point_mat, 0, 2) / w;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;        des_quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i].<a class="code" href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">w</a> = w;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    }</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160; </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(src_point_mat);</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(des_point_mat);</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160; </div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(des_quad);</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160; </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="keywordflow">return</span> des_quad;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;}</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160; </div>
<div class="line"><a name="l03321"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a328b8b2bb3e397b7d36e72669671868e"> 3321</a></span>&#160;<a class="code" href="structQuad__mesh.html">Quad_mesh</a> <a class="code" href="Almog__Engine_8h.html#a328b8b2bb3e397b7d36e72669671868e">ae_quad_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structQuad.html">Quad</a> quad, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode)</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;{</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(quad);</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160; </div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> quad_normal = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> camera2quad = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> dot_product = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(1, 1);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <a class="code" href="structQuad.html">Quad</a> des_quad = quad;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="comment">/* calc lighting intensity of tri */</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;<span class="preprocessor">    #if 1</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a36c108042b6ed289b4d0f85f8c5700ee">ae_quad_calc_light_intensity</a>(&amp;des_quad, scene, lighting_mode);</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[i], quad_normal);</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) = scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">x</a> * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 0, 0) + scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">y</a> * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 1, 0) + scene-&gt;<a class="code" href="structScene.html#a711d71152c5504997e9cf77934ee815e">light_source0</a>.<a class="code" href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">light_direction_or_pos</a>.<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a> * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 2, 0);</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        des_quad.<a class="code" href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">light_intensity</a>[i] = fmaxf(0.2, fminf(1, <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0)));</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    }</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160; </div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <span class="comment">/* calc if quad is visible to the camera */</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    <span class="keywordtype">bool</span> visible = 0;</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="preprocessor">    #if 1</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i], camera2quad);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(camera2quad, scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad.<a class="code" href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">normals</a>[i], quad_normal);</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;        <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2quad, 0, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 0, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2quad, 1, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 1, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2quad, 2, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 2, 0);</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        visible = visible || (<a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) &lt; 0);</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    }</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[0], camera2quad);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    <a class="code" href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a>(camera2quad, scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">current_position</a>);</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160; </div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <a class="code" href="structPoint.html">Point</a> ave_norm = <a class="code" href="Almog__Engine_8h.html#a13940b94d775b4887b34e03ffff9661e">ae_quad_get_average_normal</a>(quad);</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a>(ave_norm, quad_normal);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2quad, 0, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 0, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2quad, 1, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 1, 0) + <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(camera2quad, 2, 0) * <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(quad_normal, 2, 0);</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    visible = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(dot_product, 0, 0) &lt; 0;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160; </div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    <span class="keywordflow">if</span> (visible) {</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        des_quad.<a class="code" href="structQuad.html#a583cf34675c34b1242e48cec56562f35">to_draw</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        des_quad.<a class="code" href="structQuad.html#a583cf34675c34b1242e48cec56562f35">to_draw</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    }</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160; </div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    <span class="comment">/* transform quad to camera view */</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    quad = <a class="code" href="Almog__Engine_8h.html#a318de3677b5db4ffd03ae2b73a998e52">ae_quad_transform_to_view</a>(view_mat, quad);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160; </div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;    <span class="comment">/* clip quad */</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    <a class="code" href="structQuad.html">Quad</a>  clipped_quad1 = {0}, clipped_quad2 = {0};</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> z_plane_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> z_plane_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(z_plane_p, 0);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(z_plane_n, 0);</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(z_plane_p, 2, 0) = scene-&gt;<a class="code" href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">camera</a>.<a class="code" href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">z_near</a>+0.01;</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(z_plane_n, 2, 0) = 1;</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160; </div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    <span class="keywordtype">int</span> num_clipped_quad = <a class="code" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a>(quad, z_plane_p, z_plane_n, &amp;clipped_quad1, &amp;clipped_quad2);</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <a class="code" href="structQuad__mesh.html">Quad_mesh</a> temp_quad_array; </div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <a class="code" href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a>(<a class="code" href="structQuad.html">Quad</a>, temp_quad_array);</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <span class="keywordflow">if</span> (num_clipped_quad == -1) {</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [error] problem with clipping quad\n&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;        exit(1);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_quad == 0) {</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;        ;</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_quad == 1) {</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(clipped_quad1);</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structQuad.html">Quad</a>, temp_quad_array, clipped_quad1);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_quad == 2) {</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(clipped_quad1);</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(clipped_quad2);</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structQuad.html">Quad</a>, temp_quad_array, clipped_quad1);</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;        <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structQuad.html">Quad</a>, temp_quad_array, clipped_quad2);</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;    }</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(z_plane_p);</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(z_plane_n);</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160; </div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> temp_quad_index = 0; temp_quad_index &lt; temp_quad_array.<a class="code" href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">length</a>; temp_quad_index++) {</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;        <span class="comment">/* project quad to screen */</span></div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            des_quad.<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i] = <a class="code" href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a>(proj_mat, temp_quad_array.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[temp_quad_index].<a class="code" href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">points</a>[i], window_w, window_h);</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160; </div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        }</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(des_quad);</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        temp_quad_array.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[temp_quad_index] = des_quad;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    }</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160; </div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160; </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(quad_normal);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(camera2quad);</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(dot_product);</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160; </div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="keywordflow">return</span> temp_quad_array;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;}</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160; </div>
<div class="line"><a name="l03434"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ad7415d7fdf579c8f89a5279953c1cc0f"> 3434</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#ad7415d7fdf579c8f89a5279953c1cc0f">ae_quad_mesh_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structQuad__mesh.html">Quad_mesh</a> *des, <a class="code" href="structQuad__mesh.html">Quad_mesh</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene, <a class="code" href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a> lighting_mode)</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;{</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    <a class="code" href="structQuad__mesh.html">Quad_mesh</a> temp_des = *des;</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    temp_des.<a class="code" href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">length</a> = 0;</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160; </div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; src.<a class="code" href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">length</a>; i++) {</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;        <a class="code" href="structQuad__mesh.html">Quad_mesh</a> temp_quad_array = <a class="code" href="Almog__Engine_8h.html#a328b8b2bb3e397b7d36e72669671868e">ae_quad_project_world2screen</a>(proj_mat, view_mat, src.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[i], window_w, window_h, scene, lighting_mode);</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160; </div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> quad_index = 0; quad_index &lt; temp_quad_array.<a class="code" href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">length</a>; quad_index++) {</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;            <a class="code" href="structQuad.html">Quad</a> temp_quad = temp_quad_array.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[quad_index];</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            <a class="code" href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a>(<a class="code" href="structQuad.html">Quad</a>, temp_des, temp_quad);</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;        }</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160; </div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;        free(temp_quad_array.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    }</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160; </div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160; </div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;    <span class="comment">/* clip quad */</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;    <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> top_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> top_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(top_p, 0);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(top_n, 0);</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(top_p, 1, 0) = 0 + offset;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(top_n, 1, 0) = 1;</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160; </div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> bottom_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> bottom_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(bottom_p, 0);</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(bottom_n, 0);</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(bottom_p, 1, 0) = window_h - offset;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(bottom_n, 1, 0) = -1;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160; </div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> left_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> left_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(left_p, 0);</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(left_n, 0);</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(left_p, 0, 0) = 0 + offset;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(left_n, 0, 0) = 1;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160; </div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> right_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> right_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(right_p, 0);</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(right_n, 0);</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(right_p, 0, 0) = window_w - offset;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(right_n, 0, 0) = -1;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160; </div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> plane_number = 0; plane_number &lt; 4; plane_number++) {</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> quad_index = 0; quad_index &lt; (int)(temp_des.<a class="code" href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">length</a>); quad_index++) {</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;            <span class="keywordflow">if</span> (temp_des.<a class="code" href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">length</a> == 0) {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;            }</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;            <span class="comment">// if (temp_des.elements[quad_index].to_draw == false) {</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            <span class="comment">//     ada_remove_unordered(Quad, temp_des, quad_index);</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;            <span class="comment">//     quad_index--;</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;            <span class="comment">//     quad_index = (int)fmaxf((float)quad_index, 0.0f);</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;            <span class="comment">//     continue;</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            <span class="comment">// }</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;            <a class="code" href="structQuad.html">Quad</a> clipped_quad1 = {0}, clipped_quad2 = {0};</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;            <span class="keywordtype">int</span> num_clipped_quad;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;            <span class="keywordflow">switch</span> (plane_number) {</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;                    num_clipped_quad = <a class="code" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a>(temp_des.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[quad_index], top_p, top_n, &amp;clipped_quad1, &amp;clipped_quad2);</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;                    num_clipped_quad = <a class="code" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a>(temp_des.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[quad_index], right_p, right_n, &amp;clipped_quad1, &amp;clipped_quad2);</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                    num_clipped_quad = <a class="code" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a>(temp_des.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[quad_index], bottom_p, bottom_n, &amp;clipped_quad1, &amp;clipped_quad2);</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;                    num_clipped_quad = <a class="code" href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a>(temp_des.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[quad_index], left_p, left_n, &amp;clipped_quad1, &amp;clipped_quad2);</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;            }</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;            <span class="keywordflow">if</span> (num_clipped_quad == -1) {</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [error] problem with clipping quads\n&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                exit(1);</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_quad == 0) {</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;                <a class="code" href="Almog__Dynamic__Array_8h.html#a0df1461ea637ae0948bd6dd43b5f08ed">ada_remove_unordered</a>(<a class="code" href="structQuad.html">Quad</a>, temp_des, quad_index);</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;                quad_index--;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;                quad_index = (int)fmaxf((<span class="keywordtype">float</span>)quad_index, 0.0f);</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_quad == 1) {</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(clipped_quad1);</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                temp_des.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[quad_index] = clipped_quad1;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_clipped_quad == 2) {</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(clipped_quad1);</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;                <a class="code" href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a>(clipped_quad2);</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;                temp_des.<a class="code" href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">elements</a>[quad_index] = clipped_quad1;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;                <a class="code" href="Almog__Dynamic__Array_8h.html#a0c20741fa11196eb7394b8e05b8e0b48">ada_insert_unordered</a>(<a class="code" href="structQuad.html">Quad</a>, temp_des, clipped_quad2, quad_index+1);</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;                quad_index++;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;            }</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        }</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    }</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160; </div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(top_p);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(top_n);</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(bottom_p);</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(bottom_n);</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(left_p);</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(left_n);</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(right_p);</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(right_n);</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160; </div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    *des = temp_des;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;}</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160; </div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160; </div>
<div class="line"><a name="l03558"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aaa5131f30f9d6f1844a4422c548b4295"> 3558</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#aaa5131f30f9d6f1844a4422c548b4295">ae_curve_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structCurve.html">Curve</a> *des, <a class="code" href="structCurve.html">Curve</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene)</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;{</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    <a class="code" href="Almog__Engine_8h.html#aac75dd9d298e655d12249edc154e7591">ae_curve_copy</a>(des, src);</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    <a class="code" href="structCurve.html">Curve</a> temp_des = *des;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    <span class="comment">/* set planes */</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="keywordtype">int</span> offset = 50;</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> top_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> top_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(top_p, 0);</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(top_n, 0);</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(top_p, 1, 0) = 0 + offset;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(top_n, 1, 0) = 1;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> bottom_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> bottom_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(bottom_p, 0);</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(bottom_n, 0);</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(bottom_p, 1, 0) = window_h - offset;</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(bottom_n, 1, 0) = -1;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> left_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> left_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(left_p, 0);</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(left_n, 0);</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(left_p, 0, 0) = 0 + offset;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(left_n, 0, 0) = 1;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> right_p = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    <a class="code" href="structMat2D.html">Mat2D</a> right_n = <a class="code" href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a>(3, 1);</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(right_p, 0);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a>(right_n, 0);</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(right_p, 0, 0) = window_w - offset;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(right_n, 0, 0) = -1;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160; </div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> point_index = 0; point_index &lt; temp_des.<a class="code" href="structCurve.html#a883f62ca803547dbfe6159200e775b76">length</a>-1; point_index++) {</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;        <a class="code" href="structPoint.html">Point</a> start_src_point = src.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[point_index];</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;        <a class="code" href="structPoint.html">Point</a> end_src_point = src.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[point_index+1];</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160; </div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        <a class="code" href="structPoint.html">Point</a> start_des_point = {0}, end_des_point = {0};</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;        <a class="code" href="Almog__Engine_8h.html#ae7ed56cd28c920fcd190a3d8ff3e0283">ae_line_project_world2screen</a>(view_mat, proj_mat, start_src_point, end_src_point, window_w, window_h, &amp;start_des_point, &amp;end_des_point, scene);</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160; </div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160; </div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;        <a class="code" href="structPoint.html">Point</a> clipped_start_des_point = {0}, clipped_end_des_point = {0};</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160; </div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> plane_number = 0; plane_number &lt; 4; plane_number++) {</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            <span class="keywordflow">switch</span> (plane_number) {</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                    rc = <a class="code" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a>(start_des_point, end_des_point, top_p, top_n, &amp;clipped_start_des_point, &amp;clipped_end_des_point);           </div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                    rc = <a class="code" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a>(start_des_point, end_des_point, right_p, right_n, &amp;clipped_start_des_point, &amp;clipped_end_des_point);           </div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                    rc = <a class="code" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a>(start_des_point, end_des_point, bottom_p, bottom_n, &amp;clipped_start_des_point, &amp;clipped_end_des_point);           </div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                    rc = <a class="code" href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a>(start_des_point, end_des_point, left_p, left_n, &amp;clipped_start_des_point, &amp;clipped_end_des_point);           </div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;            }</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;            <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;%s:%d: [error] problem with clipping lines\n&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                exit(1);</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                clipped_start_des_point = (<a class="code" href="structPoint.html">Point</a>){-1,-1,1,1};</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;                clipped_end_des_point = (<a class="code" href="structPoint.html">Point</a>){-1,-1,1,1};</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;                start_des_point = clipped_start_des_point;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                end_des_point = clipped_end_des_point;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                temp_des.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[point_index] = start_des_point;</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                temp_des.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[point_index+1] = end_des_point;</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 1) {</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                start_des_point = clipped_start_des_point;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                end_des_point = clipped_end_des_point;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                temp_des.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[point_index] = start_des_point;</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                temp_des.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[point_index+1] = end_des_point;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;            }</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;        }</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160; </div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    }</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160; </div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <a class="code" href="structPoint.html">Point</a> default_point = (<a class="code" href="structPoint.html">Point</a>){-1,-1,1,1};</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int)temp_des.<a class="code" href="structCurve.html#a883f62ca803547dbfe6159200e775b76">length</a>; i++) {</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Almog__Engine_8h.html#a640ff0675ee6dc6d040bf5941be08258">ae_points_equal</a>(temp_des.<a class="code" href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">elements</a>[i], default_point)) {</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;            <a class="code" href="Almog__Dynamic__Array_8h.html#a7dd2b8250e6b1be7d5a44ed761c35971">ada_remove</a>(<a class="code" href="structPoint.html">Point</a>, temp_des, i);</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;            i--;</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        }</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    }</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160; </div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    *des = temp_des;</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160; </div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(top_p);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(top_n);</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(bottom_p);</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(bottom_n);</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(left_p);</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(left_n);</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(right_p);</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    <a class="code" href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a>(right_n);</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;}</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160; </div>
<div class="line"><a name="l03670"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#af7b851c934b815c8b57bac30b0b1cdae"> 3670</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#af7b851c934b815c8b57bac30b0b1cdae">ae_curve_ada_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structCurve__ada.html">Curve_ada</a> *des, <a class="code" href="structCurve__ada.html">Curve_ada</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene)</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;{</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="structCurve__ada.html#ad3f75cc33ff2610b1ab31a64ca6ecc91">length</a> == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> curve_index = 0; curve_index &lt; src.<a class="code" href="structCurve__ada.html#ad3f75cc33ff2610b1ab31a64ca6ecc91">length</a>; curve_index++) {</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;        <a class="code" href="Almog__Engine_8h.html#aaa5131f30f9d6f1844a4422c548b4295">ae_curve_project_world2screen</a>(proj_mat, view_mat, &amp;(des-&gt;<a class="code" href="structCurve__ada.html#ac06bc687ac15c82dd410ca6634beaa68">elements</a>[curve_index]), src.<a class="code" href="structCurve__ada.html#ac06bc687ac15c82dd410ca6634beaa68">elements</a>[curve_index], window_w, window_h, scene);</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    }</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;}</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160; </div>
<div class="line"><a name="l03691"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a01d0c3758b20d64c1cbbb2a73a1cdd6c"> 3691</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a01d0c3758b20d64c1cbbb2a73a1cdd6c">ae_grid_project_world2screen</a>(<a class="code" href="structMat2D.html">Mat2D</a> proj_mat, <a class="code" href="structMat2D.html">Mat2D</a> view_mat, <a class="code" href="structGrid.html">Grid</a> des, <a class="code" href="structGrid.html">Grid</a> src, <span class="keywordtype">int</span> window_w, <span class="keywordtype">int</span> window_h, <a class="code" href="structScene.html">Scene</a> *scene)</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;{</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="structGrid.html#afdfaa9532a5e1577b99168f4160759d8">curves</a>.<a class="code" href="structCurve__ada.html#ad3f75cc33ff2610b1ab31a64ca6ecc91">length</a> == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> curve_index = 0; curve_index &lt; src.<a class="code" href="structGrid.html#afdfaa9532a5e1577b99168f4160759d8">curves</a>.<a class="code" href="structCurve__ada.html#ad3f75cc33ff2610b1ab31a64ca6ecc91">length</a>; curve_index++) {</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;        <a class="code" href="Almog__Engine_8h.html#aaa5131f30f9d6f1844a4422c548b4295">ae_curve_project_world2screen</a>(proj_mat, view_mat, &amp;(des.<a class="code" href="structGrid.html#afdfaa9532a5e1577b99168f4160759d8">curves</a>.<a class="code" href="structCurve__ada.html#ac06bc687ac15c82dd410ca6634beaa68">elements</a>[curve_index]), src.<a class="code" href="structGrid.html#afdfaa9532a5e1577b99168f4160759d8">curves</a>.<a class="code" href="structCurve__ada.html#ac06bc687ac15c82dd410ca6634beaa68">elements</a>[curve_index], window_w, window_h, scene);</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    }</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;}</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160; </div>
<div class="line"><a name="l03706"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a4140d91e2951f6867592ed4dd685b5b3"> 3706</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a4140d91e2951f6867592ed4dd685b5b3">ae_tri_swap</a>(<a class="code" href="structTri.html">Tri</a> *v, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j)</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;{</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <a class="code" href="structTri.html">Tri</a> temp;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160; </div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    temp = v[i];</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    v[i] = v[j];</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    v[j] = temp;</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;}</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160; </div>
<div class="line"><a name="l03725"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#ac07fff7a48f2dc40046df5f8794d61d2"> 3725</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Almog__Engine_8h.html#ac07fff7a48f2dc40046df5f8794d61d2">ae_tri_compare</a>(<a class="code" href="structTri.html">Tri</a> t1, <a class="code" href="structTri.html">Tri</a> t2)</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;{</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    <span class="keywordtype">float</span> t1_z_max = fmaxf(t1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>, fmaxf(t1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>, t1.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>));</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="keywordtype">float</span> t2_z_max = fmaxf(t2.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[0].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>, fmaxf(t2.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[1].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>, t2.<a class="code" href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">points</a>[2].<a class="code" href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">z</a>));</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160; </div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    <span class="keywordflow">return</span> t1_z_max &gt; t2_z_max;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;}</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160; </div>
<div class="line"><a name="l03742"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#a6163eec1246f36c8f1f16f40c436bb14"> 3742</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#a6163eec1246f36c8f1f16f40c436bb14">ae_tri_qsort</a>(<a class="code" href="structTri.html">Tri</a> *v, <span class="keywordtype">int</span> left, <span class="keywordtype">int</span> right)</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;{</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    <span class="keywordtype">int</span> i, last;</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160; </div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    <span class="keywordflow">if</span> (left &gt;= right)                  <span class="comment">/* do nothing if array contains */</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        <span class="keywordflow">return</span>;                         <span class="comment">/* fewer than two elements */</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a4140d91e2951f6867592ed4dd685b5b3">ae_tri_swap</a>(v, left, (left + right) / 2);  <span class="comment">/* move partition elem */</span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    last = left;                        <span class="comment">/* to v[0] */</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    <span class="keywordflow">for</span> (i = left + 1; i &lt;= right; i++) <span class="comment">/* partition */</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Almog__Engine_8h.html#ac07fff7a48f2dc40046df5f8794d61d2">ae_tri_compare</a>(v[i], v[left]))</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;            <a class="code" href="Almog__Engine_8h.html#a4140d91e2951f6867592ed4dd685b5b3">ae_tri_swap</a>(v, ++last, i);</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a4140d91e2951f6867592ed4dd685b5b3">ae_tri_swap</a>(v, left, last); <span class="comment">/* restore partition elem */</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a6163eec1246f36c8f1f16f40c436bb14">ae_tri_qsort</a>(v, left, last - 1);</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;    <a class="code" href="Almog__Engine_8h.html#a6163eec1246f36c8f1f16f40c436bb14">ae_tri_qsort</a>(v, last + 1, right);</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;}</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160; </div>
<div class="line"><a name="l03770"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#adfbb375cedddf064ca503a0520c66829"> 3770</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="Almog__Engine_8h.html#adfbb375cedddf064ca503a0520c66829">ae_linear_map</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> min_in, <span class="keywordtype">double</span> max_in, <span class="keywordtype">double</span> min_out, <span class="keywordtype">double</span> max_out)</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;{</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <span class="keywordflow">return</span> (min_out + ((s-min_in)*(max_out-min_out))/(max_in-min_in));</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;}</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160; </div>
<div class="line"><a name="l03785"></a><span class="lineno"><a class="line" href="Almog__Engine_8h.html#aa9ee39b8a678005ae0d531d9d1356a30"> 3785</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Almog__Engine_8h.html#aa9ee39b8a678005ae0d531d9d1356a30">ae_z_buffer_copy_to_screen</a>(<a class="code" href="structMat2D__uint32.html">Mat2D_uint32</a> screen_mat, <a class="code" href="structMat2D.html">Mat2D</a> inv_z_buffer)</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;{</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;    <span class="keywordtype">double</span> max_inv_z = 0;</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    <span class="keywordtype">double</span> min_inv_z = DBL_MAX;</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; inv_z_buffer.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a>; i++) {</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; inv_z_buffer.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>; j++) {</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(inv_z_buffer, i, j) &gt; max_inv_z) {</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;                max_inv_z = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(inv_z_buffer, i, j);</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;            }</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(inv_z_buffer, i, j) &lt; min_inv_z &amp;&amp; <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(inv_z_buffer, i, j) &gt; 0) {</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                min_inv_z = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(inv_z_buffer, i, j);</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;            }</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        }</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;    }</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; inv_z_buffer.<a class="code" href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">rows</a>; i++) {</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; inv_z_buffer.<a class="code" href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">cols</a>; j++) {</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;            <span class="keywordtype">double</span> z_fraq = <a class="code" href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a>(inv_z_buffer, i, j);</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            z_fraq = fmax(z_fraq, min_inv_z);</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;            z_fraq = <a class="code" href="Almog__Engine_8h.html#adfbb375cedddf064ca503a0520c66829">ae_linear_map</a>(z_fraq, min_inv_z, max_inv_z, 0.1, 1);</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            uint32_t color = <a class="code" href="Almog__Draw__Library_8h.html#ae5c9bd99d773c485b76cef79ced9ef29">RGB_hexRGB</a>(0xFF*z_fraq, 0xFF*z_fraq, 0xFF*z_fraq); </div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;            <a class="code" href="Matrix2D_8h.html#aa1863fe86a08bbc48ddaa1137dbb82c2">MAT2D_AT_UINT32</a>(screen_mat, i, j) = color;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;        }</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    }</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;}</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160; </div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ALMOG_ENGINE_IMPLEMENTATION */</span><span class="preprocessor"> </span><span class="comment">//</span></div>
<div class="ttc" id="aAlmog__Draw__Library_8h_html"><div class="ttname"><a href="Almog__Draw__Library_8h.html">Almog_Draw_Library.h</a></div><div class="ttdoc">Immediate-mode 2D/3D raster helpers for drawing onto Mat2D_uint32 pixel buffers.</div></div>
<div class="ttc" id="aAlmog__Draw__Library_8h_html_ae5c9bd99d773c485b76cef79ced9ef29"><div class="ttname"><a href="Almog__Draw__Library_8h.html#ae5c9bd99d773c485b76cef79ced9ef29">RGB_hexRGB</a></div><div class="ttdeci">#define RGB_hexRGB(r, g, b)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00163">Almog_Draw_Library.h:163</a></div></div>
<div class="ttc" id="aAlmog__Dynamic__Array_8h_html"><div class="ttname"><a href="Almog__Dynamic__Array_8h.html">Almog_Dynamic_Array.h</a></div></div>
<div class="ttc" id="aAlmog__Dynamic__Array_8h_html_a0c20741fa11196eb7394b8e05b8e0b48"><div class="ttname"><a href="Almog__Dynamic__Array_8h.html#a0c20741fa11196eb7394b8e05b8e0b48">ada_insert_unordered</a></div><div class="ttdeci">#define ada_insert_unordered(type, header, value, index)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Dynamic__Array_8h_source.html#l00062">Almog_Dynamic_Array.h:62</a></div></div>
<div class="ttc" id="aAlmog__Dynamic__Array_8h_html_a0df1461ea637ae0948bd6dd43b5f08ed"><div class="ttname"><a href="Almog__Dynamic__Array_8h.html#a0df1461ea637ae0948bd6dd43b5f08ed">ada_remove_unordered</a></div><div class="ttdeci">#define ada_remove_unordered(type, header, index)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Dynamic__Array_8h_source.html#l00082">Almog_Dynamic_Array.h:82</a></div></div>
<div class="ttc" id="aAlmog__Dynamic__Array_8h_html_a61680400e419e2d55c2e3cb9fe96dad7"><div class="ttname"><a href="Almog__Dynamic__Array_8h.html#a61680400e419e2d55c2e3cb9fe96dad7">ada_appand</a></div><div class="ttdeci">#define ada_appand(type, header, value)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Dynamic__Array_8h_source.html#l00044">Almog_Dynamic_Array.h:44</a></div></div>
<div class="ttc" id="aAlmog__Dynamic__Array_8h_html_a7dd2b8250e6b1be7d5a44ed761c35971"><div class="ttname"><a href="Almog__Dynamic__Array_8h.html#a7dd2b8250e6b1be7d5a44ed761c35971">ada_remove</a></div><div class="ttdeci">#define ada_remove(type, header, index)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Dynamic__Array_8h_source.html#l00073">Almog_Dynamic_Array.h:73</a></div></div>
<div class="ttc" id="aAlmog__Dynamic__Array_8h_html_aac157302e0837f301f0c915360cfb182"><div class="ttname"><a href="Almog__Dynamic__Array_8h.html#aac157302e0837f301f0c915360cfb182">ada_init_array</a></div><div class="ttdeci">#define ada_init_array(type, header)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Dynamic__Array_8h_source.html#l00027">Almog_Dynamic_Array.h:27</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a01d0c3758b20d64c1cbbb2a73a1cdd6c"><div class="ttname"><a href="Almog__Engine_8h.html#a01d0c3758b20d64c1cbbb2a73a1cdd6c">ae_grid_project_world2screen</a></div><div class="ttdeci">void ae_grid_project_world2screen(Mat2D proj_mat, Mat2D view_mat, Grid des, Grid src, int window_w, int window_h, Scene *scene)</div><div class="ttdoc">Project and clip all polylines in a Grid from world to screen.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03691">Almog_Engine.h:3691</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a11c1d61181fe9b0d824fb2be51662659"><div class="ttname"><a href="Almog__Engine_8h.html#a11c1d61181fe9b0d824fb2be51662659">ae_tri_set_normals</a></div><div class="ttdeci">void ae_tri_set_normals(Tri *tri)</div><div class="ttdoc">Compute and set per-vertex normals for a triangle.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00998">Almog_Engine.h:998</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a13940b94d775b4887b34e03ffff9661e"><div class="ttname"><a href="Almog__Engine_8h.html#a13940b94d775b4887b34e03ffff9661e">ae_quad_get_average_normal</a></div><div class="ttdeci">Point ae_quad_get_average_normal(Quad quad)</div><div class="ttdoc">Compute the average of the four vertex normals of a quad.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01379">Almog_Engine.h:1379</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a16d1ee56f32a7e62f49bdee310d580c0"><div class="ttname"><a href="Almog__Engine_8h.html#a16d1ee56f32a7e62f49bdee310d580c0">ae_line_clip_with_plane</a></div><div class="ttdeci">int ae_line_clip_with_plane(Point start_in, Point end_in, Mat2D plane_p, Mat2D plane_n, Point *start_out, Point *end_out)</div><div class="ttdoc">Clip a line segment against a plane.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01720">Almog_Engine.h:1720</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a1b7def01c3bfc991682cdd645b806672"><div class="ttname"><a href="Almog__Engine_8h.html#a1b7def01c3bfc991682cdd645b806672">ae_projection_mat_set</a></div><div class="ttdeci">void ae_projection_mat_set(Mat2D proj_mat, float aspect_ratio, float FOV_deg, float z_near, float z_far)</div><div class="ttdoc">Build a perspective projection matrix.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02682">Almog_Engine.h:2682</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a1c1797fd06019133cacb5329fa1fe24e"><div class="ttname"><a href="Almog__Engine_8h.html#a1c1797fd06019133cacb5329fa1fe24e">ae_tri_transform_to_view</a></div><div class="ttdeci">Tri ae_tri_transform_to_view(Mat2D view_mat, Tri tri)</div><div class="ttdoc">Transform a triangle from world space to view space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02988">Almog_Engine.h:2988</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a1e9358707d11584816ff73dd09aa9882"><div class="ttname"><a href="Almog__Engine_8h.html#a1e9358707d11584816ff73dd09aa9882">ae_print_tri</a></div><div class="ttdeci">void ae_print_tri(Tri tri, char *name, size_t padding)</div><div class="ttdoc">Print a triangle to stdout.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00942">Almog_Engine.h:942</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a20905d8a847c8c005e4ea73678a6a8ec"><div class="ttname"><a href="Almog__Engine_8h.html#a20905d8a847c8c005e4ea73678a6a8ec">ae_scene_init</a></div><div class="ttdeci">Scene ae_scene_init(int window_h, int window_w)</div><div class="ttdoc">Create and initialize a Scene.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00388">Almog_Engine.h:388</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a22d15e5e7a171794c5d7e984e2511beb"><div class="ttname"><a href="Almog__Engine_8h.html#a22d15e5e7a171794c5d7e984e2511beb">ae_assert_quad_is_valid</a></div><div class="ttdeci">#define ae_assert_quad_is_valid(quad)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00097">Almog_Engine.h:97</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a2b42f501a0c410d33c3c77188b2373d5"><div class="ttname"><a href="Almog__Engine_8h.html#a2b42f501a0c410d33c3c77188b2373d5">ae_tri_mesh_translate</a></div><div class="ttdeci">void ae_tri_mesh_translate(Tri_mesh mesh, float x, float y, float z)</div><div class="ttdoc">Translate a triangle mesh by (x, y, z).</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01121">Almog_Engine.h:1121</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a318de3677b5db4ffd03ae2b73a998e52"><div class="ttname"><a href="Almog__Engine_8h.html#a318de3677b5db4ffd03ae2b73a998e52">ae_quad_transform_to_view</a></div><div class="ttdeci">Quad ae_quad_transform_to_view(Mat2D view_mat, Quad quad)</div><div class="ttdoc">Transform a quad from world space to view space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03271">Almog_Engine.h:3271</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a328b8b2bb3e397b7d36e72669671868e"><div class="ttname"><a href="Almog__Engine_8h.html#a328b8b2bb3e397b7d36e72669671868e">ae_quad_project_world2screen</a></div><div class="ttdeci">Quad_mesh ae_quad_project_world2screen(Mat2D proj_mat, Mat2D view_mat, Quad quad, int window_w, int window_h, Scene *scene, Lighting_mode lighting_mode)</div><div class="ttdoc">Project a single world-space quad to screen space with clipping.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03321">Almog_Engine.h:3321</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a35a66ba0fbf0ed95b863ecde0962a496"><div class="ttname"><a href="Almog__Engine_8h.html#a35a66ba0fbf0ed95b863ecde0962a496">ae_point_to_mat2D</a></div><div class="ttdeci">void ae_point_to_mat2D(Point p, Mat2D m)</div><div class="ttdoc">Write a Point into a Mat2D vector.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00498">Almog_Engine.h:498</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a36c108042b6ed289b4d0f85f8c5700ee"><div class="ttname"><a href="Almog__Engine_8h.html#a36c108042b6ed289b4d0f85f8c5700ee">ae_quad_calc_light_intensity</a></div><div class="ttdeci">void ae_quad_calc_light_intensity(Quad *quad, Scene *scene, Lighting_mode lighting_mode)</div><div class="ttdoc">Compute per-vertex lighting intensity for a quad.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01580">Almog_Engine.h:1580</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a370cf2e354323ac710025b5c1e2c58ee"><div class="ttname"><a href="Almog__Engine_8h.html#a370cf2e354323ac710025b5c1e2c58ee">STL_HEADER_SIZE</a></div><div class="ttdeci">#define STL_HEADER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00059">Almog_Engine.h:59</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a3b664376e82e1cd4013e17ea17ac6501"><div class="ttname"><a href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501">Lighting_mode</a></div><div class="ttdeci">Lighting_mode</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00120">Almog_Engine.h:120</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a3b664376e82e1cd4013e17ea17ac6501a960031a84842327b8c9061dc0f9752b6"><div class="ttname"><a href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501a960031a84842327b8c9061dc0f9752b6">AE_LIGHTING_SMOOTH</a></div><div class="ttdeci">@ AE_LIGHTING_SMOOTH</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00122">Almog_Engine.h:122</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a3b664376e82e1cd4013e17ea17ac6501ac75a3c6fda462283fc3d03e3167f7e73"><div class="ttname"><a href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ac75a3c6fda462283fc3d03e3167f7e73">AE_LIGHTING_MODE_LENGTH</a></div><div class="ttdeci">@ AE_LIGHTING_MODE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00124">Almog_Engine.h:123</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a3b664376e82e1cd4013e17ea17ac6501ad2872f5089e1989c79eaf9a2d83faceb"><div class="ttname"><a href="Almog__Engine_8h.html#a3b664376e82e1cd4013e17ea17ac6501ad2872f5089e1989c79eaf9a2d83faceb">AE_LIGHTING_FLAT</a></div><div class="ttdeci">@ AE_LIGHTING_FLAT</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00121">Almog_Engine.h:121</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a3ee60e72e8969b1cf15d333a091f8ae7"><div class="ttname"><a href="Almog__Engine_8h.html#a3ee60e72e8969b1cf15d333a091f8ae7">ae_tri_get_average_point</a></div><div class="ttdeci">Point ae_tri_get_average_point(Tri tri)</div><div class="ttdoc">Compute the average of the three vertices of a triangle.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01062">Almog_Engine.h:1062</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a3fdac032dabf1b1b41cc4264ab5b3ed7"><div class="ttname"><a href="Almog__Engine_8h.html#a3fdac032dabf1b1b41cc4264ab5b3ed7">ae_line_itersect_plane</a></div><div class="ttdeci">Point ae_line_itersect_plane(Mat2D plane_p, Mat2D plane_n, Mat2D line_start, Mat2D line_end, float *t)</div><div class="ttdoc">Intersect a line segment with a plane.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01680">Almog_Engine.h:1680</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a4140d91e2951f6867592ed4dd685b5b3"><div class="ttname"><a href="Almog__Engine_8h.html#a4140d91e2951f6867592ed4dd685b5b3">ae_tri_swap</a></div><div class="ttdeci">void ae_tri_swap(Tri *v, int i, int j)</div><div class="ttdoc">Swap two triangles in an array.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03706">Almog_Engine.h:3706</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a4243299cc15f3c47c38f445a8e74f48e"><div class="ttname"><a href="Almog__Engine_8h.html#a4243299cc15f3c47c38f445a8e74f48e">ae_print_tri_mesh</a></div><div class="ttdeci">void ae_print_tri_mesh(Tri_mesh mesh, char *name, size_t padding)</div><div class="ttdoc">Print all triangles in a mesh to stdout.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00958">Almog_Engine.h:958</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a45967694710f3c5c2924b7afff0e9775"><div class="ttname"><a href="Almog__Engine_8h.html#a45967694710f3c5c2924b7afff0e9775">STL_ATTRIBUTE_BITS_SIZE</a></div><div class="ttdeci">#define STL_ATTRIBUTE_BITS_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00071">Almog_Engine.h:71</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a45d3a5d37afa1cc50d2920d8684a5efc"><div class="ttname"><a href="Almog__Engine_8h.html#a45d3a5d37afa1cc50d2920d8684a5efc">ae_point_project_world2screen</a></div><div class="ttdeci">Point ae_point_project_world2screen(Mat2D view_mat, Mat2D proj_mat, Point src, int window_w, int window_h)</div><div class="ttdoc">Project a point from world space directly to screen space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02806">Almog_Engine.h:2806</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a47b289604d96908f7b3ae5ea6235be9c"><div class="ttname"><a href="Almog__Engine_8h.html#a47b289604d96908f7b3ae5ea6235be9c">ae_assert_point_is_valid</a></div><div class="ttdeci">#define ae_assert_point_is_valid(p)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00089">Almog_Engine.h:89</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a4b435e38049391004f3116c7cfedce87"><div class="ttname"><a href="Almog__Engine_8h.html#a4b435e38049391004f3116c7cfedce87">ae_tri_mesh_create_copy</a></div><div class="ttdeci">void ae_tri_mesh_create_copy(Tri_mesh *des, Tri *src_elements, size_t len)</div><div class="ttdoc">Append copies of triangles to a destination Tri_mesh (resets destination length first).</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00299">Almog_Engine.h:299</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a4d2ce5dce0415cc4b1cf02c1f6c6bc77"><div class="ttname"><a href="Almog__Engine_8h.html#a4d2ce5dce0415cc4b1cf02c1f6c6bc77">ae_tri_mesh_get_from_quad_mesh</a></div><div class="ttdeci">Tri_mesh ae_tri_mesh_get_from_quad_mesh(Quad_mesh q_mesh)</div><div class="ttdoc">Convert a Quad_mesh into a Tri_mesh.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00875">Almog_Engine.h:875</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a58de2ce54cb320d8cade6a8de95d89d3"><div class="ttname"><a href="Almog__Engine_8h.html#a58de2ce54cb320d8cade6a8de95d89d3">ae_tri_project_world2screen</a></div><div class="ttdeci">Tri_mesh ae_tri_project_world2screen(Mat2D proj_mat, Mat2D view_mat, Tri tri, int window_w, int window_h, Scene *scene, Lighting_mode lighting_mode)</div><div class="ttdoc">Project a single world-space triangle to screen space with clipping.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03038">Almog_Engine.h:3038</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a6163eec1246f36c8f1f16f40c436bb14"><div class="ttname"><a href="Almog__Engine_8h.html#a6163eec1246f36c8f1f16f40c436bb14">ae_tri_qsort</a></div><div class="ttdeci">void ae_tri_qsort(Tri *v, int left, int right)</div><div class="ttdoc">Quicksort an array of triangles by depth.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03742">Almog_Engine.h:3742</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a63cfcc7dda05af0fe61b57f012f949d2"><div class="ttname"><a href="Almog__Engine_8h.html#a63cfcc7dda05af0fe61b57f012f949d2">ae_tri_mesh_set_bounding_box</a></div><div class="ttdeci">void ae_tri_mesh_set_bounding_box(Tri_mesh mesh, float *x_min, float *x_max, float *y_min, float *y_max, float *z_min, float *z_max)</div><div class="ttdoc">Compute the axis-aligned bounding box of a triangle mesh.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01206">Almog_Engine.h:1206</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a640ff0675ee6dc6d040bf5941be08258"><div class="ttname"><a href="Almog__Engine_8h.html#a640ff0675ee6dc6d040bf5941be08258">ae_points_equal</a></div><div class="ttdeci">#define ae_points_equal(p1, p2)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00117">Almog_Engine.h:117</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a79c90a129257a4d5daa335977a47b666"><div class="ttname"><a href="Almog__Engine_8h.html#a79c90a129257a4d5daa335977a47b666">ae_tri_create</a></div><div class="ttdeci">Tri ae_tri_create(Point p1, Point p2, Point p3)</div><div class="ttdoc">Create a triangle from three points.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00278">Almog_Engine.h:278</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a79d5f5baf43bc7a9c1c9d5ae1d3a18c3"><div class="ttname"><a href="Almog__Engine_8h.html#a79d5f5baf43bc7a9c1c9d5ae1d3a18c3">ae_point_add_point</a></div><div class="ttdeci">#define ae_point_add_point(p, p1, p2)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00105">Almog_Engine.h:105</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a7a7f28fc36bafd3717ab9c0fc5103e03"><div class="ttname"><a href="Almog__Engine_8h.html#a7a7f28fc36bafd3717ab9c0fc5103e03">ae_point_mult</a></div><div class="ttdeci">#define ae_point_mult(p, const)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00114">Almog_Engine.h:114</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a7b0d79ba4b2f6afdbe3c40c5a1a175de"><div class="ttname"><a href="Almog__Engine_8h.html#a7b0d79ba4b2f6afdbe3c40c5a1a175de">ae_tri_mesh_rotate_Euler_xyz</a></div><div class="ttdeci">void ae_tri_mesh_rotate_Euler_xyz(Tri_mesh mesh, float phi_deg, float theta_deg, float psi_deg)</div><div class="ttdoc">Rotate a triangle mesh using XYZ Euler angles (degrees).</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01143">Almog_Engine.h:1143</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a83b3ed3c99a19cf592c1eebed7e09f9b"><div class="ttname"><a href="Almog__Engine_8h.html#a83b3ed3c99a19cf592c1eebed7e09f9b">ae_camera_reset_pos</a></div><div class="ttdeci">void ae_camera_reset_pos(Scene *scene)</div><div class="ttdoc">Reset camera orientation and position to initial state.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00472">Almog_Engine.h:472</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a8c5f2139e3c08f222e1c1bf9ccb4c8b8"><div class="ttname"><a href="Almog__Engine_8h.html#a8c5f2139e3c08f222e1c1bf9ccb4c8b8">ae_tri_clip_with_plane</a></div><div class="ttdeci">int ae_tri_clip_with_plane(Tri tri_in, Mat2D plane_p, Mat2D plane_n, Tri *tri_out1, Tri *tri_out2)</div><div class="ttdoc">Clip a triangle against a plane.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01838">Almog_Engine.h:1838</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a9575038baa976bf6b7c39cefd2f2c80b"><div class="ttname"><a href="Almog__Engine_8h.html#a9575038baa976bf6b7c39cefd2f2c80b">ae_point_sub_point</a></div><div class="ttdeci">#define ae_point_sub_point(p, p1, p2)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00109">Almog_Engine.h:109</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a97027681fd682ebb13f18d00a188a9b1"><div class="ttname"><a href="Almog__Engine_8h.html#a97027681fd682ebb13f18d00a188a9b1">ae_point_normalize_xyz</a></div><div class="ttdeci">Point ae_point_normalize_xyz(Point p)</div><div class="ttdoc">Normalize a point's xyz to unit length.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00976">Almog_Engine.h:976</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a973977dd2f135de3e1091cf8bbd0f7ff"><div class="ttname"><a href="Almog__Engine_8h.html#a973977dd2f135de3e1091cf8bbd0f7ff">ae_view_mat_set</a></div><div class="ttdeci">void ae_view_mat_set(Mat2D view_mat, Camera camera, Mat2D up)</div><div class="ttdoc">Build a right-handed view matrix from a Camera and up vector.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02716">Almog_Engine.h:2716</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_a99f5599df51ee61f6b79cb702dd90718"><div class="ttname"><a href="Almog__Engine_8h.html#a99f5599df51ee61f6b79cb702dd90718">ae_point_calc_norma</a></div><div class="ttdeci">#define ae_point_calc_norma(p)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00104">Almog_Engine.h:104</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aa8b3ea525ba405673473938bf9065c63"><div class="ttname"><a href="Almog__Engine_8h.html#aa8b3ea525ba405673473938bf9065c63">ae_tri_mesh_set_normals</a></div><div class="ttdeci">void ae_tri_mesh_set_normals(Tri_mesh mesh)</div><div class="ttdoc">Recompute per-vertex normals for all triangles in a mesh.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01321">Almog_Engine.h:1321</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aa9ee39b8a678005ae0d531d9d1356a30"><div class="ttname"><a href="Almog__Engine_8h.html#aa9ee39b8a678005ae0d531d9d1356a30">ae_z_buffer_copy_to_screen</a></div><div class="ttdeci">void ae_z_buffer_copy_to_screen(Mat2D_uint32 screen_mat, Mat2D inv_z_buffer)</div><div class="ttdoc">Visualize an inverse-z buffer by writing a grayscale image.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03785">Almog_Engine.h:3785</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aaa5131f30f9d6f1844a4422c548b4295"><div class="ttname"><a href="Almog__Engine_8h.html#aaa5131f30f9d6f1844a4422c548b4295">ae_curve_project_world2screen</a></div><div class="ttdeci">void ae_curve_project_world2screen(Mat2D proj_mat, Mat2D view_mat, Curve *des, Curve src, int window_w, int window_h, Scene *scene)</div><div class="ttdoc">Project and clip a polyline (Curve) from world to screen space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03558">Almog_Engine.h:3558</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aac75dd9d298e655d12249edc154e7591"><div class="ttname"><a href="Almog__Engine_8h.html#aac75dd9d298e655d12249edc154e7591">ae_curve_copy</a></div><div class="ttdeci">void ae_curve_copy(Curve *des, Curve src)</div><div class="ttdoc">Copy a Curve (ADA array of points).</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01461">Almog_Engine.h:1461</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aae60309114a77dde9494d50c049998e0"><div class="ttname"><a href="Almog__Engine_8h.html#aae60309114a77dde9494d50c049998e0">ae_tri_mesh_get_from_stl_file</a></div><div class="ttdeci">Tri_mesh ae_tri_mesh_get_from_stl_file(char *file_path)</div><div class="ttdoc">Load a triangle mesh from a binary STL file.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00743">Almog_Engine.h:743</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ab014e21d442505ee1ca7c910a6307f8a"><div class="ttname"><a href="Almog__Engine_8h.html#ab014e21d442505ee1ca7c910a6307f8a">ae_tri_mesh_flip_normals</a></div><div class="ttdeci">void ae_tri_mesh_flip_normals(Tri_mesh mesh)</div><div class="ttdoc">Flip triangle winding and recompute per-vertex normals.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01283">Almog_Engine.h:1283</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_abbea9d10462f28e6e52352a6c36ffabd"><div class="ttname"><a href="Almog__Engine_8h.html#abbea9d10462f28e6e52352a6c36ffabd">ae_tri_calc_light_intensity</a></div><div class="ttdeci">void ae_tri_calc_light_intensity(Tri *tri, Scene *scene, Lighting_mode lighting_mode)</div><div class="ttdoc">Compute per-vertex lighting intensity for a triangle.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01487">Almog_Engine.h:1487</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_abf4e49af66c2e3d0c5d8fba65ce4f2bc"><div class="ttname"><a href="Almog__Engine_8h.html#abf4e49af66c2e3d0c5d8fba65ce4f2bc">ae_tri_mesh_appand_copy</a></div><div class="ttdeci">void ae_tri_mesh_appand_copy(Tri_mesh_array *mesh_array, Tri_mesh mesh)</div><div class="ttdoc">Append a copy of a Tri_mesh into a Tri_mesh_array.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00851">Almog_Engine.h:851</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ac07fff7a48f2dc40046df5f8794d61d2"><div class="ttname"><a href="Almog__Engine_8h.html#ac07fff7a48f2dc40046df5f8794d61d2">ae_tri_compare</a></div><div class="ttdeci">bool ae_tri_compare(Tri t1, Tri t2)</div><div class="ttdoc">Compare two triangles for sorting by depth.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03725">Almog_Engine.h:3725</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_acd168aacba26b933321f17d3fcd5d700"><div class="ttname"><a href="Almog__Engine_8h.html#acd168aacba26b933321f17d3fcd5d700">ae_camera_init</a></div><div class="ttdeci">void ae_camera_init(Scene *scene, int window_h, int window_w)</div><div class="ttdoc">Initialize the camera part of a Scene.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00320">Almog_Engine.h:320</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ad1f69bc7c34ba800623bdc3e693a2bcb"><div class="ttname"><a href="Almog__Engine_8h.html#ad1f69bc7c34ba800623bdc3e693a2bcb">ae_quad_get_average_point</a></div><div class="ttdeci">Point ae_quad_get_average_point(Quad quad)</div><div class="ttdoc">Compute the average of the four vertices of a quad.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01403">Almog_Engine.h:1403</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ad22d3f1e0cac0fc8d19398b0d43dbfc7"><div class="ttname"><a href="Almog__Engine_8h.html#ad22d3f1e0cac0fc8d19398b0d43dbfc7">ae_print_points</a></div><div class="ttdeci">void ae_print_points(Curve p)</div><div class="ttdoc">Print a list of points to stdout.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00925">Almog_Engine.h:925</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ad38d3a6db0cc5704ab3dc39deac988e8"><div class="ttname"><a href="Almog__Engine_8h.html#ad38d3a6db0cc5704ab3dc39deac988e8">ae_scene_free</a></div><div class="ttdeci">void ae_scene_free(Scene *scene)</div><div class="ttdoc">Free all resources owned by a Scene.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00429">Almog_Engine.h:429</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ad43833aa381862dba7a1e91e81260103"><div class="ttname"><a href="Almog__Engine_8h.html#ad43833aa381862dba7a1e91e81260103">ae_point_project_world2view</a></div><div class="ttdeci">Point ae_point_project_world2view(Mat2D view_mat, Point src)</div><div class="ttdoc">Transform a point from world space to view space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02824">Almog_Engine.h:2824</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ad51295cab44c98e63a76c2f2ecaeb16c"><div class="ttname"><a href="Almog__Engine_8h.html#ad51295cab44c98e63a76c2f2ecaeb16c">ae_assert_tri_is_valid</a></div><div class="ttdeci">#define ae_assert_tri_is_valid(tri)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00094">Almog_Engine.h:94</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ad67eee66e34c55818406703f2a13ccd5"><div class="ttname"><a href="Almog__Engine_8h.html#ad67eee66e34c55818406703f2a13ccd5">ae_tri_mesh_project_world2screen</a></div><div class="ttdeci">void ae_tri_mesh_project_world2screen(Mat2D proj_mat, Mat2D view_mat, Tri_mesh *des, Tri_mesh src, int window_w, int window_h, Scene *scene, Lighting_mode lighting_mode)</div><div class="ttdoc">Project a triangle mesh from world to screen space with clipping.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03151">Almog_Engine.h:3151</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ad7415d7fdf579c8f89a5279953c1cc0f"><div class="ttname"><a href="Almog__Engine_8h.html#ad7415d7fdf579c8f89a5279953c1cc0f">ae_quad_mesh_project_world2screen</a></div><div class="ttdeci">void ae_quad_mesh_project_world2screen(Mat2D proj_mat, Mat2D view_mat, Quad_mesh *des, Quad_mesh src, int window_w, int window_h, Scene *scene, Lighting_mode lighting_mode)</div><div class="ttdoc">Project a quad mesh from world to screen space with clipping.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03434">Almog_Engine.h:3434</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_adc4d38536e2dbc11bd68cda744bde13e"><div class="ttname"><a href="Almog__Engine_8h.html#adc4d38536e2dbc11bd68cda744bde13e">STL_NUM_SIZE</a></div><div class="ttdeci">#define STL_NUM_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00063">Almog_Engine.h:63</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_add210cedd8afbad661cb2afb96c077df"><div class="ttname"><a href="Almog__Engine_8h.html#add210cedd8afbad661cb2afb96c077df">ae_tri_calc_normal</a></div><div class="ttdeci">void ae_tri_calc_normal(Mat2D normal, Tri tri)</div><div class="ttdoc">Compute the face normal of a triangle.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01086">Almog_Engine.h:1086</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_addb82974119ee833122b944f3c0c1b71"><div class="ttname"><a href="Almog__Engine_8h.html#addb82974119ee833122b944f3c0c1b71">ae_signed_dist_point_and_plane</a></div><div class="ttdeci">float ae_signed_dist_point_and_plane(Point p, Mat2D plane_p, Mat2D plane_n)</div><div class="ttdoc">Signed distance from a point to a plane.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01807">Almog_Engine.h:1807</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_adfbb375cedddf064ca503a0520c66829"><div class="ttname"><a href="Almog__Engine_8h.html#adfbb375cedddf064ca503a0520c66829">ae_linear_map</a></div><div class="ttdeci">double ae_linear_map(double s, double min_in, double max_in, double min_out, double max_out)</div><div class="ttdoc">Linearly map a scalar from one range to another.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03770">Almog_Engine.h:3770</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ae0ee5af7ebeb8607977697ad6710723f"><div class="ttname"><a href="Almog__Engine_8h.html#ae0ee5af7ebeb8607977697ad6710723f">AE_ASSERT</a></div><div class="ttdeci">#define AE_ASSERT</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00044">Almog_Engine.h:44</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ae10d1bf00c014c797936ebea24b4e81a"><div class="ttname"><a href="Almog__Engine_8h.html#ae10d1bf00c014c797936ebea24b4e81a">ae_point_project_view2screen</a></div><div class="ttdeci">Point ae_point_project_view2screen(Mat2D proj_mat, Point src, int window_w, int window_h)</div><div class="ttdoc">Project a view-space point to screen space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02870">Almog_Engine.h:2870</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ae7bccc35b4caefa9f167e3267813e921"><div class="ttname"><a href="Almog__Engine_8h.html#ae7bccc35b4caefa9f167e3267813e921">ae_quad_set_normals</a></div><div class="ttdeci">void ae_quad_set_normals(Quad *quad)</div><div class="ttdoc">Compute and set per-vertex normals for a quad.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01336">Almog_Engine.h:1336</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ae7ed56cd28c920fcd190a3d8ff3e0283"><div class="ttname"><a href="Almog__Engine_8h.html#ae7ed56cd28c920fcd190a3d8ff3e0283">ae_line_project_world2screen</a></div><div class="ttdeci">void ae_line_project_world2screen(Mat2D view_mat, Mat2D proj_mat, Point start_src, Point end_src, int window_w, int window_h, Point *start_des, Point *end_des, Scene *scene)</div><div class="ttdoc">Project and near-clip a world-space line segment to screen space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02933">Almog_Engine.h:2933</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ae88854393111f68a7fcc4977070d981b"><div class="ttname"><a href="Almog__Engine_8h.html#ae88854393111f68a7fcc4977070d981b">ae_tri_get_average_normal</a></div><div class="ttdeci">Point ae_tri_get_average_normal(Tri tri)</div><div class="ttdoc">Compute the average of the three vertex normals of a triangle.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01041">Almog_Engine.h:1041</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_ae970b00a8720bd46cf0743327170b4c2"><div class="ttname"><a href="Almog__Engine_8h.html#ae970b00a8720bd46cf0743327170b4c2">ae_tri_mesh_normalize</a></div><div class="ttdeci">void ae_tri_mesh_normalize(Tri_mesh mesh)</div><div class="ttdoc">Normalize mesh coordinates to [-1, 1], centered at origin.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01244">Almog_Engine.h:1244</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aee42720d506b69cc9c5b329e71140412"><div class="ttname"><a href="Almog__Engine_8h.html#aee42720d506b69cc9c5b329e71140412">ae_camera_free</a></div><div class="ttdeci">void ae_camera_free(Scene *scene)</div><div class="ttdoc">Free camera-related allocations in a Scene.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00366">Almog_Engine.h:366</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aef0dc6e58e24d1fad454eedddcbecda3"><div class="ttname"><a href="Almog__Engine_8h.html#aef0dc6e58e24d1fad454eedddcbecda3">ae_tri_mesh_get_from_obj_file</a></div><div class="ttdeci">Tri_mesh ae_tri_mesh_get_from_obj_file(char *file_path)</div><div class="ttdoc">Load a triangle mesh from a Wavefront OBJ file.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00540">Almog_Engine.h:540</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_af02975c063e1ea909c3bbc94210ea85f"><div class="ttname"><a href="Almog__Engine_8h.html#af02975c063e1ea909c3bbc94210ea85f">ae_mat2D_to_point</a></div><div class="ttdeci">Point ae_mat2D_to_point(Mat2D m)</div><div class="ttdoc">Read a 3x1 Mat2D vector into a Point.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00522">Almog_Engine.h:522</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_af54cb5c301bedf21f37ed3fdaf7287b5"><div class="ttname"><a href="Almog__Engine_8h.html#af54cb5c301bedf21f37ed3fdaf7287b5">ae_quad_calc_normal</a></div><div class="ttdeci">void ae_quad_calc_normal(Mat2D normal, Quad quad)</div><div class="ttdoc">Compute the face normal of a quad using the first three vertices.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l01428">Almog_Engine.h:1428</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_af776055b6fac2e29e16d4a4fbd32d91b"><div class="ttname"><a href="Almog__Engine_8h.html#af776055b6fac2e29e16d4a4fbd32d91b">ae_point_dot_point</a></div><div class="ttdeci">#define ae_point_dot_point(p1, p2)</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00113">Almog_Engine.h:113</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_af7b851c934b815c8b57bac30b0b1cdae"><div class="ttname"><a href="Almog__Engine_8h.html#af7b851c934b815c8b57bac30b0b1cdae">ae_curve_ada_project_world2screen</a></div><div class="ttdeci">void ae_curve_ada_project_world2screen(Mat2D proj_mat, Mat2D view_mat, Curve_ada *des, Curve_ada src, int window_w, int window_h, Scene *scene)</div><div class="ttdoc">Project and clip an array of polylines from world to screen space.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l03670">Almog_Engine.h:3670</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_af8271eb7d6d313acddd78b4bcf6a8555"><div class="ttname"><a href="Almog__Engine_8h.html#af8271eb7d6d313acddd78b4bcf6a8555">ae_tri_mesh_get_from_file</a></div><div class="ttdeci">Tri_mesh ae_tri_mesh_get_from_file(char *file_path)</div><div class="ttdoc">Load a triangle mesh from a file (OBJ or STL).</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00816">Almog_Engine.h:816</a></div></div>
<div class="ttc" id="aAlmog__Engine_8h_html_aff9453f6f1fde30f7752ac03fd49aebb"><div class="ttname"><a href="Almog__Engine_8h.html#aff9453f6f1fde30f7752ac03fd49aebb">ae_quad_clip_with_plane</a></div><div class="ttdeci">int ae_quad_clip_with_plane(Quad quad_in, Mat2D plane_p, Mat2D plane_n, Quad *quad_out1, Quad *quad_out2)</div><div class="ttdoc">Clip a quad against a plane.</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l02181">Almog_Engine.h:2181</a></div></div>
<div class="ttc" id="aAlmog__String__Manipulation_8h_html"><div class="ttname"><a href="Almog__String__Manipulation_8h.html">Almog_String_Manipulation.h</a></div></div>
<div class="ttc" id="aAlmog__String__Manipulation_8h_html_a076fd3c5ba5ac7c6bbedb64c188565f3"><div class="ttname"><a href="Almog__String__Manipulation_8h.html#a076fd3c5ba5ac7c6bbedb64c188565f3">MAX_LEN_LINE</a></div><div class="ttdeci">#define MAX_LEN_LINE</div><div class="ttdef"><b>Definition:</b> <a href="Almog__String__Manipulation_8h_source.html#l00010">Almog_String_Manipulation.h:10</a></div></div>
<div class="ttc" id="aAlmog__String__Manipulation_8h_html_a1eed5e458a06330f12a09ed0c8b9d77d"><div class="ttname"><a href="Almog__String__Manipulation_8h.html#a1eed5e458a06330f12a09ed0c8b9d77d">asm_get_word_and_cut</a></div><div class="ttdeci">int asm_get_word_and_cut(char *dst, char *src, char seperator)</div></div>
<div class="ttc" id="aAlmog__String__Manipulation_8h_html_a63ffe09b30c257a91c9b48a55837dbe0"><div class="ttname"><a href="Almog__String__Manipulation_8h.html#a63ffe09b30c257a91c9b48a55837dbe0">asm_get_next_word_from_line</a></div><div class="ttdeci">int asm_get_next_word_from_line(char *dst, char *src, char seperator)</div></div>
<div class="ttc" id="aAlmog__String__Manipulation_8h_html_a8cd7d02540e05c2a9b7457500b3de50f"><div class="ttname"><a href="Almog__String__Manipulation_8h.html#a8cd7d02540e05c2a9b7457500b3de50f">asm_length</a></div><div class="ttdeci">int asm_length(char *str)</div></div>
<div class="ttc" id="aAlmog__String__Manipulation_8h_html_a8f808979502627a0266c0e374f6e1641"><div class="ttname"><a href="Almog__String__Manipulation_8h.html#a8f808979502627a0266c0e374f6e1641">asm_get_line</a></div><div class="ttdeci">int asm_get_line(FILE *fp, char *dst)</div></div>
<div class="ttc" id="aAlmog__String__Manipulation_8h_html_a929b5505a3cdb1796f2865b25b3bc92a"><div class="ttname"><a href="Almog__String__Manipulation_8h.html#a929b5505a3cdb1796f2865b25b3bc92a">asm_str_in_str</a></div><div class="ttdeci">int asm_str_in_str(char *src, char *word2search)</div></div>
<div class="ttc" id="aMatrix2D_8h_html"><div class="ttname"><a href="Matrix2D_8h.html">Matrix2D.h</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a18bd1d4bbab4a1fdef11f735cb3fbf5d"><div class="ttname"><a href="Matrix2D_8h.html#a18bd1d4bbab4a1fdef11f735cb3fbf5d">mat2D_transpose</a></div><div class="ttdeci">void mat2D_transpose(Mat2D des, Mat2D src)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00742">Matrix2D.h:742</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a195a44f3fe41a5c25f431b9a0c43ea48"><div class="ttname"><a href="Matrix2D_8h.html#a195a44f3fe41a5c25f431b9a0c43ea48">mat2D_cross</a></div><div class="ttdeci">void mat2D_cross(Mat2D dst, Mat2D a, Mat2D b)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00277">Matrix2D.h:277</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a4277c771e5ccfc6b6192f6a5e662a7b4"><div class="ttname"><a href="Matrix2D_8h.html#a4277c771e5ccfc6b6192f6a5e662a7b4">mat2D_fill</a></div><div class="ttdeci">void mat2D_fill(Mat2D m, double x)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00200">Matrix2D.h:200</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a4a9489c8a78bf80f98ec7b2b9fd0888e"><div class="ttname"><a href="Matrix2D_8h.html#a4a9489c8a78bf80f98ec7b2b9fd0888e">mat2D_set_DCM_zyx</a></div><div class="ttdeci">void mat2D_set_DCM_zyx(Mat2D DCM, float yaw_deg, float pitch_deg, float roll_deg)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00456">Matrix2D.h:456</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a4d2d183b2cb18394e8c7e1e11f97b3ef"><div class="ttname"><a href="Matrix2D_8h.html#a4d2d183b2cb18394e8c7e1e11f97b3ef">mat2D_free</a></div><div class="ttdeci">void mat2D_free(Mat2D m)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00178">Matrix2D.h:178</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a5349f2b49eb72fa91c4824b0d08f4a83"><div class="ttname"><a href="Matrix2D_8h.html#a5349f2b49eb72fa91c4824b0d08f4a83">mat2D_copy</a></div><div class="ttdeci">void mat2D_copy(Mat2D des, Mat2D src)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00476">Matrix2D.h:476</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a54befe38bb85e4e8d07030cf3c4f9e16"><div class="ttname"><a href="Matrix2D_8h.html#a54befe38bb85e4e8d07030cf3c4f9e16">mat2D_dot</a></div><div class="ttdeci">void mat2D_dot(Mat2D dst, Mat2D a, Mat2D b)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00235">Matrix2D.h:235</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="Matrix2D_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00065">Matrix2D.h:65</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a7cf78b0a4151b30bbc97f86bb8617cb3"><div class="ttname"><a href="Matrix2D_8h.html#a7cf78b0a4151b30bbc97f86bb8617cb3">mat2D_set_rot_mat_z</a></div><div class="ttdeci">void mat2D_set_rot_mat_z(Mat2D m, float angle_deg)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00444">Matrix2D.h:444</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a8d1087dbe390c9bf0f913390c3240639"><div class="ttname"><a href="Matrix2D_8h.html#a8d1087dbe390c9bf0f913390c3240639">MATRIX2D_ASSERT</a></div><div class="ttdeci">#define MATRIX2D_ASSERT</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00026">Matrix2D.h:26</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_a96b3b954a60d4f9dd6ac9954945bc749"><div class="ttname"><a href="Matrix2D_8h.html#a96b3b954a60d4f9dd6ac9954945bc749">mat2D_sub</a></div><div class="ttdeci">void mat2D_sub(Mat2D dst, Mat2D a)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00306">Matrix2D.h:306</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_aa1863fe86a08bbc48ddaa1137dbb82c2"><div class="ttname"><a href="Matrix2D_8h.html#aa1863fe86a08bbc48ddaa1137dbb82c2">MAT2D_AT_UINT32</a></div><div class="ttdeci">#define MAT2D_AT_UINT32(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00054">Matrix2D.h:54</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_aa65d8e2a4d3609149bb9a73f2839e174"><div class="ttname"><a href="Matrix2D_8h.html#aa65d8e2a4d3609149bb9a73f2839e174">mat2D_set_rot_mat_x</a></div><div class="ttdeci">void mat2D_set_rot_mat_x(Mat2D m, float angle_deg)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00420">Matrix2D.h:420</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_aa71d6e00d49857849957d6abdec1eed7"><div class="ttname"><a href="Matrix2D_8h.html#aa71d6e00d49857849957d6abdec1eed7">mat2D_dot_product</a></div><div class="ttdeci">double mat2D_dot_product(Mat2D a, Mat2D b)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00255">Matrix2D.h:255</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_ab053dbc6d1eba395817707c410b227e0"><div class="ttname"><a href="Matrix2D_8h.html#ab053dbc6d1eba395817707c410b227e0">mat2D_mult</a></div><div class="ttdeci">void mat2D_mult(Mat2D m, double factor)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00324">Matrix2D.h:324</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_ab4db0c7ac08c4e94284e4748f5c63fda"><div class="ttname"><a href="Matrix2D_8h.html#ab4db0c7ac08c4e94284e4748f5c63fda">mat2D_set_rot_mat_y</a></div><div class="ttdeci">void mat2D_set_rot_mat_y(Mat2D m, float angle_deg)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00432">Matrix2D.h:432</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_abda90a369811f8c2693911008994f6ec"><div class="ttname"><a href="Matrix2D_8h.html#abda90a369811f8c2693911008994f6ec">mat2D_calc_norma</a></div><div class="ttdeci">double mat2D_calc_norma(Mat2D m)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00576">Matrix2D.h:576</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_abdffe058c709b68f7d491ac9bf23f52e"><div class="ttname"><a href="Matrix2D_8h.html#abdffe058c709b68f7d491ac9bf23f52e">MAT2D_AT</a></div><div class="ttdeci">#define MAT2D_AT(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00053">Matrix2D.h:53</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_aea533ae4263119e0abba26e2d87182dd"><div class="ttname"><a href="Matrix2D_8h.html#aea533ae4263119e0abba26e2d87182dd">mat2D_alloc</a></div><div class="ttdeci">Mat2D mat2D_alloc(size_t rows, size_t cols)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00154">Matrix2D.h:154</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_aed7c0d494d147d19864b273f91c39423"><div class="ttname"><a href="Matrix2D_8h.html#aed7c0d494d147d19864b273f91c39423">mat2D_add</a></div><div class="ttdeci">void mat2D_add(Mat2D dst, Mat2D a)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00288">Matrix2D.h:288</a></div></div>
<div class="ttc" id="aMatrix2D_8h_html_af74e919ae2726605b4b8edfbcd639a64"><div class="ttname"><a href="Matrix2D_8h.html#af74e919ae2726605b4b8edfbcd639a64">mat2D_normalize</a></div><div class="ttdeci">#define mat2D_normalize(m)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00072">Matrix2D.h:72</a></div></div>
<div class="ttc" id="astructCamera_html"><div class="ttname"><a href="structCamera.html">Camera</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00144">Almog_Engine.h:144</a></div></div>
<div class="ttc" id="astructCamera_html_a077bf8e57757a839d13cf995c4e05ab5"><div class="ttname"><a href="structCamera.html#a077bf8e57757a839d13cf995c4e05ab5">Camera::init_position</a></div><div class="ttdeci">Mat2D init_position</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00145">Almog_Engine.h:145</a></div></div>
<div class="ttc" id="astructCamera_html_a1041adaac6e1d8aacd1d02319adeb3a1"><div class="ttname"><a href="structCamera.html#a1041adaac6e1d8aacd1d02319adeb3a1">Camera::direction</a></div><div class="ttdeci">Mat2D direction</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00148">Almog_Engine.h:148</a></div></div>
<div class="ttc" id="astructCamera_html_a14ebc5ce9490721428eaf1ca023322f9"><div class="ttname"><a href="structCamera.html#a14ebc5ce9490721428eaf1ca023322f9">Camera::z_near</a></div><div class="ttdeci">float z_near</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00149">Almog_Engine.h:149</a></div></div>
<div class="ttc" id="astructCamera_html_a16ce40de4ecd440a4ebe700e6cb97f59"><div class="ttname"><a href="structCamera.html#a16ce40de4ecd440a4ebe700e6cb97f59">Camera::camera_y</a></div><div class="ttdeci">Mat2D camera_y</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00157">Almog_Engine.h:157</a></div></div>
<div class="ttc" id="astructCamera_html_a3d5ecfc703004c3d4e1098c0e9575e35"><div class="ttname"><a href="structCamera.html#a3d5ecfc703004c3d4e1098c0e9575e35">Camera::fov_deg</a></div><div class="ttdeci">float fov_deg</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00151">Almog_Engine.h:151</a></div></div>
<div class="ttc" id="astructCamera_html_a49a09d8504a193843ae9496397a5a883"><div class="ttname"><a href="structCamera.html#a49a09d8504a193843ae9496397a5a883">Camera::z_far</a></div><div class="ttdeci">float z_far</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00150">Almog_Engine.h:150</a></div></div>
<div class="ttc" id="astructCamera_html_a5742c2c47c7afc5a6d49b6e5759db3cd"><div class="ttname"><a href="structCamera.html#a5742c2c47c7afc5a6d49b6e5759db3cd">Camera::aspect_ratio</a></div><div class="ttdeci">float aspect_ratio</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00152">Almog_Engine.h:152</a></div></div>
<div class="ttc" id="astructCamera_html_a5904daa05edae9d8ed86becf7b3e4059"><div class="ttname"><a href="structCamera.html#a5904daa05edae9d8ed86becf7b3e4059">Camera::roll_offset_deg</a></div><div class="ttdeci">float roll_offset_deg</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00153">Almog_Engine.h:153</a></div></div>
<div class="ttc" id="astructCamera_html_a9c279b07c32c1a4122dcf88fa5075bdc"><div class="ttname"><a href="structCamera.html#a9c279b07c32c1a4122dcf88fa5075bdc">Camera::camera_z</a></div><div class="ttdeci">Mat2D camera_z</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00158">Almog_Engine.h:158</a></div></div>
<div class="ttc" id="astructCamera_html_abb8a2eb94f9ef97bc23fcc3c3f220969"><div class="ttname"><a href="structCamera.html#abb8a2eb94f9ef97bc23fcc3c3f220969">Camera::camera_x</a></div><div class="ttdeci">Mat2D camera_x</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00156">Almog_Engine.h:156</a></div></div>
<div class="ttc" id="astructCamera_html_ac744a4909bde4c4f58cc7b6918c8c7e3"><div class="ttname"><a href="structCamera.html#ac744a4909bde4c4f58cc7b6918c8c7e3">Camera::pitch_offset_deg</a></div><div class="ttdeci">float pitch_offset_deg</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00154">Almog_Engine.h:154</a></div></div>
<div class="ttc" id="astructCamera_html_aca1b0a8e748059f79a00ab1a0c775624"><div class="ttname"><a href="structCamera.html#aca1b0a8e748059f79a00ab1a0c775624">Camera::offset_position</a></div><div class="ttdeci">Mat2D offset_position</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00147">Almog_Engine.h:147</a></div></div>
<div class="ttc" id="astructCamera_html_adc5641764d588d64baeb2c9a5773d2e0"><div class="ttname"><a href="structCamera.html#adc5641764d588d64baeb2c9a5773d2e0">Camera::current_position</a></div><div class="ttdeci">Mat2D current_position</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00146">Almog_Engine.h:146</a></div></div>
<div class="ttc" id="astructCamera_html_aff86483478f1228e641b98a9ddd13774"><div class="ttname"><a href="structCamera.html#aff86483478f1228e641b98a9ddd13774">Camera::yaw_offset_deg</a></div><div class="ttdeci">float yaw_offset_deg</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00155">Almog_Engine.h:155</a></div></div>
<div class="ttc" id="astructCurve__ada_html"><div class="ttname"><a href="structCurve__ada.html">Curve_ada</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00070">Almog_Draw_Library.h:70</a></div></div>
<div class="ttc" id="astructCurve__ada_html_ac06bc687ac15c82dd410ca6634beaa68"><div class="ttname"><a href="structCurve__ada.html#ac06bc687ac15c82dd410ca6634beaa68">Curve_ada::elements</a></div><div class="ttdeci">Curve * elements</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00073">Almog_Draw_Library.h:73</a></div></div>
<div class="ttc" id="astructCurve__ada_html_ad3f75cc33ff2610b1ab31a64ca6ecc91"><div class="ttname"><a href="structCurve__ada.html#ad3f75cc33ff2610b1ab31a64ca6ecc91">Curve_ada::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00071">Almog_Draw_Library.h:71</a></div></div>
<div class="ttc" id="astructCurve_html"><div class="ttname"><a href="structCurve.html">Curve</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00060">Almog_Draw_Library.h:60</a></div></div>
<div class="ttc" id="astructCurve_html_a883f62ca803547dbfe6159200e775b76"><div class="ttname"><a href="structCurve.html#a883f62ca803547dbfe6159200e775b76">Curve::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00062">Almog_Draw_Library.h:62</a></div></div>
<div class="ttc" id="astructCurve_html_a9ec44e5490914bd92c039a365980fe56"><div class="ttname"><a href="structCurve.html#a9ec44e5490914bd92c039a365980fe56">Curve::elements</a></div><div class="ttdeci">Point * elements</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00064">Almog_Draw_Library.h:64</a></div></div>
<div class="ttc" id="astructGrid_html"><div class="ttname"><a href="structGrid.html">Grid</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00139">Almog_Draw_Library.h:139</a></div></div>
<div class="ttc" id="astructGrid_html_afdfaa9532a5e1577b99168f4160759d8"><div class="ttname"><a href="structGrid.html#afdfaa9532a5e1577b99168f4160759d8">Grid::curves</a></div><div class="ttdeci">Curve_ada curves</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00140">Almog_Draw_Library.h:140</a></div></div>
<div class="ttc" id="astructLight__source_html"><div class="ttname"><a href="structLight__source.html">Light_source</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00161">Almog_Engine.h:161</a></div></div>
<div class="ttc" id="astructLight__source_html_a35f7bef9375ad1c6b3d2544c53b43493"><div class="ttname"><a href="structLight__source.html#a35f7bef9375ad1c6b3d2544c53b43493">Light_source::light_intensity</a></div><div class="ttdeci">float light_intensity</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00163">Almog_Engine.h:163</a></div></div>
<div class="ttc" id="astructLight__source_html_ac24d933710b710d1ed6d45b4696e38c8"><div class="ttname"><a href="structLight__source.html#ac24d933710b710d1ed6d45b4696e38c8">Light_source::light_direction_or_pos</a></div><div class="ttdeci">Point light_direction_or_pos</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00162">Almog_Engine.h:162</a></div></div>
<div class="ttc" id="astructMat2D__uint32_html"><div class="ttname"><a href="structMat2D__uint32.html">Mat2D_uint32</a></div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00036">Matrix2D.h:36</a></div></div>
<div class="ttc" id="astructMat2D_html"><div class="ttname"><a href="structMat2D.html">Mat2D</a></div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00029">Matrix2D.h:29</a></div></div>
<div class="ttc" id="astructMat2D_html_ae2c1f099d11352ac91db1ff1b0c8ed0a"><div class="ttname"><a href="structMat2D.html#ae2c1f099d11352ac91db1ff1b0c8ed0a">Mat2D::rows</a></div><div class="ttdeci">size_t rows</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00030">Matrix2D.h:30</a></div></div>
<div class="ttc" id="astructMat2D_html_ae9c10e24bb9e8d68c3ba96eb1cca3c5c"><div class="ttname"><a href="structMat2D.html#ae9c10e24bb9e8d68c3ba96eb1cca3c5c">Mat2D::cols</a></div><div class="ttdeci">size_t cols</div><div class="ttdef"><b>Definition:</b> <a href="Matrix2D_8h_source.html#l00031">Matrix2D.h:31</a></div></div>
<div class="ttc" id="astructMaterial_html"><div class="ttname"><a href="structMaterial.html">Material</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00166">Almog_Engine.h:166</a></div></div>
<div class="ttc" id="astructMaterial_html_a198bf89cad562cca2c4c7015f9f81e86"><div class="ttname"><a href="structMaterial.html#a198bf89cad562cca2c4c7015f9f81e86">Material::c_ambi</a></div><div class="ttdeci">float c_ambi</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00168">Almog_Engine.h:168</a></div></div>
<div class="ttc" id="astructMaterial_html_a27cc8a0811ea2dc434d7cc4ab9785917"><div class="ttname"><a href="structMaterial.html#a27cc8a0811ea2dc434d7cc4ab9785917">Material::c_spec</a></div><div class="ttdeci">float c_spec</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00170">Almog_Engine.h:170</a></div></div>
<div class="ttc" id="astructMaterial_html_a380c5e541b1fe955a6bb96d35293cff4"><div class="ttname"><a href="structMaterial.html#a380c5e541b1fe955a6bb96d35293cff4">Material::c_diff</a></div><div class="ttdeci">float c_diff</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00169">Almog_Engine.h:169</a></div></div>
<div class="ttc" id="astructMaterial_html_a5e9c413095df430758f6b31c9bfb60e1"><div class="ttname"><a href="structMaterial.html#a5e9c413095df430758f6b31c9bfb60e1">Material::specular_power_alpha</a></div><div class="ttdeci">float specular_power_alpha</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00167">Almog_Engine.h:167</a></div></div>
<div class="ttc" id="astructPoint_html"><div class="ttname"><a href="structPoint.html">Point</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00050">Almog_Draw_Library.h:50</a></div></div>
<div class="ttc" id="astructPoint_html_a05dfe2dfbde813ad234b514f30e662f1"><div class="ttname"><a href="structPoint.html#a05dfe2dfbde813ad234b514f30e662f1">Point::x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00051">Almog_Draw_Library.h:51</a></div></div>
<div class="ttc" id="astructPoint_html_a31e4e3c1137e7e992df6420e911fa595"><div class="ttname"><a href="structPoint.html#a31e4e3c1137e7e992df6420e911fa595">Point::w</a></div><div class="ttdeci">float w</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00054">Almog_Draw_Library.h:54</a></div></div>
<div class="ttc" id="astructPoint_html_a6101960c8d2d4e8ea1d32c9234bbeb8d"><div class="ttname"><a href="structPoint.html#a6101960c8d2d4e8ea1d32c9234bbeb8d">Point::y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00052">Almog_Draw_Library.h:52</a></div></div>
<div class="ttc" id="astructPoint_html_a9a666531e0e99adff132be93d2407d0c"><div class="ttname"><a href="structPoint.html#a9a666531e0e99adff132be93d2407d0c">Point::z</a></div><div class="ttdeci">float z</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00053">Almog_Draw_Library.h:53</a></div></div>
<div class="ttc" id="astructQuad__mesh__array_html"><div class="ttname"><a href="structQuad__mesh__array.html">Quad_mesh_array</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00137">Almog_Engine.h:137</a></div></div>
<div class="ttc" id="astructQuad__mesh__array_html_a74a7a2dc126bb70072ea18412f28b36a"><div class="ttname"><a href="structQuad__mesh__array.html#a74a7a2dc126bb70072ea18412f28b36a">Quad_mesh_array::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00138">Almog_Engine.h:138</a></div></div>
<div class="ttc" id="astructQuad__mesh__array_html_a79fc4899d27a540aa2e034ff3713fbf9"><div class="ttname"><a href="structQuad__mesh__array.html#a79fc4899d27a540aa2e034ff3713fbf9">Quad_mesh_array::elements</a></div><div class="ttdeci">Quad_mesh * elements</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00140">Almog_Engine.h:140</a></div></div>
<div class="ttc" id="astructQuad__mesh__array_html_a904a88351be8b3c1ac1ab34b234c9dfc"><div class="ttname"><a href="structQuad__mesh__array.html#a904a88351be8b3c1ac1ab34b234c9dfc">Quad_mesh_array::capacity</a></div><div class="ttdeci">size_t capacity</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00139">Almog_Engine.h:139</a></div></div>
<div class="ttc" id="astructQuad__mesh_html"><div class="ttname"><a href="structQuad__mesh.html">Quad_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00111">Almog_Draw_Library.h:111</a></div></div>
<div class="ttc" id="astructQuad__mesh_html_a834716c539e7ceaa66821b4f3de7744d"><div class="ttname"><a href="structQuad__mesh.html#a834716c539e7ceaa66821b4f3de7744d">Quad_mesh::elements</a></div><div class="ttdeci">Quad * elements</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00114">Almog_Draw_Library.h:114</a></div></div>
<div class="ttc" id="astructQuad__mesh_html_acf6fda7d9ed2f0c39e8ff17fb0ef521b"><div class="ttname"><a href="structQuad__mesh.html#acf6fda7d9ed2f0c39e8ff17fb0ef521b">Quad_mesh::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00112">Almog_Draw_Library.h:112</a></div></div>
<div class="ttc" id="astructQuad_html"><div class="ttname"><a href="structQuad.html">Quad</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00091">Almog_Draw_Library.h:91</a></div></div>
<div class="ttc" id="astructQuad_html_a00c91a94eee9820ce31b8ee8927368f0"><div class="ttname"><a href="structQuad.html#a00c91a94eee9820ce31b8ee8927368f0">Quad::normals</a></div><div class="ttdeci">Point normals[4]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00093">Almog_Draw_Library.h:93</a></div></div>
<div class="ttc" id="astructQuad_html_a1e9cbf4cb77c761772547fac019dccf3"><div class="ttname"><a href="structQuad.html#a1e9cbf4cb77c761772547fac019dccf3">Quad::colors</a></div><div class="ttdeci">uint32_t colors[4]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00094">Almog_Draw_Library.h:94</a></div></div>
<div class="ttc" id="astructQuad_html_a38adc543ff9f9c206f322078f008be2d"><div class="ttname"><a href="structQuad.html#a38adc543ff9f9c206f322078f008be2d">Quad::points</a></div><div class="ttdeci">Point points[4]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00092">Almog_Draw_Library.h:92</a></div></div>
<div class="ttc" id="astructQuad_html_a583cf34675c34b1242e48cec56562f35"><div class="ttname"><a href="structQuad.html#a583cf34675c34b1242e48cec56562f35">Quad::to_draw</a></div><div class="ttdeci">bool to_draw</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00095">Almog_Draw_Library.h:95</a></div></div>
<div class="ttc" id="astructQuad_html_aba6d53f3dc917e11da1715cc669589d7"><div class="ttname"><a href="structQuad.html#aba6d53f3dc917e11da1715cc669589d7">Quad::light_intensity</a></div><div class="ttdeci">float light_intensity[4]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00096">Almog_Draw_Library.h:96</a></div></div>
<div class="ttc" id="astructScene_html"><div class="ttname"><a href="structScene.html">Scene</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00173">Almog_Engine.h:173</a></div></div>
<div class="ttc" id="astructScene_html_a13d59c30261bd4a5d0186f0c2574da91"><div class="ttname"><a href="structScene.html#a13d59c30261bd4a5d0186f0c2574da91">Scene::view_mat</a></div><div class="ttdeci">Mat2D view_mat</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00185">Almog_Engine.h:185</a></div></div>
<div class="ttc" id="astructScene_html_a1c025ef379d04de976fcb20e60edddcd"><div class="ttname"><a href="structScene.html#a1c025ef379d04de976fcb20e60edddcd">Scene::proj_mat</a></div><div class="ttdeci">Mat2D proj_mat</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00184">Almog_Engine.h:184</a></div></div>
<div class="ttc" id="astructScene_html_a231ca7798cdad79a7622874c02d19d7e"><div class="ttname"><a href="structScene.html#a231ca7798cdad79a7622874c02d19d7e">Scene::projected_tri_meshes</a></div><div class="ttdeci">Tri_mesh_array projected_tri_meshes</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00175">Almog_Engine.h:175</a></div></div>
<div class="ttc" id="astructScene_html_a4e2a307f1316341bbc09a13a9c9eba0b"><div class="ttname"><a href="structScene.html#a4e2a307f1316341bbc09a13a9c9eba0b">Scene::original_tri_meshes</a></div><div class="ttdeci">Tri_mesh_array original_tri_meshes</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00176">Almog_Engine.h:176</a></div></div>
<div class="ttc" id="astructScene_html_a55369afcc314fe6bef1ecb6e0c322441"><div class="ttname"><a href="structScene.html#a55369afcc314fe6bef1ecb6e0c322441">Scene::in_world_tri_meshes</a></div><div class="ttdeci">Tri_mesh_array in_world_tri_meshes</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00174">Almog_Engine.h:174</a></div></div>
<div class="ttc" id="astructScene_html_a6cdbd482fccb87c941d6967ec8a3e97c"><div class="ttname"><a href="structScene.html#a6cdbd482fccb87c941d6967ec8a3e97c">Scene::original_quad_meshes</a></div><div class="ttdeci">Quad_mesh_array original_quad_meshes</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00180">Almog_Engine.h:180</a></div></div>
<div class="ttc" id="astructScene_html_a711d71152c5504997e9cf77934ee815e"><div class="ttname"><a href="structScene.html#a711d71152c5504997e9cf77934ee815e">Scene::light_source0</a></div><div class="ttdeci">Light_source light_source0</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00187">Almog_Engine.h:187</a></div></div>
<div class="ttc" id="astructScene_html_a85dae3b3888cc1e8e0737913217f65ce"><div class="ttname"><a href="structScene.html#a85dae3b3888cc1e8e0737913217f65ce">Scene::in_world_quad_meshes</a></div><div class="ttdeci">Quad_mesh_array in_world_quad_meshes</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00178">Almog_Engine.h:178</a></div></div>
<div class="ttc" id="astructScene_html_a8fd91747dcef00dac514445c8ea8cb9a"><div class="ttname"><a href="structScene.html#a8fd91747dcef00dac514445c8ea8cb9a">Scene::up_direction</a></div><div class="ttdeci">Mat2D up_direction</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00183">Almog_Engine.h:183</a></div></div>
<div class="ttc" id="astructScene_html_aeb8fe55dccd003fd1195ebd215a796fe"><div class="ttname"><a href="structScene.html#aeb8fe55dccd003fd1195ebd215a796fe">Scene::material0</a></div><div class="ttdeci">Material material0</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00188">Almog_Engine.h:188</a></div></div>
<div class="ttc" id="astructScene_html_afe38ffb9bbb032ccf76214207d33566f"><div class="ttname"><a href="structScene.html#afe38ffb9bbb032ccf76214207d33566f">Scene::projected_quad_meshes</a></div><div class="ttdeci">Quad_mesh_array projected_quad_meshes</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00179">Almog_Engine.h:179</a></div></div>
<div class="ttc" id="astructScene_html_afed13ec4ba2d7ab75b273d507911b498"><div class="ttname"><a href="structScene.html#afed13ec4ba2d7ab75b273d507911b498">Scene::camera</a></div><div class="ttdeci">Camera camera</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00182">Almog_Engine.h:182</a></div></div>
<div class="ttc" id="astructTri__mesh__array_html"><div class="ttname"><a href="structTri__mesh__array.html">Tri_mesh_array</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00128">Almog_Engine.h:128</a></div></div>
<div class="ttc" id="astructTri__mesh__array_html_a4227912a95f34d7640bac63b3e9da289"><div class="ttname"><a href="structTri__mesh__array.html#a4227912a95f34d7640bac63b3e9da289">Tri_mesh_array::capacity</a></div><div class="ttdeci">size_t capacity</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00130">Almog_Engine.h:130</a></div></div>
<div class="ttc" id="astructTri__mesh__array_html_acb45e304ded2b6eddf5eb3dab3e66609"><div class="ttname"><a href="structTri__mesh__array.html#acb45e304ded2b6eddf5eb3dab3e66609">Tri_mesh_array::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00129">Almog_Engine.h:129</a></div></div>
<div class="ttc" id="astructTri__mesh__array_html_afe536b7ba3c01eee05be25677d1eb692"><div class="ttname"><a href="structTri__mesh__array.html#afe536b7ba3c01eee05be25677d1eb692">Tri_mesh_array::elements</a></div><div class="ttdeci">Tri_mesh * elements</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Engine_8h_source.html#l00131">Almog_Engine.h:131</a></div></div>
<div class="ttc" id="astructTri__mesh_html"><div class="ttname"><a href="structTri__mesh.html">Tri_mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00102">Almog_Draw_Library.h:102</a></div></div>
<div class="ttc" id="astructTri__mesh_html_a0fb2a2069a57bd77bac6a91a3b2e4ffb"><div class="ttname"><a href="structTri__mesh.html#a0fb2a2069a57bd77bac6a91a3b2e4ffb">Tri_mesh::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00103">Almog_Draw_Library.h:103</a></div></div>
<div class="ttc" id="astructTri__mesh_html_ac89551cc5ed8f98f0d21a12e2c96dcdb"><div class="ttname"><a href="structTri__mesh.html#ac89551cc5ed8f98f0d21a12e2c96dcdb">Tri_mesh::elements</a></div><div class="ttdeci">Tri * elements</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00105">Almog_Draw_Library.h:105</a></div></div>
<div class="ttc" id="astructTri_html"><div class="ttname"><a href="structTri.html">Tri</a></div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00079">Almog_Draw_Library.h:79</a></div></div>
<div class="ttc" id="astructTri_html_a0cbc3520ec1e9920434c9984a8f3c345"><div class="ttname"><a href="structTri.html#a0cbc3520ec1e9920434c9984a8f3c345">Tri::tex_points</a></div><div class="ttdeci">Point tex_points[3]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00081">Almog_Draw_Library.h:81</a></div></div>
<div class="ttc" id="astructTri_html_a3614ec76d2b41cb7f1cffc66cd5482ec"><div class="ttname"><a href="structTri.html#a3614ec76d2b41cb7f1cffc66cd5482ec">Tri::normals</a></div><div class="ttdeci">Point normals[3]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00082">Almog_Draw_Library.h:82</a></div></div>
<div class="ttc" id="astructTri_html_a37512ed111593b418219640902fa9663"><div class="ttname"><a href="structTri.html#a37512ed111593b418219640902fa9663">Tri::colors</a></div><div class="ttdeci">uint32_t colors[3]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00083">Almog_Draw_Library.h:83</a></div></div>
<div class="ttc" id="astructTri_html_a38f5d10a7f896472fbd8d635f0f7cd03"><div class="ttname"><a href="structTri.html#a38f5d10a7f896472fbd8d635f0f7cd03">Tri::points</a></div><div class="ttdeci">Point points[3]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00080">Almog_Draw_Library.h:80</a></div></div>
<div class="ttc" id="astructTri_html_a5b4e4396e4ee399ff6d07ffcedaeceaa"><div class="ttname"><a href="structTri.html#a5b4e4396e4ee399ff6d07ffcedaeceaa">Tri::to_draw</a></div><div class="ttdeci">bool to_draw</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00084">Almog_Draw_Library.h:84</a></div></div>
<div class="ttc" id="astructTri_html_ae0621440deabb3071d6b2b9f88f55c34"><div class="ttname"><a href="structTri.html#ae0621440deabb3071d6b2b9f88f55c34">Tri::light_intensity</a></div><div class="ttdeci">float light_intensity[3]</div><div class="ttdef"><b>Definition:</b> <a href="Almog__Draw__Library_8h_source.html#l00085">Almog_Draw_Library.h:85</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b0856f6b0d80ccb263b2f415c91f9e17.html">include</a></li><li class="navelem"><a class="el" href="Almog__Engine_8h.html">Almog_Engine.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
